
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://informatics-isi-edu.github.io/deriva-ml/code-docs/deriva_ml_base/">
      
      
        <link rel="prev" href="../../Notebooks/DerivaML%20Vocabulary/">
      
      
        <link rel="next" href="../deriva_model/">
      
      
        
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.2">
    
    
      
        <title>DerivaML - DerivaML</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="blue">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#derivaml-class" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="DerivaML" class="md-header__button md-logo" aria-label="DerivaML" data-md-component="logo">
      
  <img src="../../assets/deriva-logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            DerivaML
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              DerivaML
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="DerivaML" class="md-nav__button md-logo" aria-label="DerivaML" data-md-component="logo">
      
  <img src="../../assets/deriva-logo.png" alt="logo">

    </a>
    DerivaML
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    User Guide
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    User Guide
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/overview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview of DerivaML
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/deriva_ml_structure/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    DerivaML Structure
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/install/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Installing deriva-ml
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/identifiers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Identifying things in deriva-ml
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/datasets/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Datasets
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/features/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Features
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/file-assets/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    File Assets
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/annotations/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Catalog Annotations
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/execution-configuration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Configuring an Execution
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/hydra-zen-configuration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Hydra-zen Configuration
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/running-models-and-notebooks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Running Models and Notebooks
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/notebooks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Using DerivaML with Jupyter Notebooks
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/cli-reference/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    CLI Reference
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Sample Notebooks
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Sample Notebooks
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Notebooks/DerivaML%20Dataset/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    DerivaML Dataset
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Notebooks/DerivaML%20Execution/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    DerivaML Execution
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Notebooks/DerivaML%20Features/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    DerivaML Features
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Notebooks/DerivaML%20Vocabulary/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    DerivaML Vocabulary
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Library Documentation
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Library Documentation
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1" checked>
        
          
          <label class="md-nav__link" for="__nav_4_1" id="__nav_4_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Core Classes
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    Core Classes
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    DerivaML
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    DerivaML
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#deriva_ml.core" class="md-nav__link">
    <span class="md-ellipsis">
      
        core
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deriva_ml.core.BuiltinTypes" class="md-nav__link">
    <span class="md-ellipsis">
      
        BuiltinTypes
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deriva_ml.core.ColumnDefinition" class="md-nav__link">
    <span class="md-ellipsis">
      
        ColumnDefinition
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deriva_ml.core.TableDefinition" class="md-nav__link">
    <span class="md-ellipsis">
      
        TableDefinition
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML" class="md-nav__link">
    <span class="md-ellipsis">
      
        DerivaML
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DerivaML">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.catalog_provenance" class="md-nav__link">
    <span class="md-ellipsis">
      
        catalog_provenance
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.__del__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __del__
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __init__
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.add_dataset_element_type" class="md-nav__link">
    <span class="md-ellipsis">
      
        add_dataset_element_type
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.add_files" class="md-nav__link">
    <span class="md-ellipsis">
      
        add_files
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.add_page" class="md-nav__link">
    <span class="md-ellipsis">
      
        add_page
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.add_term" class="md-nav__link">
    <span class="md-ellipsis">
      
        add_term
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.add_visible_column" class="md-nav__link">
    <span class="md-ellipsis">
      
        add_visible_column
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.add_visible_foreign_key" class="md-nav__link">
    <span class="md-ellipsis">
      
        add_visible_foreign_key
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.add_workflow" class="md-nav__link">
    <span class="md-ellipsis">
      
        add_workflow
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.apply_annotations" class="md-nav__link">
    <span class="md-ellipsis">
      
        apply_annotations
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.apply_catalog_annotations" class="md-nav__link">
    <span class="md-ellipsis">
      
        apply_catalog_annotations
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="apply_catalog_annotations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.apply_catalog_annotations--after-creating-domain-schema-and-tables" class="md-nav__link">
    <span class="md-ellipsis">
      
        After creating domain schema and tables...
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.apply_catalog_annotations--or-with-custom-branding" class="md-nav__link">
    <span class="md-ellipsis">
      
        Or with custom branding:
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.catalog_snapshot" class="md-nav__link">
    <span class="md-ellipsis">
      
        catalog_snapshot
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.chaise_url" class="md-nav__link">
    <span class="md-ellipsis">
      
        chaise_url
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.cite" class="md-nav__link">
    <span class="md-ellipsis">
      
        cite
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.clean_execution_dirs" class="md-nav__link">
    <span class="md-ellipsis">
      
        clean_execution_dirs
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="clean_execution_dirs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.clean_execution_dirs--clean-all-execution-dirs-older-than-30-days" class="md-nav__link">
    <span class="md-ellipsis">
      
        Clean all execution dirs older than 30 days
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.clean_execution_dirs--clean-all-except-specific-executions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Clean all except specific executions
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.clear_cache" class="md-nav__link">
    <span class="md-ellipsis">
      
        clear_cache
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="clear_cache">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.clear_cache--clear-all-cache" class="md-nav__link">
    <span class="md-ellipsis">
      
        Clear all cache
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.clear_cache--clear-cache-older-than-7-days" class="md-nav__link">
    <span class="md-ellipsis">
      
        Clear cache older than 7 days
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.clear_vocabulary_cache" class="md-nav__link">
    <span class="md-ellipsis">
      
        clear_vocabulary_cache
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.create_asset" class="md-nav__link">
    <span class="md-ellipsis">
      
        create_asset
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.create_execution" class="md-nav__link">
    <span class="md-ellipsis">
      
        create_execution
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.create_feature" class="md-nav__link">
    <span class="md-ellipsis">
      
        create_feature
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.create_table" class="md-nav__link">
    <span class="md-ellipsis">
      
        create_table
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.create_vocabulary" class="md-nav__link">
    <span class="md-ellipsis">
      
        create_vocabulary
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.create_workflow" class="md-nav__link">
    <span class="md-ellipsis">
      
        create_workflow
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.delete_dataset" class="md-nav__link">
    <span class="md-ellipsis">
      
        delete_dataset
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.delete_feature" class="md-nav__link">
    <span class="md-ellipsis">
      
        delete_feature
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.delete_term" class="md-nav__link">
    <span class="md-ellipsis">
      
        delete_term
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.domain_path" class="md-nav__link">
    <span class="md-ellipsis">
      
        domain_path
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="domain_path">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.domain_path--or-with-explicit-schema" class="md-nav__link">
    <span class="md-ellipsis">
      
        Or with explicit schema:
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.download_dataset_bag" class="md-nav__link">
    <span class="md-ellipsis">
      
        download_dataset_bag
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.download_dir" class="md-nav__link">
    <span class="md-ellipsis">
      
        download_dir
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.feature_record_class" class="md-nav__link">
    <span class="md-ellipsis">
      
        feature_record_class
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="feature_record_class">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.feature_record_class--get-the-dynamically-generated-class" class="md-nav__link">
    <span class="md-ellipsis">
      
        Get the dynamically generated class
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.feature_record_class--create-a-validated-feature-record" class="md-nav__link">
    <span class="md-ellipsis">
      
        Create a validated feature record
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.feature_record_class--convert-to-dict-for-insertion" class="md-nav__link">
    <span class="md-ellipsis">
      
        Convert to dict for insertion
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.find_assets" class="md-nav__link">
    <span class="md-ellipsis">
      
        find_assets
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="find_assets">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.find_assets--find-all-assets-in-the-model-table" class="md-nav__link">
    <span class="md-ellipsis">
      
        Find all assets in the Model table
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.find_assets--find-all-assets-with-type-training_data" class="md-nav__link">
    <span class="md-ellipsis">
      
        Find all assets with type "Training_Data"
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.find_assets--find-all-assets-across-all-tables" class="md-nav__link">
    <span class="md-ellipsis">
      
        Find all assets across all tables
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.find_datasets" class="md-nav__link">
    <span class="md-ellipsis">
      
        find_datasets
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.find_executions" class="md-nav__link">
    <span class="md-ellipsis">
      
        find_executions
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.find_experiments" class="md-nav__link">
    <span class="md-ellipsis">
      
        find_experiments
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.find_features" class="md-nav__link">
    <span class="md-ellipsis">
      
        find_features
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.find_workflows" class="md-nav__link">
    <span class="md-ellipsis">
      
        find_workflows
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.get_cache_size" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_cache_size
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.get_column_annotations" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_column_annotations
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.get_handlebars_template_variables" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_handlebars_template_variables
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.get_storage_summary" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_storage_summary
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.get_table_annotations" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_table_annotations
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.get_table_as_dataframe" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_table_as_dataframe
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.get_table_as_dict" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_table_as_dict
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.globus_login" class="md-nav__link">
    <span class="md-ellipsis">
      
        globus_login
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.instantiate" class="md-nav__link">
    <span class="md-ellipsis">
      
        instantiate
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="instantiate">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.instantiate--create-a-structured-config-using-hydra-zen" class="md-nav__link">
    <span class="md-ellipsis">
      
        Create a structured config using hydra-zen
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.instantiate--configure-for-your-environment" class="md-nav__link">
    <span class="md-ellipsis">
      
        Configure for your environment
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.instantiate--instantiate-the-config-to-get-a-derivamlconfig-object" class="md-nav__link">
    <span class="md-ellipsis">
      
        Instantiate the config to get a DerivaMLConfig object
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.instantiate--create-the-derivaml-instance" class="md-nav__link">
    <span class="md-ellipsis">
      
        Create the DerivaML instance
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.list_asset_executions" class="md-nav__link">
    <span class="md-ellipsis">
      
        list_asset_executions
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="list_asset_executions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.list_asset_executions--find-all-executions-that-created-this-asset" class="md-nav__link">
    <span class="md-ellipsis">
      
        Find all executions that created this asset
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.list_asset_executions--find-all-executions-that-used-this-asset-as-input" class="md-nav__link">
    <span class="md-ellipsis">
      
        Find all executions that used this asset as input
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.list_asset_tables" class="md-nav__link">
    <span class="md-ellipsis">
      
        list_asset_tables
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.list_assets" class="md-nav__link">
    <span class="md-ellipsis">
      
        list_assets
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.list_dataset_element_types" class="md-nav__link">
    <span class="md-ellipsis">
      
        list_dataset_element_types
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.list_execution_dirs" class="md-nav__link">
    <span class="md-ellipsis">
      
        list_execution_dirs
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.list_feature_values" class="md-nav__link">
    <span class="md-ellipsis">
      
        list_feature_values
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="list_feature_values">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.list_feature_values--get-typed-feature-records" class="md-nav__link">
    <span class="md-ellipsis">
      
        Get typed feature records
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.list_feature_values--convert-records-to-dictionaries" class="md-nav__link">
    <span class="md-ellipsis">
      
        Convert records to dictionaries
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.list_files" class="md-nav__link">
    <span class="md-ellipsis">
      
        list_files
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.list_foreign_keys" class="md-nav__link">
    <span class="md-ellipsis">
      
        list_foreign_keys
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.list_vocabulary_terms" class="md-nav__link">
    <span class="md-ellipsis">
      
        list_vocabulary_terms
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.lookup_asset" class="md-nav__link">
    <span class="md-ellipsis">
      
        lookup_asset
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.lookup_dataset" class="md-nav__link">
    <span class="md-ellipsis">
      
        lookup_dataset
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.lookup_execution" class="md-nav__link">
    <span class="md-ellipsis">
      
        lookup_execution
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.lookup_experiment" class="md-nav__link">
    <span class="md-ellipsis">
      
        lookup_experiment
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.lookup_feature" class="md-nav__link">
    <span class="md-ellipsis">
      
        lookup_feature
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.lookup_term" class="md-nav__link">
    <span class="md-ellipsis">
      
        lookup_term
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.lookup_workflow" class="md-nav__link">
    <span class="md-ellipsis">
      
        lookup_workflow
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.lookup_workflow_by_url" class="md-nav__link">
    <span class="md-ellipsis">
      
        lookup_workflow_by_url
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.pathBuilder" class="md-nav__link">
    <span class="md-ellipsis">
      
        pathBuilder
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.remove_visible_column" class="md-nav__link">
    <span class="md-ellipsis">
      
        remove_visible_column
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.remove_visible_foreign_key" class="md-nav__link">
    <span class="md-ellipsis">
      
        remove_visible_foreign_key
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.reorder_visible_columns" class="md-nav__link">
    <span class="md-ellipsis">
      
        reorder_visible_columns
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.reorder_visible_foreign_keys" class="md-nav__link">
    <span class="md-ellipsis">
      
        reorder_visible_foreign_keys
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.resolve_rid" class="md-nav__link">
    <span class="md-ellipsis">
      
        resolve_rid
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.resolve_rids" class="md-nav__link">
    <span class="md-ellipsis">
      
        resolve_rids
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.restore_execution" class="md-nav__link">
    <span class="md-ellipsis">
      
        restore_execution
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.retrieve_rid" class="md-nav__link">
    <span class="md-ellipsis">
      
        retrieve_rid
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.set_column_display" class="md-nav__link">
    <span class="md-ellipsis">
      
        set_column_display
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.set_display_annotation" class="md-nav__link">
    <span class="md-ellipsis">
      
        set_display_annotation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.set_table_display" class="md-nav__link">
    <span class="md-ellipsis">
      
        set_table_display
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.set_visible_columns" class="md-nav__link">
    <span class="md-ellipsis">
      
        set_visible_columns
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.set_visible_foreign_keys" class="md-nav__link">
    <span class="md-ellipsis">
      
        set_visible_foreign_keys
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.table_path" class="md-nav__link">
    <span class="md-ellipsis">
      
        table_path
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.user_list" class="md-nav__link">
    <span class="md-ellipsis">
      
        user_list
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.validate_schema" class="md-nav__link">
    <span class="md-ellipsis">
      
        validate_schema
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="validate_schema">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.validate_schema--strict-validation-for-a-fresh-ml-catalog" class="md-nav__link">
    <span class="md-ellipsis">
      
        Strict validation for a fresh ML catalog
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.validate_schema--get-report-as-dictionary-for-jsonlogging" class="md-nav__link">
    <span class="md-ellipsis">
      
        Get report as dictionary for JSON/logging
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaMLConfig" class="md-nav__link">
    <span class="md-ellipsis">
      
        DerivaMLConfig
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DerivaMLConfig">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaMLConfig.compute_workdir" class="md-nav__link">
    <span class="md-ellipsis">
      
        compute_workdir
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaMLConfig.init_working_dir" class="md-nav__link">
    <span class="md-ellipsis">
      
        init_working_dir
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaMLException" class="md-nav__link">
    <span class="md-ellipsis">
      
        DerivaMLException
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaMLInvalidTerm" class="md-nav__link">
    <span class="md-ellipsis">
      
        DerivaMLInvalidTerm
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaMLTableTypeError" class="md-nav__link">
    <span class="md-ellipsis">
      
        DerivaMLTableTypeError
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deriva_ml.core.ExecAssetType" class="md-nav__link">
    <span class="md-ellipsis">
      
        ExecAssetType
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deriva_ml.core.ExecMetadataType" class="md-nav__link">
    <span class="md-ellipsis">
      
        ExecMetadataType
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deriva_ml.core.FileSpec" class="md-nav__link">
    <span class="md-ellipsis">
      
        FileSpec
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="FileSpec">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.FileSpec.create_filespecs" class="md-nav__link">
    <span class="md-ellipsis">
      
        create_filespecs
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.FileSpec.read_filespec" class="md-nav__link">
    <span class="md-ellipsis">
      
        read_filespec
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.FileSpec.validate_file_url" class="md-nav__link">
    <span class="md-ellipsis">
      
        validate_file_url
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deriva_ml.core.FileUploadState" class="md-nav__link">
    <span class="md-ellipsis">
      
        FileUploadState
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deriva_ml.core.LoggerMixin" class="md-nav__link">
    <span class="md-ellipsis">
      
        LoggerMixin
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="LoggerMixin">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.LoggerMixin--logs-to-deriva_mlmyprocessor" class="md-nav__link">
    <span class="md-ellipsis">
      
        Logs to 'deriva_ml.MyProcessor'
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deriva_ml.core.MLAsset" class="md-nav__link">
    <span class="md-ellipsis">
      
        MLAsset
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deriva_ml.core.MLVocab" class="md-nav__link">
    <span class="md-ellipsis">
      
        MLVocab
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deriva_ml.core.UploadState" class="md-nav__link">
    <span class="md-ellipsis">
      
        UploadState
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deriva_ml.core.configure_logging" class="md-nav__link">
    <span class="md-ellipsis">
      
        configure_logging
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="configure_logging">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.configure_logging--same-level-for-everything" class="md-nav__link">
    <span class="md-ellipsis">
      
        Same level for everything
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.configure_logging--verbose-derivaml-quieter-deriva-py-libraries" class="md-nav__link">
    <span class="md-ellipsis">
      
        Verbose DerivaML, quieter deriva-py libraries
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deriva_ml.core.get_logger" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_logger
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deriva_ml.core.is_hydra_initialized" class="md-nav__link">
    <span class="md-ellipsis">
      
        is_hydra_initialized
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../deriva_model/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    DerivaModel
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_2" >
        
          
          <label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Datasets
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Datasets
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dataset/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Dataset
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dataset_bag/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    DatasetBag
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dataset_split/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Dataset Splitting
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dataset_aux_classes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Dataset Auxiliary Classes
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_3" >
        
          
          <label class="md-nav__link" for="__nav_4_3" id="__nav_4_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Execution
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Execution
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../execution/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Execution
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../execution_configuration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ExecutionConfiguration
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../workflow/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Workflow
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_4" >
        
          
          <label class="md-nav__link" for="__nav_4_4" id="__nav_4_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Features
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Features
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../feature/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Feature
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_5" >
        
          
          <label class="md-nav__link" for="__nav_4_5" id="__nav_4_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Utilities
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Utilities
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../deriva_definitions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Definitions & Types
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../exceptions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Exceptions
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../upload/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Upload
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../release-notes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Release Notes
  

    
  </span>
  
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#deriva_ml.core" class="md-nav__link">
    <span class="md-ellipsis">
      
        core
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deriva_ml.core.BuiltinTypes" class="md-nav__link">
    <span class="md-ellipsis">
      
        BuiltinTypes
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deriva_ml.core.ColumnDefinition" class="md-nav__link">
    <span class="md-ellipsis">
      
        ColumnDefinition
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deriva_ml.core.TableDefinition" class="md-nav__link">
    <span class="md-ellipsis">
      
        TableDefinition
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML" class="md-nav__link">
    <span class="md-ellipsis">
      
        DerivaML
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DerivaML">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.catalog_provenance" class="md-nav__link">
    <span class="md-ellipsis">
      
        catalog_provenance
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.__del__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __del__
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __init__
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.add_dataset_element_type" class="md-nav__link">
    <span class="md-ellipsis">
      
        add_dataset_element_type
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.add_files" class="md-nav__link">
    <span class="md-ellipsis">
      
        add_files
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.add_page" class="md-nav__link">
    <span class="md-ellipsis">
      
        add_page
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.add_term" class="md-nav__link">
    <span class="md-ellipsis">
      
        add_term
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.add_visible_column" class="md-nav__link">
    <span class="md-ellipsis">
      
        add_visible_column
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.add_visible_foreign_key" class="md-nav__link">
    <span class="md-ellipsis">
      
        add_visible_foreign_key
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.add_workflow" class="md-nav__link">
    <span class="md-ellipsis">
      
        add_workflow
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.apply_annotations" class="md-nav__link">
    <span class="md-ellipsis">
      
        apply_annotations
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.apply_catalog_annotations" class="md-nav__link">
    <span class="md-ellipsis">
      
        apply_catalog_annotations
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="apply_catalog_annotations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.apply_catalog_annotations--after-creating-domain-schema-and-tables" class="md-nav__link">
    <span class="md-ellipsis">
      
        After creating domain schema and tables...
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.apply_catalog_annotations--or-with-custom-branding" class="md-nav__link">
    <span class="md-ellipsis">
      
        Or with custom branding:
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.catalog_snapshot" class="md-nav__link">
    <span class="md-ellipsis">
      
        catalog_snapshot
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.chaise_url" class="md-nav__link">
    <span class="md-ellipsis">
      
        chaise_url
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.cite" class="md-nav__link">
    <span class="md-ellipsis">
      
        cite
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.clean_execution_dirs" class="md-nav__link">
    <span class="md-ellipsis">
      
        clean_execution_dirs
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="clean_execution_dirs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.clean_execution_dirs--clean-all-execution-dirs-older-than-30-days" class="md-nav__link">
    <span class="md-ellipsis">
      
        Clean all execution dirs older than 30 days
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.clean_execution_dirs--clean-all-except-specific-executions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Clean all except specific executions
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.clear_cache" class="md-nav__link">
    <span class="md-ellipsis">
      
        clear_cache
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="clear_cache">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.clear_cache--clear-all-cache" class="md-nav__link">
    <span class="md-ellipsis">
      
        Clear all cache
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.clear_cache--clear-cache-older-than-7-days" class="md-nav__link">
    <span class="md-ellipsis">
      
        Clear cache older than 7 days
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.clear_vocabulary_cache" class="md-nav__link">
    <span class="md-ellipsis">
      
        clear_vocabulary_cache
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.create_asset" class="md-nav__link">
    <span class="md-ellipsis">
      
        create_asset
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.create_execution" class="md-nav__link">
    <span class="md-ellipsis">
      
        create_execution
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.create_feature" class="md-nav__link">
    <span class="md-ellipsis">
      
        create_feature
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.create_table" class="md-nav__link">
    <span class="md-ellipsis">
      
        create_table
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.create_vocabulary" class="md-nav__link">
    <span class="md-ellipsis">
      
        create_vocabulary
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.create_workflow" class="md-nav__link">
    <span class="md-ellipsis">
      
        create_workflow
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.delete_dataset" class="md-nav__link">
    <span class="md-ellipsis">
      
        delete_dataset
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.delete_feature" class="md-nav__link">
    <span class="md-ellipsis">
      
        delete_feature
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.delete_term" class="md-nav__link">
    <span class="md-ellipsis">
      
        delete_term
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.domain_path" class="md-nav__link">
    <span class="md-ellipsis">
      
        domain_path
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="domain_path">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.domain_path--or-with-explicit-schema" class="md-nav__link">
    <span class="md-ellipsis">
      
        Or with explicit schema:
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.download_dataset_bag" class="md-nav__link">
    <span class="md-ellipsis">
      
        download_dataset_bag
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.download_dir" class="md-nav__link">
    <span class="md-ellipsis">
      
        download_dir
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.feature_record_class" class="md-nav__link">
    <span class="md-ellipsis">
      
        feature_record_class
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="feature_record_class">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.feature_record_class--get-the-dynamically-generated-class" class="md-nav__link">
    <span class="md-ellipsis">
      
        Get the dynamically generated class
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.feature_record_class--create-a-validated-feature-record" class="md-nav__link">
    <span class="md-ellipsis">
      
        Create a validated feature record
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.feature_record_class--convert-to-dict-for-insertion" class="md-nav__link">
    <span class="md-ellipsis">
      
        Convert to dict for insertion
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.find_assets" class="md-nav__link">
    <span class="md-ellipsis">
      
        find_assets
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="find_assets">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.find_assets--find-all-assets-in-the-model-table" class="md-nav__link">
    <span class="md-ellipsis">
      
        Find all assets in the Model table
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.find_assets--find-all-assets-with-type-training_data" class="md-nav__link">
    <span class="md-ellipsis">
      
        Find all assets with type "Training_Data"
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.find_assets--find-all-assets-across-all-tables" class="md-nav__link">
    <span class="md-ellipsis">
      
        Find all assets across all tables
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.find_datasets" class="md-nav__link">
    <span class="md-ellipsis">
      
        find_datasets
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.find_executions" class="md-nav__link">
    <span class="md-ellipsis">
      
        find_executions
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.find_experiments" class="md-nav__link">
    <span class="md-ellipsis">
      
        find_experiments
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.find_features" class="md-nav__link">
    <span class="md-ellipsis">
      
        find_features
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.find_workflows" class="md-nav__link">
    <span class="md-ellipsis">
      
        find_workflows
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.get_cache_size" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_cache_size
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.get_column_annotations" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_column_annotations
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.get_handlebars_template_variables" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_handlebars_template_variables
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.get_storage_summary" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_storage_summary
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.get_table_annotations" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_table_annotations
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.get_table_as_dataframe" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_table_as_dataframe
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.get_table_as_dict" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_table_as_dict
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.globus_login" class="md-nav__link">
    <span class="md-ellipsis">
      
        globus_login
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.instantiate" class="md-nav__link">
    <span class="md-ellipsis">
      
        instantiate
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="instantiate">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.instantiate--create-a-structured-config-using-hydra-zen" class="md-nav__link">
    <span class="md-ellipsis">
      
        Create a structured config using hydra-zen
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.instantiate--configure-for-your-environment" class="md-nav__link">
    <span class="md-ellipsis">
      
        Configure for your environment
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.instantiate--instantiate-the-config-to-get-a-derivamlconfig-object" class="md-nav__link">
    <span class="md-ellipsis">
      
        Instantiate the config to get a DerivaMLConfig object
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.instantiate--create-the-derivaml-instance" class="md-nav__link">
    <span class="md-ellipsis">
      
        Create the DerivaML instance
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.list_asset_executions" class="md-nav__link">
    <span class="md-ellipsis">
      
        list_asset_executions
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="list_asset_executions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.list_asset_executions--find-all-executions-that-created-this-asset" class="md-nav__link">
    <span class="md-ellipsis">
      
        Find all executions that created this asset
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.list_asset_executions--find-all-executions-that-used-this-asset-as-input" class="md-nav__link">
    <span class="md-ellipsis">
      
        Find all executions that used this asset as input
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.list_asset_tables" class="md-nav__link">
    <span class="md-ellipsis">
      
        list_asset_tables
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.list_assets" class="md-nav__link">
    <span class="md-ellipsis">
      
        list_assets
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.list_dataset_element_types" class="md-nav__link">
    <span class="md-ellipsis">
      
        list_dataset_element_types
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.list_execution_dirs" class="md-nav__link">
    <span class="md-ellipsis">
      
        list_execution_dirs
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.list_feature_values" class="md-nav__link">
    <span class="md-ellipsis">
      
        list_feature_values
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="list_feature_values">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.list_feature_values--get-typed-feature-records" class="md-nav__link">
    <span class="md-ellipsis">
      
        Get typed feature records
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.list_feature_values--convert-records-to-dictionaries" class="md-nav__link">
    <span class="md-ellipsis">
      
        Convert records to dictionaries
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.list_files" class="md-nav__link">
    <span class="md-ellipsis">
      
        list_files
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.list_foreign_keys" class="md-nav__link">
    <span class="md-ellipsis">
      
        list_foreign_keys
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.list_vocabulary_terms" class="md-nav__link">
    <span class="md-ellipsis">
      
        list_vocabulary_terms
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.lookup_asset" class="md-nav__link">
    <span class="md-ellipsis">
      
        lookup_asset
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.lookup_dataset" class="md-nav__link">
    <span class="md-ellipsis">
      
        lookup_dataset
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.lookup_execution" class="md-nav__link">
    <span class="md-ellipsis">
      
        lookup_execution
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.lookup_experiment" class="md-nav__link">
    <span class="md-ellipsis">
      
        lookup_experiment
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.lookup_feature" class="md-nav__link">
    <span class="md-ellipsis">
      
        lookup_feature
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.lookup_term" class="md-nav__link">
    <span class="md-ellipsis">
      
        lookup_term
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.lookup_workflow" class="md-nav__link">
    <span class="md-ellipsis">
      
        lookup_workflow
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.lookup_workflow_by_url" class="md-nav__link">
    <span class="md-ellipsis">
      
        lookup_workflow_by_url
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.pathBuilder" class="md-nav__link">
    <span class="md-ellipsis">
      
        pathBuilder
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.remove_visible_column" class="md-nav__link">
    <span class="md-ellipsis">
      
        remove_visible_column
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.remove_visible_foreign_key" class="md-nav__link">
    <span class="md-ellipsis">
      
        remove_visible_foreign_key
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.reorder_visible_columns" class="md-nav__link">
    <span class="md-ellipsis">
      
        reorder_visible_columns
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.reorder_visible_foreign_keys" class="md-nav__link">
    <span class="md-ellipsis">
      
        reorder_visible_foreign_keys
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.resolve_rid" class="md-nav__link">
    <span class="md-ellipsis">
      
        resolve_rid
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.resolve_rids" class="md-nav__link">
    <span class="md-ellipsis">
      
        resolve_rids
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.restore_execution" class="md-nav__link">
    <span class="md-ellipsis">
      
        restore_execution
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.retrieve_rid" class="md-nav__link">
    <span class="md-ellipsis">
      
        retrieve_rid
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.set_column_display" class="md-nav__link">
    <span class="md-ellipsis">
      
        set_column_display
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.set_display_annotation" class="md-nav__link">
    <span class="md-ellipsis">
      
        set_display_annotation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.set_table_display" class="md-nav__link">
    <span class="md-ellipsis">
      
        set_table_display
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.set_visible_columns" class="md-nav__link">
    <span class="md-ellipsis">
      
        set_visible_columns
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.set_visible_foreign_keys" class="md-nav__link">
    <span class="md-ellipsis">
      
        set_visible_foreign_keys
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.table_path" class="md-nav__link">
    <span class="md-ellipsis">
      
        table_path
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.user_list" class="md-nav__link">
    <span class="md-ellipsis">
      
        user_list
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.validate_schema" class="md-nav__link">
    <span class="md-ellipsis">
      
        validate_schema
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="validate_schema">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.validate_schema--strict-validation-for-a-fresh-ml-catalog" class="md-nav__link">
    <span class="md-ellipsis">
      
        Strict validation for a fresh ML catalog
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaML.validate_schema--get-report-as-dictionary-for-jsonlogging" class="md-nav__link">
    <span class="md-ellipsis">
      
        Get report as dictionary for JSON/logging
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaMLConfig" class="md-nav__link">
    <span class="md-ellipsis">
      
        DerivaMLConfig
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DerivaMLConfig">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaMLConfig.compute_workdir" class="md-nav__link">
    <span class="md-ellipsis">
      
        compute_workdir
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaMLConfig.init_working_dir" class="md-nav__link">
    <span class="md-ellipsis">
      
        init_working_dir
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaMLException" class="md-nav__link">
    <span class="md-ellipsis">
      
        DerivaMLException
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaMLInvalidTerm" class="md-nav__link">
    <span class="md-ellipsis">
      
        DerivaMLInvalidTerm
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deriva_ml.core.DerivaMLTableTypeError" class="md-nav__link">
    <span class="md-ellipsis">
      
        DerivaMLTableTypeError
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deriva_ml.core.ExecAssetType" class="md-nav__link">
    <span class="md-ellipsis">
      
        ExecAssetType
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deriva_ml.core.ExecMetadataType" class="md-nav__link">
    <span class="md-ellipsis">
      
        ExecMetadataType
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deriva_ml.core.FileSpec" class="md-nav__link">
    <span class="md-ellipsis">
      
        FileSpec
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="FileSpec">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.FileSpec.create_filespecs" class="md-nav__link">
    <span class="md-ellipsis">
      
        create_filespecs
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.FileSpec.read_filespec" class="md-nav__link">
    <span class="md-ellipsis">
      
        read_filespec
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.FileSpec.validate_file_url" class="md-nav__link">
    <span class="md-ellipsis">
      
        validate_file_url
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deriva_ml.core.FileUploadState" class="md-nav__link">
    <span class="md-ellipsis">
      
        FileUploadState
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deriva_ml.core.LoggerMixin" class="md-nav__link">
    <span class="md-ellipsis">
      
        LoggerMixin
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="LoggerMixin">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.LoggerMixin--logs-to-deriva_mlmyprocessor" class="md-nav__link">
    <span class="md-ellipsis">
      
        Logs to 'deriva_ml.MyProcessor'
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deriva_ml.core.MLAsset" class="md-nav__link">
    <span class="md-ellipsis">
      
        MLAsset
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deriva_ml.core.MLVocab" class="md-nav__link">
    <span class="md-ellipsis">
      
        MLVocab
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deriva_ml.core.UploadState" class="md-nav__link">
    <span class="md-ellipsis">
      
        UploadState
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deriva_ml.core.configure_logging" class="md-nav__link">
    <span class="md-ellipsis">
      
        configure_logging
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="configure_logging">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.configure_logging--same-level-for-everything" class="md-nav__link">
    <span class="md-ellipsis">
      
        Same level for everything
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deriva_ml.core.configure_logging--verbose-derivaml-quieter-deriva-py-libraries" class="md-nav__link">
    <span class="md-ellipsis">
      
        Verbose DerivaML, quieter deriva-py libraries
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deriva_ml.core.get_logger" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_logger
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deriva_ml.core.is_hydra_initialized" class="md-nav__link">
    <span class="md-ellipsis">
      
        is_hydra_initialized
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="derivaml-class"><code>DerivaML</code> Class</h1>
<p>The DerivaML class provides a range of methods to interact with a Deriva catalog.
These methods assume tha tthe catalog contains a <code>deriva-ml</code> and a domain schema.</p>
<p><strong>Data Catalog</strong>: The catalog must include both the domain schema and a standard ML schema for effective data management.</p>
<p><img alt="ERD" src="../../assets/ERD.png" /></p>
<ul>
<li><strong>Domain schema</strong>: The domain schema includes the data collected or generated by domain-specific experiments or systems.</li>
<li><strong>ML schema</strong>: Each entity in the ML schema is designed to capture details of the ML development process. It including the following tables<ul>
<li>A <em>Dataset</em> represents a data collection, such as aggregation identified for training, validation, and testing purposes.</li>
<li>A <em>Workflow</em> represents a specific sequence of computational steps or human interactions.</li>
<li>An <em>Execution</em> is an instance of a workflow that a user instantiates at a specific time. </li>
<li>An <em>Execution Asset</em> is an output file that results from the execution of a workflow.</li>
<li>An <em>Execution Metadata</em> is an asset entity for saving metadata files referencing a given execution.</li>
</ul>
</li>
</ul>


<div class="doc doc-object doc-module">



<a id="deriva_ml.core"></a>
    <div class="doc doc-contents first">

        <p>Core module for DerivaML.</p>
<p>This module provides the primary public interface to DerivaML functionality. It exports
the main DerivaML class along with configuration, definitions, and exceptions needed
for interacting with Deriva-based ML catalogs.</p>


<details class="key-exports" open>
  <summary>Key exports</summary>
  <ul>
<li>DerivaML: Main class for catalog operations and ML workflow management.</li>
<li>DerivaMLConfig: Configuration class for DerivaML instances.</li>
<li>Exceptions: DerivaMLException and specialized exception types.</li>
<li>Definitions: Type definitions, enums, and constants used throughout the package.</li>
</ul>
</details>

<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>from deriva_ml.core import DerivaML, DerivaMLConfig
ml = DerivaML('deriva.example.org', 'my_catalog')
datasets = ml.find_datasets()</p>
</blockquote>
</blockquote>
</blockquote>
</details>









<div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h2 id="deriva_ml.core.BuiltinTypes" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">BuiltinTypes</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">BuiltinTypes</span> <span class="o">=</span> <span class="n">BuiltinType</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Alias for BuiltinType from deriva.core.typed.</p>
<p>This maintains backwards compatibility with existing DerivaML code that uses
the plural form 'BuiltinTypes'. New code should use BuiltinType directly.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="deriva_ml.core.ColumnDefinition" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">ColumnDefinition</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">ColumnDefinition</span> <span class="o">=</span> <span class="n">ColumnDef</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Alias for ColumnDef from deriva.core.typed.</p>
<p>This maintains backwards compatibility with existing DerivaML code.
New code should use ColumnDef directly.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="deriva_ml.core.TableDefinition" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">TableDefinition</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">TableDefinition</span> <span class="o">=</span> <span class="n">TableDef</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Alias for TableDef from deriva.core.typed.</p>
<p>This maintains backwards compatibility with existing DerivaML code.
New code should use TableDef directly.</p>

    </div>

</div>



<div class="doc doc-object doc-class">



<h2 id="deriva_ml.core.DerivaML" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">DerivaML</span>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="deriva_ml.core.mixins.PathBuilderMixin">PathBuilderMixin</span></code>, <code><span title="deriva_ml.core.mixins.RidResolutionMixin">RidResolutionMixin</span></code>, <code><span title="deriva_ml.core.mixins.VocabularyMixin">VocabularyMixin</span></code>, <code><span title="deriva_ml.core.mixins.WorkflowMixin">WorkflowMixin</span></code>, <code><span title="deriva_ml.core.mixins.FeatureMixin">FeatureMixin</span></code>, <code><span title="deriva_ml.core.mixins.DatasetMixin">DatasetMixin</span></code>, <code><span title="deriva_ml.core.mixins.AssetMixin">AssetMixin</span></code>, <code><span title="deriva_ml.core.mixins.ExecutionMixin">ExecutionMixin</span></code>, <code><span title="deriva_ml.core.mixins.FileMixin">FileMixin</span></code>, <code><span title="deriva_ml.core.mixins.AnnotationMixin">AnnotationMixin</span></code>, <code><span title="deriva_ml.interfaces.DerivaMLCatalog">DerivaMLCatalog</span></code></p>



        <p>Core class for machine learning operations on a Deriva catalog.</p>
<p>This class provides core functionality for managing ML workflows, features, and datasets in a Deriva catalog.
It handles data versioning, feature management, vocabulary control, and execution tracking.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="deriva_ml.core.DerivaML.host_name">host_name</span></code></td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Hostname of the Deriva server (e.g., 'deriva.example.org').</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="deriva_ml.core.DerivaML.catalog_id">catalog_id</span></code></td>
            <td>
                  <code><span title="Union">Union</span>[<span title="str">str</span>, <span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Catalog identifier or name.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="deriva_ml.core.DerivaML.domain_schema">domain_schema</span></code></td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Schema name for domain-specific tables and relationships.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="deriva_ml.core.DerivaML.model">model</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="DerivaModel (deriva_ml.model.catalog.DerivaModel)" href="../deriva_model/#deriva_ml.model.DerivaModel">DerivaModel</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>ERMRest model for the catalog.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="deriva_ml.core.DerivaML.working_dir">working_dir</span></code></td>
            <td>
                  <code><span title="pathlib.Path">Path</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Directory for storing computation data and results.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="deriva_ml.core.DerivaML.cache_dir">cache_dir</span></code></td>
            <td>
                  <code><span title="pathlib.Path">Path</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Directory for caching downloaded datasets.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="deriva_ml.core.DerivaML.ml_schema">ml_schema</span></code></td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Schema name for ML-specific tables (default: 'deriva_ml').</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="deriva_ml.core.DerivaML.configuration">configuration</span></code></td>
            <td>
                  <code><span title="ExecutionConfiguration">ExecutionConfiguration</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Current execution configuration.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="deriva_ml.core.DerivaML.project_name">project_name</span></code></td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the current project.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="deriva_ml.core.DerivaML.start_time">start_time</span></code></td>
            <td>
                  <code><span title="datetime.datetime">datetime</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Timestamp when this instance was created.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="deriva_ml.core.DerivaML.status">status</span></code></td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Current status of operations.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>ml = DerivaML('deriva.example.org', 'my_catalog')
ml.create_feature('my_table', 'new_feature')
ml.add_term('vocabulary_table', 'new_term', description='Description of term')</p>
</blockquote>
</blockquote>
</blockquote>
</details>







              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/deriva_ml/core/base.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">  83</span>
<span class="normal">  84</span>
<span class="normal">  85</span>
<span class="normal">  86</span>
<span class="normal">  87</span>
<span class="normal">  88</span>
<span class="normal">  89</span>
<span class="normal">  90</span>
<span class="normal">  91</span>
<span class="normal">  92</span>
<span class="normal">  93</span>
<span class="normal">  94</span>
<span class="normal">  95</span>
<span class="normal">  96</span>
<span class="normal">  97</span>
<span class="normal">  98</span>
<span class="normal">  99</span>
<span class="normal"> 100</span>
<span class="normal"> 101</span>
<span class="normal"> 102</span>
<span class="normal"> 103</span>
<span class="normal"> 104</span>
<span class="normal"> 105</span>
<span class="normal"> 106</span>
<span class="normal"> 107</span>
<span class="normal"> 108</span>
<span class="normal"> 109</span>
<span class="normal"> 110</span>
<span class="normal"> 111</span>
<span class="normal"> 112</span>
<span class="normal"> 113</span>
<span class="normal"> 114</span>
<span class="normal"> 115</span>
<span class="normal"> 116</span>
<span class="normal"> 117</span>
<span class="normal"> 118</span>
<span class="normal"> 119</span>
<span class="normal"> 120</span>
<span class="normal"> 121</span>
<span class="normal"> 122</span>
<span class="normal"> 123</span>
<span class="normal"> 124</span>
<span class="normal"> 125</span>
<span class="normal"> 126</span>
<span class="normal"> 127</span>
<span class="normal"> 128</span>
<span class="normal"> 129</span>
<span class="normal"> 130</span>
<span class="normal"> 131</span>
<span class="normal"> 132</span>
<span class="normal"> 133</span>
<span class="normal"> 134</span>
<span class="normal"> 135</span>
<span class="normal"> 136</span>
<span class="normal"> 137</span>
<span class="normal"> 138</span>
<span class="normal"> 139</span>
<span class="normal"> 140</span>
<span class="normal"> 141</span>
<span class="normal"> 142</span>
<span class="normal"> 143</span>
<span class="normal"> 144</span>
<span class="normal"> 145</span>
<span class="normal"> 146</span>
<span class="normal"> 147</span>
<span class="normal"> 148</span>
<span class="normal"> 149</span>
<span class="normal"> 150</span>
<span class="normal"> 151</span>
<span class="normal"> 152</span>
<span class="normal"> 153</span>
<span class="normal"> 154</span>
<span class="normal"> 155</span>
<span class="normal"> 156</span>
<span class="normal"> 157</span>
<span class="normal"> 158</span>
<span class="normal"> 159</span>
<span class="normal"> 160</span>
<span class="normal"> 161</span>
<span class="normal"> 162</span>
<span class="normal"> 163</span>
<span class="normal"> 164</span>
<span class="normal"> 165</span>
<span class="normal"> 166</span>
<span class="normal"> 167</span>
<span class="normal"> 168</span>
<span class="normal"> 169</span>
<span class="normal"> 170</span>
<span class="normal"> 171</span>
<span class="normal"> 172</span>
<span class="normal"> 173</span>
<span class="normal"> 174</span>
<span class="normal"> 175</span>
<span class="normal"> 176</span>
<span class="normal"> 177</span>
<span class="normal"> 178</span>
<span class="normal"> 179</span>
<span class="normal"> 180</span>
<span class="normal"> 181</span>
<span class="normal"> 182</span>
<span class="normal"> 183</span>
<span class="normal"> 184</span>
<span class="normal"> 185</span>
<span class="normal"> 186</span>
<span class="normal"> 187</span>
<span class="normal"> 188</span>
<span class="normal"> 189</span>
<span class="normal"> 190</span>
<span class="normal"> 191</span>
<span class="normal"> 192</span>
<span class="normal"> 193</span>
<span class="normal"> 194</span>
<span class="normal"> 195</span>
<span class="normal"> 196</span>
<span class="normal"> 197</span>
<span class="normal"> 198</span>
<span class="normal"> 199</span>
<span class="normal"> 200</span>
<span class="normal"> 201</span>
<span class="normal"> 202</span>
<span class="normal"> 203</span>
<span class="normal"> 204</span>
<span class="normal"> 205</span>
<span class="normal"> 206</span>
<span class="normal"> 207</span>
<span class="normal"> 208</span>
<span class="normal"> 209</span>
<span class="normal"> 210</span>
<span class="normal"> 211</span>
<span class="normal"> 212</span>
<span class="normal"> 213</span>
<span class="normal"> 214</span>
<span class="normal"> 215</span>
<span class="normal"> 216</span>
<span class="normal"> 217</span>
<span class="normal"> 218</span>
<span class="normal"> 219</span>
<span class="normal"> 220</span>
<span class="normal"> 221</span>
<span class="normal"> 222</span>
<span class="normal"> 223</span>
<span class="normal"> 224</span>
<span class="normal"> 225</span>
<span class="normal"> 226</span>
<span class="normal"> 227</span>
<span class="normal"> 228</span>
<span class="normal"> 229</span>
<span class="normal"> 230</span>
<span class="normal"> 231</span>
<span class="normal"> 232</span>
<span class="normal"> 233</span>
<span class="normal"> 234</span>
<span class="normal"> 235</span>
<span class="normal"> 236</span>
<span class="normal"> 237</span>
<span class="normal"> 238</span>
<span class="normal"> 239</span>
<span class="normal"> 240</span>
<span class="normal"> 241</span>
<span class="normal"> 242</span>
<span class="normal"> 243</span>
<span class="normal"> 244</span>
<span class="normal"> 245</span>
<span class="normal"> 246</span>
<span class="normal"> 247</span>
<span class="normal"> 248</span>
<span class="normal"> 249</span>
<span class="normal"> 250</span>
<span class="normal"> 251</span>
<span class="normal"> 252</span>
<span class="normal"> 253</span>
<span class="normal"> 254</span>
<span class="normal"> 255</span>
<span class="normal"> 256</span>
<span class="normal"> 257</span>
<span class="normal"> 258</span>
<span class="normal"> 259</span>
<span class="normal"> 260</span>
<span class="normal"> 261</span>
<span class="normal"> 262</span>
<span class="normal"> 263</span>
<span class="normal"> 264</span>
<span class="normal"> 265</span>
<span class="normal"> 266</span>
<span class="normal"> 267</span>
<span class="normal"> 268</span>
<span class="normal"> 269</span>
<span class="normal"> 270</span>
<span class="normal"> 271</span>
<span class="normal"> 272</span>
<span class="normal"> 273</span>
<span class="normal"> 274</span>
<span class="normal"> 275</span>
<span class="normal"> 276</span>
<span class="normal"> 277</span>
<span class="normal"> 278</span>
<span class="normal"> 279</span>
<span class="normal"> 280</span>
<span class="normal"> 281</span>
<span class="normal"> 282</span>
<span class="normal"> 283</span>
<span class="normal"> 284</span>
<span class="normal"> 285</span>
<span class="normal"> 286</span>
<span class="normal"> 287</span>
<span class="normal"> 288</span>
<span class="normal"> 289</span>
<span class="normal"> 290</span>
<span class="normal"> 291</span>
<span class="normal"> 292</span>
<span class="normal"> 293</span>
<span class="normal"> 294</span>
<span class="normal"> 295</span>
<span class="normal"> 296</span>
<span class="normal"> 297</span>
<span class="normal"> 298</span>
<span class="normal"> 299</span>
<span class="normal"> 300</span>
<span class="normal"> 301</span>
<span class="normal"> 302</span>
<span class="normal"> 303</span>
<span class="normal"> 304</span>
<span class="normal"> 305</span>
<span class="normal"> 306</span>
<span class="normal"> 307</span>
<span class="normal"> 308</span>
<span class="normal"> 309</span>
<span class="normal"> 310</span>
<span class="normal"> 311</span>
<span class="normal"> 312</span>
<span class="normal"> 313</span>
<span class="normal"> 314</span>
<span class="normal"> 315</span>
<span class="normal"> 316</span>
<span class="normal"> 317</span>
<span class="normal"> 318</span>
<span class="normal"> 319</span>
<span class="normal"> 320</span>
<span class="normal"> 321</span>
<span class="normal"> 322</span>
<span class="normal"> 323</span>
<span class="normal"> 324</span>
<span class="normal"> 325</span>
<span class="normal"> 326</span>
<span class="normal"> 327</span>
<span class="normal"> 328</span>
<span class="normal"> 329</span>
<span class="normal"> 330</span>
<span class="normal"> 331</span>
<span class="normal"> 332</span>
<span class="normal"> 333</span>
<span class="normal"> 334</span>
<span class="normal"> 335</span>
<span class="normal"> 336</span>
<span class="normal"> 337</span>
<span class="normal"> 338</span>
<span class="normal"> 339</span>
<span class="normal"> 340</span>
<span class="normal"> 341</span>
<span class="normal"> 342</span>
<span class="normal"> 343</span>
<span class="normal"> 344</span>
<span class="normal"> 345</span>
<span class="normal"> 346</span>
<span class="normal"> 347</span>
<span class="normal"> 348</span>
<span class="normal"> 349</span>
<span class="normal"> 350</span>
<span class="normal"> 351</span>
<span class="normal"> 352</span>
<span class="normal"> 353</span>
<span class="normal"> 354</span>
<span class="normal"> 355</span>
<span class="normal"> 356</span>
<span class="normal"> 357</span>
<span class="normal"> 358</span>
<span class="normal"> 359</span>
<span class="normal"> 360</span>
<span class="normal"> 361</span>
<span class="normal"> 362</span>
<span class="normal"> 363</span>
<span class="normal"> 364</span>
<span class="normal"> 365</span>
<span class="normal"> 366</span>
<span class="normal"> 367</span>
<span class="normal"> 368</span>
<span class="normal"> 369</span>
<span class="normal"> 370</span>
<span class="normal"> 371</span>
<span class="normal"> 372</span>
<span class="normal"> 373</span>
<span class="normal"> 374</span>
<span class="normal"> 375</span>
<span class="normal"> 376</span>
<span class="normal"> 377</span>
<span class="normal"> 378</span>
<span class="normal"> 379</span>
<span class="normal"> 380</span>
<span class="normal"> 381</span>
<span class="normal"> 382</span>
<span class="normal"> 383</span>
<span class="normal"> 384</span>
<span class="normal"> 385</span>
<span class="normal"> 386</span>
<span class="normal"> 387</span>
<span class="normal"> 388</span>
<span class="normal"> 389</span>
<span class="normal"> 390</span>
<span class="normal"> 391</span>
<span class="normal"> 392</span>
<span class="normal"> 393</span>
<span class="normal"> 394</span>
<span class="normal"> 395</span>
<span class="normal"> 396</span>
<span class="normal"> 397</span>
<span class="normal"> 398</span>
<span class="normal"> 399</span>
<span class="normal"> 400</span>
<span class="normal"> 401</span>
<span class="normal"> 402</span>
<span class="normal"> 403</span>
<span class="normal"> 404</span>
<span class="normal"> 405</span>
<span class="normal"> 406</span>
<span class="normal"> 407</span>
<span class="normal"> 408</span>
<span class="normal"> 409</span>
<span class="normal"> 410</span>
<span class="normal"> 411</span>
<span class="normal"> 412</span>
<span class="normal"> 413</span>
<span class="normal"> 414</span>
<span class="normal"> 415</span>
<span class="normal"> 416</span>
<span class="normal"> 417</span>
<span class="normal"> 418</span>
<span class="normal"> 419</span>
<span class="normal"> 420</span>
<span class="normal"> 421</span>
<span class="normal"> 422</span>
<span class="normal"> 423</span>
<span class="normal"> 424</span>
<span class="normal"> 425</span>
<span class="normal"> 426</span>
<span class="normal"> 427</span>
<span class="normal"> 428</span>
<span class="normal"> 429</span>
<span class="normal"> 430</span>
<span class="normal"> 431</span>
<span class="normal"> 432</span>
<span class="normal"> 433</span>
<span class="normal"> 434</span>
<span class="normal"> 435</span>
<span class="normal"> 436</span>
<span class="normal"> 437</span>
<span class="normal"> 438</span>
<span class="normal"> 439</span>
<span class="normal"> 440</span>
<span class="normal"> 441</span>
<span class="normal"> 442</span>
<span class="normal"> 443</span>
<span class="normal"> 444</span>
<span class="normal"> 445</span>
<span class="normal"> 446</span>
<span class="normal"> 447</span>
<span class="normal"> 448</span>
<span class="normal"> 449</span>
<span class="normal"> 450</span>
<span class="normal"> 451</span>
<span class="normal"> 452</span>
<span class="normal"> 453</span>
<span class="normal"> 454</span>
<span class="normal"> 455</span>
<span class="normal"> 456</span>
<span class="normal"> 457</span>
<span class="normal"> 458</span>
<span class="normal"> 459</span>
<span class="normal"> 460</span>
<span class="normal"> 461</span>
<span class="normal"> 462</span>
<span class="normal"> 463</span>
<span class="normal"> 464</span>
<span class="normal"> 465</span>
<span class="normal"> 466</span>
<span class="normal"> 467</span>
<span class="normal"> 468</span>
<span class="normal"> 469</span>
<span class="normal"> 470</span>
<span class="normal"> 471</span>
<span class="normal"> 472</span>
<span class="normal"> 473</span>
<span class="normal"> 474</span>
<span class="normal"> 475</span>
<span class="normal"> 476</span>
<span class="normal"> 477</span>
<span class="normal"> 478</span>
<span class="normal"> 479</span>
<span class="normal"> 480</span>
<span class="normal"> 481</span>
<span class="normal"> 482</span>
<span class="normal"> 483</span>
<span class="normal"> 484</span>
<span class="normal"> 485</span>
<span class="normal"> 486</span>
<span class="normal"> 487</span>
<span class="normal"> 488</span>
<span class="normal"> 489</span>
<span class="normal"> 490</span>
<span class="normal"> 491</span>
<span class="normal"> 492</span>
<span class="normal"> 493</span>
<span class="normal"> 494</span>
<span class="normal"> 495</span>
<span class="normal"> 496</span>
<span class="normal"> 497</span>
<span class="normal"> 498</span>
<span class="normal"> 499</span>
<span class="normal"> 500</span>
<span class="normal"> 501</span>
<span class="normal"> 502</span>
<span class="normal"> 503</span>
<span class="normal"> 504</span>
<span class="normal"> 505</span>
<span class="normal"> 506</span>
<span class="normal"> 507</span>
<span class="normal"> 508</span>
<span class="normal"> 509</span>
<span class="normal"> 510</span>
<span class="normal"> 511</span>
<span class="normal"> 512</span>
<span class="normal"> 513</span>
<span class="normal"> 514</span>
<span class="normal"> 515</span>
<span class="normal"> 516</span>
<span class="normal"> 517</span>
<span class="normal"> 518</span>
<span class="normal"> 519</span>
<span class="normal"> 520</span>
<span class="normal"> 521</span>
<span class="normal"> 522</span>
<span class="normal"> 523</span>
<span class="normal"> 524</span>
<span class="normal"> 525</span>
<span class="normal"> 526</span>
<span class="normal"> 527</span>
<span class="normal"> 528</span>
<span class="normal"> 529</span>
<span class="normal"> 530</span>
<span class="normal"> 531</span>
<span class="normal"> 532</span>
<span class="normal"> 533</span>
<span class="normal"> 534</span>
<span class="normal"> 535</span>
<span class="normal"> 536</span>
<span class="normal"> 537</span>
<span class="normal"> 538</span>
<span class="normal"> 539</span>
<span class="normal"> 540</span>
<span class="normal"> 541</span>
<span class="normal"> 542</span>
<span class="normal"> 543</span>
<span class="normal"> 544</span>
<span class="normal"> 545</span>
<span class="normal"> 546</span>
<span class="normal"> 547</span>
<span class="normal"> 548</span>
<span class="normal"> 549</span>
<span class="normal"> 550</span>
<span class="normal"> 551</span>
<span class="normal"> 552</span>
<span class="normal"> 553</span>
<span class="normal"> 554</span>
<span class="normal"> 555</span>
<span class="normal"> 556</span>
<span class="normal"> 557</span>
<span class="normal"> 558</span>
<span class="normal"> 559</span>
<span class="normal"> 560</span>
<span class="normal"> 561</span>
<span class="normal"> 562</span>
<span class="normal"> 563</span>
<span class="normal"> 564</span>
<span class="normal"> 565</span>
<span class="normal"> 566</span>
<span class="normal"> 567</span>
<span class="normal"> 568</span>
<span class="normal"> 569</span>
<span class="normal"> 570</span>
<span class="normal"> 571</span>
<span class="normal"> 572</span>
<span class="normal"> 573</span>
<span class="normal"> 574</span>
<span class="normal"> 575</span>
<span class="normal"> 576</span>
<span class="normal"> 577</span>
<span class="normal"> 578</span>
<span class="normal"> 579</span>
<span class="normal"> 580</span>
<span class="normal"> 581</span>
<span class="normal"> 582</span>
<span class="normal"> 583</span>
<span class="normal"> 584</span>
<span class="normal"> 585</span>
<span class="normal"> 586</span>
<span class="normal"> 587</span>
<span class="normal"> 588</span>
<span class="normal"> 589</span>
<span class="normal"> 590</span>
<span class="normal"> 591</span>
<span class="normal"> 592</span>
<span class="normal"> 593</span>
<span class="normal"> 594</span>
<span class="normal"> 595</span>
<span class="normal"> 596</span>
<span class="normal"> 597</span>
<span class="normal"> 598</span>
<span class="normal"> 599</span>
<span class="normal"> 600</span>
<span class="normal"> 601</span>
<span class="normal"> 602</span>
<span class="normal"> 603</span>
<span class="normal"> 604</span>
<span class="normal"> 605</span>
<span class="normal"> 606</span>
<span class="normal"> 607</span>
<span class="normal"> 608</span>
<span class="normal"> 609</span>
<span class="normal"> 610</span>
<span class="normal"> 611</span>
<span class="normal"> 612</span>
<span class="normal"> 613</span>
<span class="normal"> 614</span>
<span class="normal"> 615</span>
<span class="normal"> 616</span>
<span class="normal"> 617</span>
<span class="normal"> 618</span>
<span class="normal"> 619</span>
<span class="normal"> 620</span>
<span class="normal"> 621</span>
<span class="normal"> 622</span>
<span class="normal"> 623</span>
<span class="normal"> 624</span>
<span class="normal"> 625</span>
<span class="normal"> 626</span>
<span class="normal"> 627</span>
<span class="normal"> 628</span>
<span class="normal"> 629</span>
<span class="normal"> 630</span>
<span class="normal"> 631</span>
<span class="normal"> 632</span>
<span class="normal"> 633</span>
<span class="normal"> 634</span>
<span class="normal"> 635</span>
<span class="normal"> 636</span>
<span class="normal"> 637</span>
<span class="normal"> 638</span>
<span class="normal"> 639</span>
<span class="normal"> 640</span>
<span class="normal"> 641</span>
<span class="normal"> 642</span>
<span class="normal"> 643</span>
<span class="normal"> 644</span>
<span class="normal"> 645</span>
<span class="normal"> 646</span>
<span class="normal"> 647</span>
<span class="normal"> 648</span>
<span class="normal"> 649</span>
<span class="normal"> 650</span>
<span class="normal"> 651</span>
<span class="normal"> 652</span>
<span class="normal"> 653</span>
<span class="normal"> 654</span>
<span class="normal"> 655</span>
<span class="normal"> 656</span>
<span class="normal"> 657</span>
<span class="normal"> 658</span>
<span class="normal"> 659</span>
<span class="normal"> 660</span>
<span class="normal"> 661</span>
<span class="normal"> 662</span>
<span class="normal"> 663</span>
<span class="normal"> 664</span>
<span class="normal"> 665</span>
<span class="normal"> 666</span>
<span class="normal"> 667</span>
<span class="normal"> 668</span>
<span class="normal"> 669</span>
<span class="normal"> 670</span>
<span class="normal"> 671</span>
<span class="normal"> 672</span>
<span class="normal"> 673</span>
<span class="normal"> 674</span>
<span class="normal"> 675</span>
<span class="normal"> 676</span>
<span class="normal"> 677</span>
<span class="normal"> 678</span>
<span class="normal"> 679</span>
<span class="normal"> 680</span>
<span class="normal"> 681</span>
<span class="normal"> 682</span>
<span class="normal"> 683</span>
<span class="normal"> 684</span>
<span class="normal"> 685</span>
<span class="normal"> 686</span>
<span class="normal"> 687</span>
<span class="normal"> 688</span>
<span class="normal"> 689</span>
<span class="normal"> 690</span>
<span class="normal"> 691</span>
<span class="normal"> 692</span>
<span class="normal"> 693</span>
<span class="normal"> 694</span>
<span class="normal"> 695</span>
<span class="normal"> 696</span>
<span class="normal"> 697</span>
<span class="normal"> 698</span>
<span class="normal"> 699</span>
<span class="normal"> 700</span>
<span class="normal"> 701</span>
<span class="normal"> 702</span>
<span class="normal"> 703</span>
<span class="normal"> 704</span>
<span class="normal"> 705</span>
<span class="normal"> 706</span>
<span class="normal"> 707</span>
<span class="normal"> 708</span>
<span class="normal"> 709</span>
<span class="normal"> 710</span>
<span class="normal"> 711</span>
<span class="normal"> 712</span>
<span class="normal"> 713</span>
<span class="normal"> 714</span>
<span class="normal"> 715</span>
<span class="normal"> 716</span>
<span class="normal"> 717</span>
<span class="normal"> 718</span>
<span class="normal"> 719</span>
<span class="normal"> 720</span>
<span class="normal"> 721</span>
<span class="normal"> 722</span>
<span class="normal"> 723</span>
<span class="normal"> 724</span>
<span class="normal"> 725</span>
<span class="normal"> 726</span>
<span class="normal"> 727</span>
<span class="normal"> 728</span>
<span class="normal"> 729</span>
<span class="normal"> 730</span>
<span class="normal"> 731</span>
<span class="normal"> 732</span>
<span class="normal"> 733</span>
<span class="normal"> 734</span>
<span class="normal"> 735</span>
<span class="normal"> 736</span>
<span class="normal"> 737</span>
<span class="normal"> 738</span>
<span class="normal"> 739</span>
<span class="normal"> 740</span>
<span class="normal"> 741</span>
<span class="normal"> 742</span>
<span class="normal"> 743</span>
<span class="normal"> 744</span>
<span class="normal"> 745</span>
<span class="normal"> 746</span>
<span class="normal"> 747</span>
<span class="normal"> 748</span>
<span class="normal"> 749</span>
<span class="normal"> 750</span>
<span class="normal"> 751</span>
<span class="normal"> 752</span>
<span class="normal"> 753</span>
<span class="normal"> 754</span>
<span class="normal"> 755</span>
<span class="normal"> 756</span>
<span class="normal"> 757</span>
<span class="normal"> 758</span>
<span class="normal"> 759</span>
<span class="normal"> 760</span>
<span class="normal"> 761</span>
<span class="normal"> 762</span>
<span class="normal"> 763</span>
<span class="normal"> 764</span>
<span class="normal"> 765</span>
<span class="normal"> 766</span>
<span class="normal"> 767</span>
<span class="normal"> 768</span>
<span class="normal"> 769</span>
<span class="normal"> 770</span>
<span class="normal"> 771</span>
<span class="normal"> 772</span>
<span class="normal"> 773</span>
<span class="normal"> 774</span>
<span class="normal"> 775</span>
<span class="normal"> 776</span>
<span class="normal"> 777</span>
<span class="normal"> 778</span>
<span class="normal"> 779</span>
<span class="normal"> 780</span>
<span class="normal"> 781</span>
<span class="normal"> 782</span>
<span class="normal"> 783</span>
<span class="normal"> 784</span>
<span class="normal"> 785</span>
<span class="normal"> 786</span>
<span class="normal"> 787</span>
<span class="normal"> 788</span>
<span class="normal"> 789</span>
<span class="normal"> 790</span>
<span class="normal"> 791</span>
<span class="normal"> 792</span>
<span class="normal"> 793</span>
<span class="normal"> 794</span>
<span class="normal"> 795</span>
<span class="normal"> 796</span>
<span class="normal"> 797</span>
<span class="normal"> 798</span>
<span class="normal"> 799</span>
<span class="normal"> 800</span>
<span class="normal"> 801</span>
<span class="normal"> 802</span>
<span class="normal"> 803</span>
<span class="normal"> 804</span>
<span class="normal"> 805</span>
<span class="normal"> 806</span>
<span class="normal"> 807</span>
<span class="normal"> 808</span>
<span class="normal"> 809</span>
<span class="normal"> 810</span>
<span class="normal"> 811</span>
<span class="normal"> 812</span>
<span class="normal"> 813</span>
<span class="normal"> 814</span>
<span class="normal"> 815</span>
<span class="normal"> 816</span>
<span class="normal"> 817</span>
<span class="normal"> 818</span>
<span class="normal"> 819</span>
<span class="normal"> 820</span>
<span class="normal"> 821</span>
<span class="normal"> 822</span>
<span class="normal"> 823</span>
<span class="normal"> 824</span>
<span class="normal"> 825</span>
<span class="normal"> 826</span>
<span class="normal"> 827</span>
<span class="normal"> 828</span>
<span class="normal"> 829</span>
<span class="normal"> 830</span>
<span class="normal"> 831</span>
<span class="normal"> 832</span>
<span class="normal"> 833</span>
<span class="normal"> 834</span>
<span class="normal"> 835</span>
<span class="normal"> 836</span>
<span class="normal"> 837</span>
<span class="normal"> 838</span>
<span class="normal"> 839</span>
<span class="normal"> 840</span>
<span class="normal"> 841</span>
<span class="normal"> 842</span>
<span class="normal"> 843</span>
<span class="normal"> 844</span>
<span class="normal"> 845</span>
<span class="normal"> 846</span>
<span class="normal"> 847</span>
<span class="normal"> 848</span>
<span class="normal"> 849</span>
<span class="normal"> 850</span>
<span class="normal"> 851</span>
<span class="normal"> 852</span>
<span class="normal"> 853</span>
<span class="normal"> 854</span>
<span class="normal"> 855</span>
<span class="normal"> 856</span>
<span class="normal"> 857</span>
<span class="normal"> 858</span>
<span class="normal"> 859</span>
<span class="normal"> 860</span>
<span class="normal"> 861</span>
<span class="normal"> 862</span>
<span class="normal"> 863</span>
<span class="normal"> 864</span>
<span class="normal"> 865</span>
<span class="normal"> 866</span>
<span class="normal"> 867</span>
<span class="normal"> 868</span>
<span class="normal"> 869</span>
<span class="normal"> 870</span>
<span class="normal"> 871</span>
<span class="normal"> 872</span>
<span class="normal"> 873</span>
<span class="normal"> 874</span>
<span class="normal"> 875</span>
<span class="normal"> 876</span>
<span class="normal"> 877</span>
<span class="normal"> 878</span>
<span class="normal"> 879</span>
<span class="normal"> 880</span>
<span class="normal"> 881</span>
<span class="normal"> 882</span>
<span class="normal"> 883</span>
<span class="normal"> 884</span>
<span class="normal"> 885</span>
<span class="normal"> 886</span>
<span class="normal"> 887</span>
<span class="normal"> 888</span>
<span class="normal"> 889</span>
<span class="normal"> 890</span>
<span class="normal"> 891</span>
<span class="normal"> 892</span>
<span class="normal"> 893</span>
<span class="normal"> 894</span>
<span class="normal"> 895</span>
<span class="normal"> 896</span>
<span class="normal"> 897</span>
<span class="normal"> 898</span>
<span class="normal"> 899</span>
<span class="normal"> 900</span>
<span class="normal"> 901</span>
<span class="normal"> 902</span>
<span class="normal"> 903</span>
<span class="normal"> 904</span>
<span class="normal"> 905</span>
<span class="normal"> 906</span>
<span class="normal"> 907</span>
<span class="normal"> 908</span>
<span class="normal"> 909</span>
<span class="normal"> 910</span>
<span class="normal"> 911</span>
<span class="normal"> 912</span>
<span class="normal"> 913</span>
<span class="normal"> 914</span>
<span class="normal"> 915</span>
<span class="normal"> 916</span>
<span class="normal"> 917</span>
<span class="normal"> 918</span>
<span class="normal"> 919</span>
<span class="normal"> 920</span>
<span class="normal"> 921</span>
<span class="normal"> 922</span>
<span class="normal"> 923</span>
<span class="normal"> 924</span>
<span class="normal"> 925</span>
<span class="normal"> 926</span>
<span class="normal"> 927</span>
<span class="normal"> 928</span>
<span class="normal"> 929</span>
<span class="normal"> 930</span>
<span class="normal"> 931</span>
<span class="normal"> 932</span>
<span class="normal"> 933</span>
<span class="normal"> 934</span>
<span class="normal"> 935</span>
<span class="normal"> 936</span>
<span class="normal"> 937</span>
<span class="normal"> 938</span>
<span class="normal"> 939</span>
<span class="normal"> 940</span>
<span class="normal"> 941</span>
<span class="normal"> 942</span>
<span class="normal"> 943</span>
<span class="normal"> 944</span>
<span class="normal"> 945</span>
<span class="normal"> 946</span>
<span class="normal"> 947</span>
<span class="normal"> 948</span>
<span class="normal"> 949</span>
<span class="normal"> 950</span>
<span class="normal"> 951</span>
<span class="normal"> 952</span>
<span class="normal"> 953</span>
<span class="normal"> 954</span>
<span class="normal"> 955</span>
<span class="normal"> 956</span>
<span class="normal"> 957</span>
<span class="normal"> 958</span>
<span class="normal"> 959</span>
<span class="normal"> 960</span>
<span class="normal"> 961</span>
<span class="normal"> 962</span>
<span class="normal"> 963</span>
<span class="normal"> 964</span>
<span class="normal"> 965</span>
<span class="normal"> 966</span>
<span class="normal"> 967</span>
<span class="normal"> 968</span>
<span class="normal"> 969</span>
<span class="normal"> 970</span>
<span class="normal"> 971</span>
<span class="normal"> 972</span>
<span class="normal"> 973</span>
<span class="normal"> 974</span>
<span class="normal"> 975</span>
<span class="normal"> 976</span>
<span class="normal"> 977</span>
<span class="normal"> 978</span>
<span class="normal"> 979</span>
<span class="normal"> 980</span>
<span class="normal"> 981</span>
<span class="normal"> 982</span>
<span class="normal"> 983</span>
<span class="normal"> 984</span>
<span class="normal"> 985</span>
<span class="normal"> 986</span>
<span class="normal"> 987</span>
<span class="normal"> 988</span>
<span class="normal"> 989</span>
<span class="normal"> 990</span>
<span class="normal"> 991</span>
<span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span>
<span class="normal">1047</span>
<span class="normal">1048</span>
<span class="normal">1049</span>
<span class="normal">1050</span>
<span class="normal">1051</span>
<span class="normal">1052</span>
<span class="normal">1053</span>
<span class="normal">1054</span>
<span class="normal">1055</span>
<span class="normal">1056</span>
<span class="normal">1057</span>
<span class="normal">1058</span>
<span class="normal">1059</span>
<span class="normal">1060</span>
<span class="normal">1061</span>
<span class="normal">1062</span>
<span class="normal">1063</span>
<span class="normal">1064</span>
<span class="normal">1065</span>
<span class="normal">1066</span>
<span class="normal">1067</span>
<span class="normal">1068</span>
<span class="normal">1069</span>
<span class="normal">1070</span>
<span class="normal">1071</span>
<span class="normal">1072</span>
<span class="normal">1073</span>
<span class="normal">1074</span>
<span class="normal">1075</span>
<span class="normal">1076</span>
<span class="normal">1077</span>
<span class="normal">1078</span>
<span class="normal">1079</span>
<span class="normal">1080</span>
<span class="normal">1081</span>
<span class="normal">1082</span>
<span class="normal">1083</span>
<span class="normal">1084</span>
<span class="normal">1085</span>
<span class="normal">1086</span>
<span class="normal">1087</span>
<span class="normal">1088</span>
<span class="normal">1089</span>
<span class="normal">1090</span>
<span class="normal">1091</span>
<span class="normal">1092</span>
<span class="normal">1093</span>
<span class="normal">1094</span>
<span class="normal">1095</span>
<span class="normal">1096</span>
<span class="normal">1097</span>
<span class="normal">1098</span>
<span class="normal">1099</span>
<span class="normal">1100</span>
<span class="normal">1101</span>
<span class="normal">1102</span>
<span class="normal">1103</span>
<span class="normal">1104</span>
<span class="normal">1105</span>
<span class="normal">1106</span>
<span class="normal">1107</span>
<span class="normal">1108</span>
<span class="normal">1109</span>
<span class="normal">1110</span>
<span class="normal">1111</span>
<span class="normal">1112</span>
<span class="normal">1113</span>
<span class="normal">1114</span>
<span class="normal">1115</span>
<span class="normal">1116</span>
<span class="normal">1117</span>
<span class="normal">1118</span>
<span class="normal">1119</span>
<span class="normal">1120</span>
<span class="normal">1121</span>
<span class="normal">1122</span>
<span class="normal">1123</span>
<span class="normal">1124</span>
<span class="normal">1125</span>
<span class="normal">1126</span>
<span class="normal">1127</span>
<span class="normal">1128</span>
<span class="normal">1129</span>
<span class="normal">1130</span>
<span class="normal">1131</span>
<span class="normal">1132</span>
<span class="normal">1133</span>
<span class="normal">1134</span>
<span class="normal">1135</span>
<span class="normal">1136</span>
<span class="normal">1137</span>
<span class="normal">1138</span>
<span class="normal">1139</span>
<span class="normal">1140</span>
<span class="normal">1141</span>
<span class="normal">1142</span>
<span class="normal">1143</span>
<span class="normal">1144</span>
<span class="normal">1145</span>
<span class="normal">1146</span>
<span class="normal">1147</span>
<span class="normal">1148</span>
<span class="normal">1149</span>
<span class="normal">1150</span>
<span class="normal">1151</span>
<span class="normal">1152</span>
<span class="normal">1153</span>
<span class="normal">1154</span>
<span class="normal">1155</span>
<span class="normal">1156</span>
<span class="normal">1157</span>
<span class="normal">1158</span>
<span class="normal">1159</span>
<span class="normal">1160</span>
<span class="normal">1161</span>
<span class="normal">1162</span>
<span class="normal">1163</span>
<span class="normal">1164</span>
<span class="normal">1165</span>
<span class="normal">1166</span>
<span class="normal">1167</span>
<span class="normal">1168</span>
<span class="normal">1169</span>
<span class="normal">1170</span>
<span class="normal">1171</span>
<span class="normal">1172</span>
<span class="normal">1173</span>
<span class="normal">1174</span>
<span class="normal">1175</span>
<span class="normal">1176</span>
<span class="normal">1177</span>
<span class="normal">1178</span>
<span class="normal">1179</span>
<span class="normal">1180</span>
<span class="normal">1181</span>
<span class="normal">1182</span>
<span class="normal">1183</span>
<span class="normal">1184</span>
<span class="normal">1185</span>
<span class="normal">1186</span>
<span class="normal">1187</span>
<span class="normal">1188</span>
<span class="normal">1189</span>
<span class="normal">1190</span>
<span class="normal">1191</span>
<span class="normal">1192</span>
<span class="normal">1193</span>
<span class="normal">1194</span>
<span class="normal">1195</span>
<span class="normal">1196</span>
<span class="normal">1197</span>
<span class="normal">1198</span>
<span class="normal">1199</span>
<span class="normal">1200</span>
<span class="normal">1201</span>
<span class="normal">1202</span>
<span class="normal">1203</span>
<span class="normal">1204</span>
<span class="normal">1205</span>
<span class="normal">1206</span>
<span class="normal">1207</span>
<span class="normal">1208</span>
<span class="normal">1209</span>
<span class="normal">1210</span>
<span class="normal">1211</span>
<span class="normal">1212</span>
<span class="normal">1213</span>
<span class="normal">1214</span>
<span class="normal">1215</span>
<span class="normal">1216</span>
<span class="normal">1217</span>
<span class="normal">1218</span>
<span class="normal">1219</span>
<span class="normal">1220</span>
<span class="normal">1221</span>
<span class="normal">1222</span>
<span class="normal">1223</span>
<span class="normal">1224</span>
<span class="normal">1225</span>
<span class="normal">1226</span>
<span class="normal">1227</span>
<span class="normal">1228</span>
<span class="normal">1229</span>
<span class="normal">1230</span>
<span class="normal">1231</span>
<span class="normal">1232</span>
<span class="normal">1233</span>
<span class="normal">1234</span>
<span class="normal">1235</span>
<span class="normal">1236</span>
<span class="normal">1237</span>
<span class="normal">1238</span>
<span class="normal">1239</span>
<span class="normal">1240</span>
<span class="normal">1241</span>
<span class="normal">1242</span>
<span class="normal">1243</span>
<span class="normal">1244</span>
<span class="normal">1245</span>
<span class="normal">1246</span>
<span class="normal">1247</span>
<span class="normal">1248</span>
<span class="normal">1249</span>
<span class="normal">1250</span>
<span class="normal">1251</span>
<span class="normal">1252</span>
<span class="normal">1253</span>
<span class="normal">1254</span>
<span class="normal">1255</span>
<span class="normal">1256</span>
<span class="normal">1257</span>
<span class="normal">1258</span>
<span class="normal">1259</span>
<span class="normal">1260</span>
<span class="normal">1261</span>
<span class="normal">1262</span>
<span class="normal">1263</span>
<span class="normal">1264</span>
<span class="normal">1265</span>
<span class="normal">1266</span>
<span class="normal">1267</span>
<span class="normal">1268</span>
<span class="normal">1269</span>
<span class="normal">1270</span>
<span class="normal">1271</span>
<span class="normal">1272</span>
<span class="normal">1273</span>
<span class="normal">1274</span>
<span class="normal">1275</span>
<span class="normal">1276</span>
<span class="normal">1277</span>
<span class="normal">1278</span>
<span class="normal">1279</span>
<span class="normal">1280</span>
<span class="normal">1281</span>
<span class="normal">1282</span>
<span class="normal">1283</span>
<span class="normal">1284</span>
<span class="normal">1285</span>
<span class="normal">1286</span>
<span class="normal">1287</span>
<span class="normal">1288</span>
<span class="normal">1289</span>
<span class="normal">1290</span>
<span class="normal">1291</span>
<span class="normal">1292</span>
<span class="normal">1293</span>
<span class="normal">1294</span>
<span class="normal">1295</span>
<span class="normal">1296</span>
<span class="normal">1297</span>
<span class="normal">1298</span>
<span class="normal">1299</span>
<span class="normal">1300</span>
<span class="normal">1301</span>
<span class="normal">1302</span>
<span class="normal">1303</span>
<span class="normal">1304</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">DerivaML</span><span class="p">(</span>
    <span class="n">PathBuilderMixin</span><span class="p">,</span>
    <span class="n">RidResolutionMixin</span><span class="p">,</span>
    <span class="n">VocabularyMixin</span><span class="p">,</span>
    <span class="n">WorkflowMixin</span><span class="p">,</span>
    <span class="n">FeatureMixin</span><span class="p">,</span>
    <span class="n">DatasetMixin</span><span class="p">,</span>
    <span class="n">AssetMixin</span><span class="p">,</span>
    <span class="n">ExecutionMixin</span><span class="p">,</span>
    <span class="n">FileMixin</span><span class="p">,</span>
    <span class="n">AnnotationMixin</span><span class="p">,</span>
    <span class="n">DerivaMLCatalog</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Core class for machine learning operations on a Deriva catalog.</span>

<span class="sd">    This class provides core functionality for managing ML workflows, features, and datasets in a Deriva catalog.</span>
<span class="sd">    It handles data versioning, feature management, vocabulary control, and execution tracking.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        host_name (str): Hostname of the Deriva server (e.g., &#39;deriva.example.org&#39;).</span>
<span class="sd">        catalog_id (Union[str, int]): Catalog identifier or name.</span>
<span class="sd">        domain_schema (str): Schema name for domain-specific tables and relationships.</span>
<span class="sd">        model (DerivaModel): ERMRest model for the catalog.</span>
<span class="sd">        working_dir (Path): Directory for storing computation data and results.</span>
<span class="sd">        cache_dir (Path): Directory for caching downloaded datasets.</span>
<span class="sd">        ml_schema (str): Schema name for ML-specific tables (default: &#39;deriva_ml&#39;).</span>
<span class="sd">        configuration (ExecutionConfiguration): Current execution configuration.</span>
<span class="sd">        project_name (str): Name of the current project.</span>
<span class="sd">        start_time (datetime): Timestamp when this instance was created.</span>
<span class="sd">        status (str): Current status of operations.</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; ml = DerivaML(&#39;deriva.example.org&#39;, &#39;my_catalog&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ml.create_feature(&#39;my_table&#39;, &#39;new_feature&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ml.add_term(&#39;vocabulary_table&#39;, &#39;new_term&#39;, description=&#39;Description of term&#39;)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Class-level type annotations for DerivaMLCatalog protocol compliance</span>
    <span class="n">ml_schema</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">domain_schemas</span><span class="p">:</span> <span class="nb">frozenset</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
    <span class="n">default_schema</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span>
    <span class="n">model</span><span class="p">:</span> <span class="n">DerivaModel</span>
    <span class="n">cache_dir</span><span class="p">:</span> <span class="n">Path</span>
    <span class="n">working_dir</span><span class="p">:</span> <span class="n">Path</span>
    <span class="n">catalog</span><span class="p">:</span> <span class="n">ErmrestCatalog</span> <span class="o">|</span> <span class="n">ErmrestSnapshot</span>
    <span class="n">catalog_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">int</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">instantiate</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">DerivaMLConfig</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a DerivaML instance from a configuration object.</span>

<span class="sd">        This method is the preferred way to instantiate DerivaML when using hydra-zen</span>
<span class="sd">        for configuration management. It accepts a DerivaMLConfig (Pydantic model) and</span>
<span class="sd">        unpacks it to create the instance.</span>

<span class="sd">        This pattern allows hydra-zen&#39;s `instantiate()` to work with DerivaML:</span>

<span class="sd">        Example with hydra-zen:</span>
<span class="sd">            &gt;&gt;&gt; from hydra_zen import builds, instantiate</span>
<span class="sd">            &gt;&gt;&gt; from deriva_ml import DerivaML</span>
<span class="sd">            &gt;&gt;&gt; from deriva_ml.core.config import DerivaMLConfig</span>
<span class="sd">            &gt;&gt;&gt;</span>
<span class="sd">            &gt;&gt;&gt; # Create a structured config using hydra-zen</span>
<span class="sd">            &gt;&gt;&gt; DerivaMLConf = builds(DerivaMLConfig, populate_full_signature=True)</span>
<span class="sd">            &gt;&gt;&gt;</span>
<span class="sd">            &gt;&gt;&gt; # Configure for your environment</span>
<span class="sd">            &gt;&gt;&gt; conf = DerivaMLConf(</span>
<span class="sd">            ...     hostname=&#39;deriva.example.org&#39;,</span>
<span class="sd">            ...     catalog_id=&#39;42&#39;,</span>
<span class="sd">            ...     domain_schema=&#39;my_domain&#39;,</span>
<span class="sd">            ... )</span>
<span class="sd">            &gt;&gt;&gt;</span>
<span class="sd">            &gt;&gt;&gt; # Instantiate the config to get a DerivaMLConfig object</span>
<span class="sd">            &gt;&gt;&gt; config = instantiate(conf)</span>
<span class="sd">            &gt;&gt;&gt;</span>
<span class="sd">            &gt;&gt;&gt; # Create the DerivaML instance</span>
<span class="sd">            &gt;&gt;&gt; ml = DerivaML.instantiate(config)</span>

<span class="sd">        Args:</span>
<span class="sd">            config: A DerivaMLConfig object containing all configuration parameters.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A new DerivaML instance configured according to the config object.</span>

<span class="sd">        Note:</span>
<span class="sd">            The DerivaMLConfig class integrates with Hydra&#39;s configuration system</span>
<span class="sd">            and registers custom resolvers for computing working directories.</span>
<span class="sd">            See `deriva_ml.core.config` for details on configuration options.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="o">**</span><span class="n">config</span><span class="o">.</span><span class="n">model_dump</span><span class="p">())</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">hostname</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">catalog_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">domain_schemas</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">set</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">default_schema</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">project_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">cache_dir</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">working_dir</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">hydra_runtime_output_dir</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">ml_schema</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">ML_SCHEMA</span><span class="p">,</span>
        <span class="n">logging_level</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">WARNING</span><span class="p">,</span>
        <span class="n">deriva_logging_level</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">WARNING</span><span class="p">,</span>
        <span class="n">credential</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">s3_bucket</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">use_minid</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">check_auth</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">clean_execution_dir</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initializes a DerivaML instance.</span>

<span class="sd">        This method will connect to a catalog and initialize local configuration for the ML execution.</span>
<span class="sd">        This class is intended to be used as a base class on which domain-specific interfaces are built.</span>

<span class="sd">        Args:</span>
<span class="sd">            hostname: Hostname of the Deriva server.</span>
<span class="sd">            catalog_id: Catalog ID. Either an identifier or a catalog name.</span>
<span class="sd">            domain_schemas: Optional set of domain schema names. If None, auto-detects all</span>
<span class="sd">                non-system schemas. Use this when working with catalogs that have multiple</span>
<span class="sd">                user-defined schemas.</span>
<span class="sd">            default_schema: The default schema for table creation operations. If None and</span>
<span class="sd">                there is exactly one domain schema, that schema is used. If there are multiple</span>
<span class="sd">                domain schemas, this must be specified for table creation to work without</span>
<span class="sd">                explicit schema parameters.</span>
<span class="sd">            ml_schema: Schema name for ML schema. Used if you have a non-standard configuration of deriva-ml.</span>
<span class="sd">            project_name: Project name. Defaults to name of default_schema.</span>
<span class="sd">            cache_dir: Directory path for caching data downloaded from the Deriva server as bdbag. If not provided,</span>
<span class="sd">                will default to working_dir.</span>
<span class="sd">            working_dir: Directory path for storing data used by or generated by any computations. If no value is</span>
<span class="sd">                provided, will default to  ${HOME}/deriva_ml</span>
<span class="sd">            s3_bucket: S3 bucket URL for dataset bag storage (e.g., &#39;s3://my-bucket&#39;). If provided,</span>
<span class="sd">                enables MINID creation and S3 upload for dataset exports. If None, MINID functionality</span>
<span class="sd">                is disabled regardless of use_minid setting.</span>
<span class="sd">            use_minid: Use the MINID service when downloading dataset bags. Only effective when</span>
<span class="sd">                s3_bucket is configured. If None (default), automatically set to True when s3_bucket</span>
<span class="sd">                is provided, False otherwise.</span>
<span class="sd">            check_auth: Check if the user has access to the catalog.</span>
<span class="sd">            clean_execution_dir: Whether to automatically clean up execution working directories</span>
<span class="sd">                after successful upload. Defaults to True. Set to False to retain local copies.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Get or use provided credentials for server access</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">credential</span> <span class="o">=</span> <span class="n">credential</span> <span class="ow">or</span> <span class="n">get_credential</span><span class="p">(</span><span class="n">hostname</span><span class="p">)</span>

        <span class="c1"># Initialize server connection and catalog access</span>
        <span class="n">server</span> <span class="o">=</span> <span class="n">DerivaServer</span><span class="p">(</span>
            <span class="s2">&quot;https&quot;</span><span class="p">,</span>
            <span class="n">hostname</span><span class="p">,</span>
            <span class="n">credentials</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">credential</span><span class="p">,</span>
            <span class="n">session_config</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_session_config</span><span class="p">(),</span>
        <span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">check_auth</span> <span class="ow">and</span> <span class="n">server</span><span class="o">.</span><span class="n">get_authn_session</span><span class="p">():</span>
                <span class="k">pass</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DerivaMLException</span><span class="p">(</span>
                <span class="s2">&quot;You are not authorized to access this catalog. &quot;</span>
                <span class="s2">&quot;Please check your credentials and make sure you have logged in.&quot;</span>
            <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">catalog</span> <span class="o">=</span> <span class="n">server</span><span class="o">.</span><span class="n">connect_ermrest</span><span class="p">(</span><span class="n">catalog_id</span><span class="p">)</span>
        <span class="c1"># Import here to avoid circular imports</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">deriva_ml.model.catalog</span><span class="w"> </span><span class="kn">import</span> <span class="n">DerivaModel</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">DerivaModel</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">catalog</span><span class="o">.</span><span class="n">getCatalogModel</span><span class="p">(),</span>
            <span class="n">ml_schema</span><span class="o">=</span><span class="n">ml_schema</span><span class="p">,</span>
            <span class="n">domain_schemas</span><span class="o">=</span><span class="n">domain_schemas</span><span class="p">,</span>
            <span class="n">default_schema</span><span class="o">=</span><span class="n">default_schema</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="c1"># Store S3 bucket configuration and resolve use_minid</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">s3_bucket</span> <span class="o">=</span> <span class="n">s3_bucket</span>
        <span class="k">if</span> <span class="n">use_minid</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># Auto mode: enable MINID if s3_bucket is configured</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">use_minid</span> <span class="o">=</span> <span class="n">s3_bucket</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
        <span class="k">elif</span> <span class="n">use_minid</span> <span class="ow">and</span> <span class="n">s3_bucket</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># User requested MINID but no S3 bucket configured - disable MINID</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">use_minid</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">use_minid</span> <span class="o">=</span> <span class="n">use_minid</span>

        <span class="c1"># Set up working and cache directories</span>
        <span class="c1"># If working_dir is already provided (e.g. from DerivaMLConfig.instantiate()),</span>
        <span class="c1"># use it directly; otherwise compute the default path.</span>
        <span class="k">if</span> <span class="n">working_dir</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">working_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">working_dir</span><span class="p">)</span><span class="o">.</span><span class="n">absolute</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">working_dir</span> <span class="o">=</span> <span class="n">DerivaMLConfig</span><span class="o">.</span><span class="n">compute_workdir</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">catalog_id</span><span class="p">,</span> <span class="n">hostname</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">working_dir</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hydra_runtime_output_dir</span> <span class="o">=</span> <span class="n">hydra_runtime_output_dir</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">cache_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">cache_dir</span><span class="p">)</span> <span class="k">if</span> <span class="n">cache_dir</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">working_dir</span> <span class="o">/</span> <span class="s2">&quot;cache&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cache_dir</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># Set up logging using centralized configuration</span>
        <span class="c1"># This configures deriva_ml, Hydra, and deriva-py loggers without</span>
        <span class="c1"># affecting the root logger or calling basicConfig()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_logger</span> <span class="o">=</span> <span class="n">configure_logging</span><span class="p">(</span>
            <span class="n">level</span><span class="o">=</span><span class="n">logging_level</span><span class="p">,</span>
            <span class="n">deriva_level</span><span class="o">=</span><span class="n">deriva_logging_level</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_logging_level</span> <span class="o">=</span> <span class="n">logging_level</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_deriva_logging_level</span> <span class="o">=</span> <span class="n">deriva_logging_level</span>

        <span class="c1"># Apply deriva&#39;s default logger overrides for fine-grained control</span>
        <span class="n">apply_logger_overrides</span><span class="p">(</span><span class="n">DEFAULT_LOGGER_OVERRIDES</span><span class="p">)</span>

        <span class="c1"># Store instance configuration</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">host_name</span> <span class="o">=</span> <span class="n">hostname</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">catalog_id</span> <span class="o">=</span> <span class="n">catalog_id</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ml_schema</span> <span class="o">=</span> <span class="n">ml_schema</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">configuration</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_execution</span><span class="p">:</span> <span class="n">Execution</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">domain_schemas</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">domain_schemas</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">default_schema</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">default_schema</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">project_name</span> <span class="o">=</span> <span class="n">project_name</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_schema</span> <span class="ow">or</span> <span class="s2">&quot;deriva-ml&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">start_time</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">status</span> <span class="o">=</span> <span class="n">Status</span><span class="o">.</span><span class="n">pending</span><span class="o">.</span><span class="n">value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">clean_execution_dir</span> <span class="o">=</span> <span class="n">clean_execution_dir</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__del__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Cleanup method to handle incomplete executions.&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Mark execution as aborted if not completed</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_execution</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_execution</span><span class="o">.</span><span class="n">status</span> <span class="o">!=</span> <span class="n">Status</span><span class="o">.</span><span class="n">completed</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_execution</span><span class="o">.</span><span class="n">update_status</span><span class="p">(</span><span class="n">Status</span><span class="o">.</span><span class="n">aborted</span><span class="p">,</span> <span class="s2">&quot;Execution Aborted&quot;</span><span class="p">)</span>
        <span class="k">except</span> <span class="p">(</span><span class="ne">AttributeError</span><span class="p">,</span> <span class="n">requests</span><span class="o">.</span><span class="n">HTTPError</span><span class="p">):</span>
            <span class="k">pass</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_get_session_config</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns customized HTTP session configuration.</span>

<span class="sd">        Configures retry behavior and connection settings for HTTP requests to the Deriva server. Settings include:</span>
<span class="sd">        - Idempotent retry behavior for all HTTP methods</span>
<span class="sd">        - Increased retry attempts for read and connect operations</span>
<span class="sd">        - Exponential backoff for retries</span>

<span class="sd">        Returns:</span>
<span class="sd">            dict: Session configuration dictionary with retry and connection settings.</span>

<span class="sd">        Example:</span>
<span class="sd">            &gt;&gt;&gt; config = DerivaML._get_session_config()</span>
<span class="sd">            &gt;&gt;&gt; print(config[&#39;retry_read&#39;]) # 8</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Start with a default configuration</span>
        <span class="n">session_config</span> <span class="o">=</span> <span class="n">DEFAULT_SESSION_CONFIG</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="c1"># Customize retry behavior for robustness</span>
        <span class="n">session_config</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
            <span class="p">{</span>
                <span class="c1"># Allow retries for all HTTP methods (PUT/POST are idempotent)</span>
                <span class="s2">&quot;allow_retry_on_all_methods&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                <span class="c1"># Increase retry attempts for better reliability</span>
                <span class="s2">&quot;retry_read&quot;</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span>
                <span class="s2">&quot;retry_connect&quot;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
                <span class="c1"># Use exponential backoff for retries</span>
                <span class="s2">&quot;retry_backoff_factor&quot;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
            <span class="p">}</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">session_config</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">is_snapshot</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">catalog</span><span class="p">,</span> <span class="s2">&quot;_snaptime&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">catalog_snapshot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">version_snapshot</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns a DerivaML instance for a specific snapshot of the catalog.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">DerivaML</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">host_name</span><span class="p">,</span>
            <span class="n">version_snapshot</span><span class="p">,</span>
            <span class="n">logging_level</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_logging_level</span><span class="p">,</span>
            <span class="n">deriva_logging_level</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_deriva_logging_level</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_dataset_table</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Table</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">schemas</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">ml_schema</span><span class="p">]</span><span class="o">.</span><span class="n">tables</span><span class="p">[</span><span class="s2">&quot;Dataset&quot;</span><span class="p">]</span>

    <span class="c1"># pathBuilder, domain_path, table_path moved to PathBuilderMixin</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">download_dir</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cached</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Path</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the appropriate download directory.</span>

<span class="sd">        Provides the appropriate directory path for storing downloaded files, either in the cache or working directory.</span>

<span class="sd">        Args:</span>
<span class="sd">            cached: If True, returns the cache directory path. If False, returns the working directory path.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Path: Directory path where downloaded files should be stored.</span>

<span class="sd">        Example:</span>
<span class="sd">            &gt;&gt;&gt; cache_dir = ml.download_dir(cached=True)</span>
<span class="sd">            &gt;&gt;&gt; work_dir = ml.download_dir(cached=False)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Return cache directory if cached=True, otherwise working directory</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">cache_dir</span> <span class="k">if</span> <span class="n">cached</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">working_dir</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">globus_login</span><span class="p">(</span><span class="n">host</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Authenticates with Globus for accessing Deriva services.</span>

<span class="sd">        Performs authentication using Globus Auth to access Deriva services. If already logged in, notifies the user.</span>
<span class="sd">        Uses non-interactive authentication flow without a browser or local server.</span>

<span class="sd">        Args:</span>
<span class="sd">            host: The hostname of the Deriva server to authenticate with (e.g., &#39;deriva.example.org&#39;).</span>

<span class="sd">        Example:</span>
<span class="sd">            &gt;&gt;&gt; DerivaML.globus_login(&#39;deriva.example.org&#39;)</span>
<span class="sd">            &#39;Login Successful&#39;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">gnl</span> <span class="o">=</span> <span class="n">GlobusNativeLogin</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="n">host</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">gnl</span><span class="o">.</span><span class="n">is_logged_in</span><span class="p">([</span><span class="n">host</span><span class="p">]):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;You are already logged in.&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">gnl</span><span class="o">.</span><span class="n">login</span><span class="p">(</span>
                <span class="p">[</span><span class="n">host</span><span class="p">],</span>
                <span class="n">no_local_server</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">no_browser</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">refresh_tokens</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">update_bdbag_keychain</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Login Successful&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">chaise_url</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">:</span> <span class="n">RID</span> <span class="o">|</span> <span class="n">Table</span> <span class="o">|</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Generates Chaise web interface URL.</span>

<span class="sd">        Chaise is Deriva&#39;s web interface for data exploration. This method creates a URL that directly links to</span>
<span class="sd">        the specified table or record.</span>

<span class="sd">        Args:</span>
<span class="sd">            table: Table to generate URL for (name, Table object, or RID).</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: URL in format: https://{host}/chaise/recordset/#{catalog}/{schema}:{table}</span>

<span class="sd">        Raises:</span>
<span class="sd">            DerivaMLException: If table or RID cannot be found.</span>

<span class="sd">        Examples:</span>
<span class="sd">            Using table name:</span>
<span class="sd">                &gt;&gt;&gt; ml.chaise_url(&quot;experiment_table&quot;)</span>
<span class="sd">                &#39;https://deriva.org/chaise/recordset/#1/schema:experiment_table&#39;</span>

<span class="sd">            Using RID:</span>
<span class="sd">                &gt;&gt;&gt; ml.chaise_url(&quot;1-abc123&quot;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Get the table object and build base URI</span>
        <span class="n">table_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">name_to_table</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">uri</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">catalog</span><span class="o">.</span><span class="n">get_server_uri</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;ermrest/catalog/&quot;</span><span class="p">,</span> <span class="s2">&quot;chaise/recordset/#&quot;</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">DerivaMLException</span><span class="p">:</span>
            <span class="c1"># Handle RID case</span>
            <span class="n">uri</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cite</span><span class="p">(</span><span class="n">cast</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">table</span><span class="p">))</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">uri</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">urlquote</span><span class="p">(</span><span class="n">table_obj</span><span class="o">.</span><span class="n">schema</span><span class="o">.</span><span class="n">name</span><span class="p">)</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">urlquote</span><span class="p">(</span><span class="n">table_obj</span><span class="o">.</span><span class="n">name</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">cite</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entity</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="nb">str</span><span class="p">,</span> <span class="n">current</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Generates citation URL for an entity.</span>

<span class="sd">        Creates a URL that can be used to reference a specific entity in the catalog.</span>
<span class="sd">        By default, includes the catalog snapshot time to ensure version stability</span>
<span class="sd">        (permanent citation). With current=True, returns a URL to the current state.</span>

<span class="sd">        Args:</span>
<span class="sd">            entity: Either a RID string or a dictionary containing entity data with a &#39;RID&#39; key.</span>
<span class="sd">            current: If True, return URL to current catalog state (no snapshot).</span>
<span class="sd">                     If False (default), return permanent citation URL with snapshot time.</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: Citation URL. Format depends on `current` parameter:</span>
<span class="sd">                - current=False: https://{host}/id/{catalog}/{rid}@{snapshot_time}</span>
<span class="sd">                - current=True: https://{host}/id/{catalog}/{rid}</span>

<span class="sd">        Raises:</span>
<span class="sd">            DerivaMLException: If an entity doesn&#39;t exist or lacks a RID.</span>

<span class="sd">        Examples:</span>
<span class="sd">            Permanent citation (default):</span>
<span class="sd">                &gt;&gt;&gt; url = ml.cite(&quot;1-abc123&quot;)</span>
<span class="sd">                &gt;&gt;&gt; print(url)</span>
<span class="sd">                &#39;https://deriva.org/id/1/1-abc123@2024-01-01T12:00:00&#39;</span>

<span class="sd">            Current catalog URL:</span>
<span class="sd">                &gt;&gt;&gt; url = ml.cite(&quot;1-abc123&quot;, current=True)</span>
<span class="sd">                &gt;&gt;&gt; print(url)</span>
<span class="sd">                &#39;https://deriva.org/id/1/1-abc123&#39;</span>

<span class="sd">            Using a dictionary:</span>
<span class="sd">                &gt;&gt;&gt; url = ml.cite({&quot;RID&quot;: &quot;1-abc123&quot;})</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Return if already a citation URL</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">entity</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="n">entity</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;https://</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">host_name</span><span class="si">}</span><span class="s2">/id/</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">catalog_id</span><span class="si">}</span><span class="s2">/&quot;</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">entity</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Resolve RID and create citation URL</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">resolve_rid</span><span class="p">(</span><span class="n">rid</span> <span class="o">:=</span> <span class="n">entity</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">entity</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">else</span> <span class="n">entity</span><span class="p">[</span><span class="s2">&quot;RID&quot;</span><span class="p">])</span>
            <span class="n">base_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;https://</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">host_name</span><span class="si">}</span><span class="s2">/id/</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">catalog_id</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">rid</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="k">if</span> <span class="n">current</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">base_url</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">base_url</span><span class="si">}</span><span class="s2">@</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">catalog</span><span class="o">.</span><span class="n">latest_snapshot</span><span class="p">()</span><span class="o">.</span><span class="n">snaptime</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">except</span> <span class="ne">KeyError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DerivaMLException</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Entity </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2"> does not have RID column&quot;</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">DerivaMLException</span> <span class="k">as</span> <span class="n">_e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DerivaMLException</span><span class="p">(</span><span class="s2">&quot;Entity RID does not exist&quot;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">catalog_provenance</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;CatalogProvenance | None&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the provenance information for this catalog.</span>

<span class="sd">        Returns provenance information if the catalog has it set. This includes</span>
<span class="sd">        information about how the catalog was created (clone, create, schema),</span>
<span class="sd">        who created it, when, and any workflow information.</span>

<span class="sd">        For cloned catalogs, additional details about the clone operation are</span>
<span class="sd">        available in the `clone_details` attribute.</span>

<span class="sd">        Returns:</span>
<span class="sd">            CatalogProvenance if available, None otherwise.</span>

<span class="sd">        Example:</span>
<span class="sd">            &gt;&gt;&gt; ml = DerivaML(&#39;localhost&#39;, &#39;45&#39;)</span>
<span class="sd">            &gt;&gt;&gt; prov = ml.catalog_provenance</span>
<span class="sd">            &gt;&gt;&gt; if prov:</span>
<span class="sd">            ...     print(f&quot;Created: {prov.created_at} by {prov.created_by}&quot;)</span>
<span class="sd">            ...     print(f&quot;Method: {prov.creation_method.value}&quot;)</span>
<span class="sd">            ...     if prov.is_clone:</span>
<span class="sd">            ...         print(f&quot;Cloned from: {prov.clone_details.source_hostname}&quot;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">deriva_ml.catalog.clone</span><span class="w"> </span><span class="kn">import</span> <span class="n">get_catalog_provenance</span>

        <span class="k">return</span> <span class="n">get_catalog_provenance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">catalog</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">user_list</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns catalog user list.</span>

<span class="sd">        Retrieves basic information about all users who have access to the catalog, including their</span>
<span class="sd">        identifiers and full names.</span>

<span class="sd">        Returns:</span>
<span class="sd">            List[Dict[str, str]]: List of user information dictionaries, each containing:</span>
<span class="sd">                - &#39;ID&#39;: User identifier</span>
<span class="sd">                - &#39;Full_Name&#39;: User&#39;s full name</span>

<span class="sd">        Examples:</span>

<span class="sd">            &gt;&gt;&gt; users = ml.user_list()</span>
<span class="sd">            &gt;&gt;&gt; for user in users:</span>
<span class="sd">            ...     print(f&quot;{user[&#39;Full_Name&#39;]} ({user[&#39;ID&#39;]})&quot;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Get the user table path and fetch basic user info</span>
        <span class="n">user_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pathBuilder</span><span class="p">()</span><span class="o">.</span><span class="n">public</span><span class="o">.</span><span class="n">ERMrest_Client</span><span class="o">.</span><span class="n">path</span>
        <span class="k">return</span> <span class="p">[{</span><span class="s2">&quot;ID&quot;</span><span class="p">:</span> <span class="n">u</span><span class="p">[</span><span class="s2">&quot;ID&quot;</span><span class="p">],</span> <span class="s2">&quot;Full_Name&quot;</span><span class="p">:</span> <span class="n">u</span><span class="p">[</span><span class="s2">&quot;Full_Name&quot;</span><span class="p">]}</span> <span class="k">for</span> <span class="n">u</span> <span class="ow">in</span> <span class="n">user_path</span><span class="o">.</span><span class="n">entities</span><span class="p">()</span><span class="o">.</span><span class="n">fetch</span><span class="p">()]</span>

    <span class="c1"># resolve_rid, retrieve_rid moved to RidResolutionMixin</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">apply_catalog_annotations</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">navbar_brand_text</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;ML Data Browser&quot;</span><span class="p">,</span>
        <span class="n">head_title</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;Catalog ML&quot;</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Apply catalog-level annotations including the navigation bar and display settings.</span>

<span class="sd">        This method configures the Chaise web interface for the catalog. Chaise is Deriva&#39;s</span>
<span class="sd">        web-based data browser that provides a user-friendly interface for exploring and</span>
<span class="sd">        managing catalog data. This method sets up annotations that control how Chaise</span>
<span class="sd">        displays and organizes the catalog.</span>

<span class="sd">        **Navigation Bar Structure**:</span>
<span class="sd">        The method creates a navigation bar with the following menus:</span>
<span class="sd">        - **User Info**: Links to Users, Groups, and RID Lease tables</span>
<span class="sd">        - **Deriva-ML**: Core ML tables (Workflow, Execution, Dataset, Dataset_Version, etc.)</span>
<span class="sd">        - **WWW**: Web content tables (Page, File)</span>
<span class="sd">        - **{Domain Schema}**: All domain-specific tables (excludes vocabularies and associations)</span>
<span class="sd">        - **Vocabulary**: All controlled vocabulary tables from both ML and domain schemas</span>
<span class="sd">        - **Assets**: All asset tables from both ML and domain schemas</span>
<span class="sd">        - **Features**: All feature tables with entries named &quot;TableName:FeatureName&quot;</span>
<span class="sd">        - **Catalog Registry**: Link to the ermrest registry</span>
<span class="sd">        - **Documentation**: Links to ML notebook instructions and Deriva-ML docs</span>

<span class="sd">        **Display Settings**:</span>
<span class="sd">        - Underscores in table/column names displayed as spaces</span>
<span class="sd">        - System columns (RID) shown in compact and entry views</span>
<span class="sd">        - Default table set to Dataset</span>
<span class="sd">        - Faceting and record deletion enabled</span>
<span class="sd">        - Export configurations available to all users</span>

<span class="sd">        **Bulk Upload Configuration**:</span>
<span class="sd">        Configures upload patterns for asset tables, enabling drag-and-drop file uploads</span>
<span class="sd">        through the Chaise interface.</span>

<span class="sd">        Call this after creating the domain schema and all tables to initialize the catalog&#39;s</span>
<span class="sd">        web interface. The navigation menus are dynamically built based on the current schema</span>
<span class="sd">        structure, automatically organizing tables into appropriate categories.</span>

<span class="sd">        Args:</span>
<span class="sd">            navbar_brand_text: Text displayed in the navigation bar brand area.</span>
<span class="sd">            head_title: Title displayed in the browser tab.</span>

<span class="sd">        Example:</span>
<span class="sd">            &gt;&gt;&gt; ml = DerivaML(&#39;deriva.example.org&#39;, &#39;my_catalog&#39;)</span>
<span class="sd">            &gt;&gt;&gt; # After creating domain schema and tables...</span>
<span class="sd">            &gt;&gt;&gt; ml.apply_catalog_annotations()</span>
<span class="sd">            &gt;&gt;&gt; # Or with custom branding:</span>
<span class="sd">            &gt;&gt;&gt; ml.apply_catalog_annotations(&quot;My Project Browser&quot;, &quot;My ML Project&quot;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">catalog_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">catalog</span><span class="o">.</span><span class="n">catalog_id</span>
        <span class="n">ml_schema</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ml_schema</span>

        <span class="c1"># Build domain schema menu items (one menu per domain schema)</span>
        <span class="n">domain_schema_menus</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">domain_schema</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">domain_schemas</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">domain_schema</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">schemas</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="n">domain_schema_menus</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
                <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">domain_schema</span><span class="p">,</span>
                <span class="s2">&quot;children&quot;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="p">{</span>
                        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">tname</span><span class="p">,</span>
                        <span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;/chaise/recordset/#</span><span class="si">{</span><span class="n">catalog_id</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">domain_schema</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">tname</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                    <span class="p">}</span>
                    <span class="k">for</span> <span class="n">tname</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">schemas</span><span class="p">[</span><span class="n">domain_schema</span><span class="p">]</span><span class="o">.</span><span class="n">tables</span>
                    <span class="c1"># Don&#39;t include controlled vocabularies, association tables, or feature tables.</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">is_vocabulary</span><span class="p">(</span><span class="n">tname</span><span class="p">)</span>
                        <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">is_association</span><span class="p">(</span><span class="n">tname</span><span class="p">,</span> <span class="n">pure</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">max_arity</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
                    <span class="p">)</span>
                <span class="p">],</span>
            <span class="p">})</span>

        <span class="c1"># Build vocabulary menu items (ML schema + all domain schemas)</span>
        <span class="n">vocab_children</span> <span class="o">=</span> <span class="p">[{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ml_schema</span><span class="si">}</span><span class="s2"> Vocabularies&quot;</span><span class="p">,</span> <span class="s2">&quot;header&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">}]</span>
        <span class="n">vocab_children</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span>
            <span class="p">{</span>
                <span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;/chaise/recordset/#</span><span class="si">{</span><span class="n">catalog_id</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">ml_schema</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">tname</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">tname</span><span class="p">,</span>
            <span class="p">}</span>
            <span class="k">for</span> <span class="n">tname</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">schemas</span><span class="p">[</span><span class="n">ml_schema</span><span class="p">]</span><span class="o">.</span><span class="n">tables</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">is_vocabulary</span><span class="p">(</span><span class="n">tname</span><span class="p">)</span>
        <span class="p">])</span>
        <span class="k">for</span> <span class="n">domain_schema</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">domain_schemas</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">domain_schema</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">schemas</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="n">vocab_children</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">domain_schema</span><span class="si">}</span><span class="s2"> Vocabularies&quot;</span><span class="p">,</span> <span class="s2">&quot;header&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
            <span class="n">vocab_children</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span>
                <span class="p">{</span>
                    <span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;/chaise/recordset/#</span><span class="si">{</span><span class="n">catalog_id</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">domain_schema</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">tname</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">tname</span><span class="p">,</span>
                <span class="p">}</span>
                <span class="k">for</span> <span class="n">tname</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">schemas</span><span class="p">[</span><span class="n">domain_schema</span><span class="p">]</span><span class="o">.</span><span class="n">tables</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">is_vocabulary</span><span class="p">(</span><span class="n">tname</span><span class="p">)</span>
            <span class="p">])</span>

        <span class="c1"># Build asset menu items (ML schema + all domain schemas)</span>
        <span class="n">asset_children</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;/chaise/recordset/#</span><span class="si">{</span><span class="n">catalog_id</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">ml_schema</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">tname</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">tname</span><span class="p">,</span>
            <span class="p">}</span>
            <span class="k">for</span> <span class="n">tname</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">schemas</span><span class="p">[</span><span class="n">ml_schema</span><span class="p">]</span><span class="o">.</span><span class="n">tables</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">is_asset</span><span class="p">(</span><span class="n">tname</span><span class="p">)</span>
        <span class="p">]</span>
        <span class="k">for</span> <span class="n">domain_schema</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">domain_schemas</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">domain_schema</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">schemas</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="n">asset_children</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span>
                <span class="p">{</span>
                    <span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;/chaise/recordset/#</span><span class="si">{</span><span class="n">catalog_id</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">domain_schema</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">tname</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">tname</span><span class="p">,</span>
                <span class="p">}</span>
                <span class="k">for</span> <span class="n">tname</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">schemas</span><span class="p">[</span><span class="n">domain_schema</span><span class="p">]</span><span class="o">.</span><span class="n">tables</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">is_asset</span><span class="p">(</span><span class="n">tname</span><span class="p">)</span>
            <span class="p">])</span>

        <span class="n">catalog_annotation</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">deriva_tags</span><span class="o">.</span><span class="n">display</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;name_style&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;underline_space&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">}},</span>
            <span class="n">deriva_tags</span><span class="o">.</span><span class="n">chaise_config</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;headTitle&quot;</span><span class="p">:</span> <span class="n">head_title</span><span class="p">,</span>
                <span class="s2">&quot;navbarBrandText&quot;</span><span class="p">:</span> <span class="n">navbar_brand_text</span><span class="p">,</span>
                <span class="s2">&quot;systemColumnsDisplayEntry&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;RID&quot;</span><span class="p">],</span>
                <span class="s2">&quot;systemColumnsDisplayCompact&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;RID&quot;</span><span class="p">],</span>
                <span class="s2">&quot;defaultTable&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;table&quot;</span><span class="p">:</span> <span class="s2">&quot;Dataset&quot;</span><span class="p">,</span> <span class="s2">&quot;schema&quot;</span><span class="p">:</span> <span class="s2">&quot;deriva-ml&quot;</span><span class="p">},</span>
                <span class="s2">&quot;deleteRecord&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                <span class="s2">&quot;showFaceting&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                <span class="s2">&quot;shareCiteAcls&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                <span class="s2">&quot;exportConfigsSubmenu&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;acls&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;show&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;*&quot;</span><span class="p">],</span> <span class="s2">&quot;enable&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;*&quot;</span><span class="p">]}},</span>
                <span class="s2">&quot;resolverImplicitCatalog&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
                <span class="s2">&quot;navbarMenu&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;newTab&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
                    <span class="s2">&quot;children&quot;</span><span class="p">:</span> <span class="p">[</span>
                        <span class="p">{</span>
                            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;User Info&quot;</span><span class="p">,</span>
                            <span class="s2">&quot;children&quot;</span><span class="p">:</span> <span class="p">[</span>
                                <span class="p">{</span>
                                    <span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;/chaise/recordset/#</span><span class="si">{</span><span class="n">catalog_id</span><span class="si">}</span><span class="s2">/public:ERMrest_Client&quot;</span><span class="p">,</span>
                                    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Users&quot;</span><span class="p">,</span>
                                <span class="p">},</span>
                                <span class="p">{</span>
                                    <span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;/chaise/recordset/#</span><span class="si">{</span><span class="n">catalog_id</span><span class="si">}</span><span class="s2">/public:ERMrest_Group&quot;</span><span class="p">,</span>
                                    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Groups&quot;</span><span class="p">,</span>
                                <span class="p">},</span>
                                <span class="p">{</span>
                                    <span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;/chaise/recordset/#</span><span class="si">{</span><span class="n">catalog_id</span><span class="si">}</span><span class="s2">/public:ERMrest_RID_Lease&quot;</span><span class="p">,</span>
                                    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;ERMrest RID Lease&quot;</span><span class="p">,</span>
                                <span class="p">},</span>
                            <span class="p">],</span>
                        <span class="p">},</span>
                        <span class="p">{</span>  <span class="c1"># All the primary tables in deriva-ml schema.</span>
                            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Deriva-ML&quot;</span><span class="p">,</span>
                            <span class="s2">&quot;children&quot;</span><span class="p">:</span> <span class="p">[</span>
                                <span class="p">{</span>
                                    <span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;/chaise/recordset/#</span><span class="si">{</span><span class="n">catalog_id</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">ml_schema</span><span class="si">}</span><span class="s2">:Workflow&quot;</span><span class="p">,</span>
                                    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Workflow&quot;</span><span class="p">,</span>
                                <span class="p">},</span>
                                <span class="p">{</span>
                                    <span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;/chaise/recordset/#</span><span class="si">{</span><span class="n">catalog_id</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">ml_schema</span><span class="si">}</span><span class="s2">:Execution&quot;</span><span class="p">,</span>
                                    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Execution&quot;</span><span class="p">,</span>
                                <span class="p">},</span>
                                <span class="p">{</span>
                                    <span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;/chaise/recordset/#</span><span class="si">{</span><span class="n">catalog_id</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">ml_schema</span><span class="si">}</span><span class="s2">:Execution_Metadata&quot;</span><span class="p">,</span>
                                    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Execution Metadata&quot;</span><span class="p">,</span>
                                <span class="p">},</span>
                                <span class="p">{</span>
                                    <span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;/chaise/recordset/#</span><span class="si">{</span><span class="n">catalog_id</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">ml_schema</span><span class="si">}</span><span class="s2">:Execution_Asset&quot;</span><span class="p">,</span>
                                    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Execution Asset&quot;</span><span class="p">,</span>
                                <span class="p">},</span>
                                <span class="p">{</span>
                                    <span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;/chaise/recordset/#</span><span class="si">{</span><span class="n">catalog_id</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">ml_schema</span><span class="si">}</span><span class="s2">:Dataset&quot;</span><span class="p">,</span>
                                    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Dataset&quot;</span><span class="p">,</span>
                                <span class="p">},</span>
                                <span class="p">{</span>
                                    <span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;/chaise/recordset/#</span><span class="si">{</span><span class="n">catalog_id</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">ml_schema</span><span class="si">}</span><span class="s2">:Dataset_Version&quot;</span><span class="p">,</span>
                                    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Dataset Version&quot;</span><span class="p">,</span>
                                <span class="p">},</span>
                            <span class="p">],</span>
                        <span class="p">},</span>
                        <span class="p">{</span>  <span class="c1"># WWW schema tables.</span>
                            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;WWW&quot;</span><span class="p">,</span>
                            <span class="s2">&quot;children&quot;</span><span class="p">:</span> <span class="p">[</span>
                                <span class="p">{</span>
                                    <span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;/chaise/recordset/#</span><span class="si">{</span><span class="n">catalog_id</span><span class="si">}</span><span class="s2">/WWW:Page&quot;</span><span class="p">,</span>
                                    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Page&quot;</span><span class="p">,</span>
                                <span class="p">},</span>
                                <span class="p">{</span>
                                    <span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;/chaise/recordset/#</span><span class="si">{</span><span class="n">catalog_id</span><span class="si">}</span><span class="s2">/WWW:File&quot;</span><span class="p">,</span>
                                    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;File&quot;</span><span class="p">,</span>
                                <span class="p">},</span>
                            <span class="p">],</span>
                        <span class="p">},</span>
                        <span class="o">*</span><span class="n">domain_schema_menus</span><span class="p">,</span>  <span class="c1"># One menu per domain schema</span>
                        <span class="p">{</span>  <span class="c1"># Vocabulary menu with all controlled vocabularies.</span>
                            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Vocabulary&quot;</span><span class="p">,</span>
                            <span class="s2">&quot;children&quot;</span><span class="p">:</span> <span class="n">vocab_children</span><span class="p">,</span>
                        <span class="p">},</span>
                        <span class="p">{</span>  <span class="c1"># List of all asset tables.</span>
                            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Assets&quot;</span><span class="p">,</span>
                            <span class="s2">&quot;children&quot;</span><span class="p">:</span> <span class="n">asset_children</span><span class="p">,</span>
                        <span class="p">},</span>
                        <span class="p">{</span>  <span class="c1"># List of all feature tables in the catalog.</span>
                            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Features&quot;</span><span class="p">,</span>
                            <span class="s2">&quot;children&quot;</span><span class="p">:</span> <span class="p">[</span>
                                <span class="p">{</span>
                                    <span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;/chaise/recordset/#</span><span class="si">{</span><span class="n">catalog_id</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">f</span><span class="o">.</span><span class="n">feature_table</span><span class="o">.</span><span class="n">schema</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">f</span><span class="o">.</span><span class="n">feature_table</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                                    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">f</span><span class="o">.</span><span class="n">target_table</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">f</span><span class="o">.</span><span class="n">feature_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                                <span class="p">}</span>
                                <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">find_features</span><span class="p">()</span>
                            <span class="p">],</span>
                        <span class="p">},</span>
                        <span class="p">{</span>
                            <span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="s2">&quot;/chaise/recordset/#0/ermrest:registry@sort(RID)&quot;</span><span class="p">,</span>
                            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Catalog Registry&quot;</span><span class="p">,</span>
                        <span class="p">},</span>
                        <span class="p">{</span>
                            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Documentation&quot;</span><span class="p">,</span>
                            <span class="s2">&quot;children&quot;</span><span class="p">:</span> <span class="p">[</span>
                                <span class="p">{</span>
                                    <span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="s2">&quot;https://github.com/informatics-isi-edu/deriva-ml/blob/main/docs/ml_workflow_instruction.md&quot;</span><span class="p">,</span>
                                    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;ML Notebook Instruction&quot;</span><span class="p">,</span>
                                <span class="p">},</span>
                                <span class="p">{</span>
                                    <span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="s2">&quot;https://informatics-isi-edu.github.io/deriva-ml/&quot;</span><span class="p">,</span>
                                    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Deriva-ML Documentation&quot;</span><span class="p">,</span>
                                <span class="p">},</span>
                            <span class="p">],</span>
                        <span class="p">},</span>
                    <span class="p">],</span>
                <span class="p">},</span>
            <span class="p">},</span>
            <span class="n">deriva_tags</span><span class="o">.</span><span class="n">bulk_upload</span><span class="p">:</span> <span class="n">bulk_upload_configuration</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">),</span>
        <span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">annotations</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">catalog_annotation</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">apply</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">add_page</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">title</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">content</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Adds page to web interface.</span>

<span class="sd">        Creates a new page in the catalog&#39;s web interface with the specified title and content. The page will be</span>
<span class="sd">        accessible through the catalog&#39;s navigation system.</span>

<span class="sd">        Args:</span>
<span class="sd">            title: The title of the page to be displayed in navigation and headers.</span>
<span class="sd">            content: The main content of the page can include HTML markup.</span>

<span class="sd">        Raises:</span>
<span class="sd">            DerivaMLException: If the page creation fails or the user lacks necessary permissions.</span>

<span class="sd">        Example:</span>
<span class="sd">            &gt;&gt;&gt; ml.add_page(</span>
<span class="sd">            ...     title=&quot;Analysis Results&quot;,</span>
<span class="sd">            ...     content=&quot;&lt;h1&gt;Results&lt;/h1&gt;&lt;p&gt;Analysis completed successfully...&lt;/p&gt;&quot;</span>
<span class="sd">            ... )</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Insert page into www tables with title and content</span>
        <span class="c1"># Use default schema or first domain schema for www tables</span>
        <span class="n">schema</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_schema</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">domain_schemas</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">domain_schemas</span> <span class="k">else</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">schema</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DerivaMLException</span><span class="p">(</span><span class="s2">&quot;No domain schema available for adding pages&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pathBuilder</span><span class="p">()</span><span class="o">.</span><span class="n">www</span><span class="o">.</span><span class="n">tables</span><span class="p">[</span><span class="n">schema</span><span class="p">]</span><span class="o">.</span><span class="n">insert</span><span class="p">([{</span><span class="s2">&quot;Title&quot;</span><span class="p">:</span> <span class="n">title</span><span class="p">,</span> <span class="s2">&quot;Content&quot;</span><span class="p">:</span> <span class="n">content</span><span class="p">}])</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">create_vocabulary</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">vocab_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">comment</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">schema</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">update_navbar</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Table</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Creates a controlled vocabulary table.</span>

<span class="sd">        A controlled vocabulary table maintains a list of standardized terms and their definitions. Each term can have</span>
<span class="sd">        synonyms and descriptions to ensure consistent terminology usage across the dataset.</span>

<span class="sd">        Args:</span>
<span class="sd">            vocab_name: Name for the new vocabulary table. Must be a valid SQL identifier.</span>
<span class="sd">            comment: Description of the vocabulary&#39;s purpose and usage. Defaults to empty string.</span>
<span class="sd">            schema: Schema name to create the table in. If None, uses domain_schema.</span>
<span class="sd">            update_navbar: If True (default), automatically updates the navigation bar to include</span>
<span class="sd">                the new vocabulary table. Set to False during batch table creation to avoid</span>
<span class="sd">                redundant updates, then call apply_catalog_annotations() once at the end.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Table: ERMRest table object representing the newly created vocabulary table.</span>

<span class="sd">        Raises:</span>
<span class="sd">            DerivaMLException: If vocab_name is invalid or already exists.</span>

<span class="sd">        Examples:</span>
<span class="sd">            Create a vocabulary for tissue types:</span>

<span class="sd">                &gt;&gt;&gt; table = ml.create_vocabulary(</span>
<span class="sd">                ...     vocab_name=&quot;tissue_types&quot;,</span>
<span class="sd">                ...     comment=&quot;Standard tissue classifications&quot;,</span>
<span class="sd">                ...     schema=&quot;bio_schema&quot;</span>
<span class="sd">                ... )</span>

<span class="sd">            Create multiple vocabularies without updating navbar until the end:</span>

<span class="sd">                &gt;&gt;&gt; ml.create_vocabulary(&quot;Species&quot;, update_navbar=False)</span>
<span class="sd">                &gt;&gt;&gt; ml.create_vocabulary(&quot;Tissue_Type&quot;, update_navbar=False)</span>
<span class="sd">                &gt;&gt;&gt; ml.apply_catalog_annotations()  # Update navbar once</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Use default schema if none specified</span>
        <span class="n">schema</span> <span class="o">=</span> <span class="n">schema</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">_require_default_schema</span><span class="p">()</span>

        <span class="c1"># Create and return vocabulary table with RID-based URI pattern</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">vocab_table</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">schemas</span><span class="p">[</span><span class="n">schema</span><span class="p">]</span><span class="o">.</span><span class="n">create_table</span><span class="p">(</span>
                <span class="n">VocabularyTableDef</span><span class="p">(</span>
                    <span class="n">name</span><span class="o">=</span><span class="n">vocab_name</span><span class="p">,</span>
                    <span class="n">curie_template</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">project_name</span><span class="si">}</span><span class="s2">:</span><span class="se">{{</span><span class="s2">RID</span><span class="se">}}</span><span class="s2">&quot;</span><span class="p">,</span>
                    <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="p">)</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DerivaMLException</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Table </span><span class="si">{</span><span class="n">vocab_name</span><span class="si">}</span><span class="s2"> already exist&quot;</span><span class="p">)</span>

        <span class="c1"># Update navbar to include the new vocabulary table</span>
        <span class="k">if</span> <span class="n">update_navbar</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">apply_catalog_annotations</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">vocab_table</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">create_table</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">:</span> <span class="n">TableDefinition</span><span class="p">,</span> <span class="n">schema</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">update_navbar</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Table</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Creates a new table in the domain schema.</span>

<span class="sd">        Creates a table using the provided TableDefinition object, which specifies the table structure</span>
<span class="sd">        including columns, keys, and foreign key relationships. The table is created in the domain</span>
<span class="sd">        schema associated with this DerivaML instance.</span>

<span class="sd">        **Required Classes**:</span>
<span class="sd">        Import the following classes from deriva_ml to define tables:</span>

<span class="sd">        - ``TableDefinition``: Defines the complete table structure</span>
<span class="sd">        - ``ColumnDefinition``: Defines individual columns with types and constraints</span>
<span class="sd">        - ``KeyDefinition``: Defines unique key constraints (optional)</span>
<span class="sd">        - ``ForeignKeyDefinition``: Defines foreign key relationships to other tables (optional)</span>
<span class="sd">        - ``BuiltinTypes``: Enum of available column data types</span>

<span class="sd">        **Available Column Types** (BuiltinTypes enum):</span>
<span class="sd">        ``text``, ``int2``, ``int4``, ``int8``, ``float4``, ``float8``, ``boolean``,</span>
<span class="sd">        ``date``, ``timestamp``, ``timestamptz``, ``json``, ``jsonb``, ``markdown``,</span>
<span class="sd">        ``ermrest_uri``, ``ermrest_rid``, ``ermrest_rcb``, ``ermrest_rmb``,</span>
<span class="sd">        ``ermrest_rct``, ``ermrest_rmt``</span>

<span class="sd">        Args:</span>
<span class="sd">            table: A TableDefinition object containing the complete specification of the table to create.</span>
<span class="sd">            update_navbar: If True (default), automatically updates the navigation bar to include</span>
<span class="sd">                the new table. Set to False during batch table creation to avoid redundant updates,</span>
<span class="sd">                then call apply_catalog_annotations() once at the end.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Table: The newly created ERMRest table object.</span>

<span class="sd">        Raises:</span>
<span class="sd">            DerivaMLException: If table creation fails or the definition is invalid.</span>

<span class="sd">        Examples:</span>
<span class="sd">            **Simple table with basic columns**:</span>

<span class="sd">                &gt;&gt;&gt; from deriva_ml import TableDefinition, ColumnDefinition, BuiltinTypes</span>
<span class="sd">                &gt;&gt;&gt;</span>
<span class="sd">                &gt;&gt;&gt; table_def = TableDefinition(</span>
<span class="sd">                ...     name=&quot;Experiment&quot;,</span>
<span class="sd">                ...     column_defs=[</span>
<span class="sd">                ...         ColumnDefinition(name=&quot;Name&quot;, type=BuiltinTypes.text, nullok=False),</span>
<span class="sd">                ...         ColumnDefinition(name=&quot;Date&quot;, type=BuiltinTypes.date),</span>
<span class="sd">                ...         ColumnDefinition(name=&quot;Description&quot;, type=BuiltinTypes.markdown),</span>
<span class="sd">                ...         ColumnDefinition(name=&quot;Score&quot;, type=BuiltinTypes.float4),</span>
<span class="sd">                ...     ],</span>
<span class="sd">                ...     comment=&quot;Records of experimental runs&quot;</span>
<span class="sd">                ... )</span>
<span class="sd">                &gt;&gt;&gt; experiment_table = ml.create_table(table_def)</span>

<span class="sd">            **Table with foreign key to another table**:</span>

<span class="sd">                &gt;&gt;&gt; from deriva_ml import (</span>
<span class="sd">                ...     TableDefinition, ColumnDefinition, ForeignKeyDefinition, BuiltinTypes</span>
<span class="sd">                ... )</span>
<span class="sd">                &gt;&gt;&gt;</span>
<span class="sd">                &gt;&gt;&gt; # Create a Sample table that references Subject</span>
<span class="sd">                &gt;&gt;&gt; sample_def = TableDefinition(</span>
<span class="sd">                ...     name=&quot;Sample&quot;,</span>
<span class="sd">                ...     column_defs=[</span>
<span class="sd">                ...         ColumnDefinition(name=&quot;Name&quot;, type=BuiltinTypes.text, nullok=False),</span>
<span class="sd">                ...         ColumnDefinition(name=&quot;Subject&quot;, type=BuiltinTypes.text, nullok=False),</span>
<span class="sd">                ...         ColumnDefinition(name=&quot;Collection_Date&quot;, type=BuiltinTypes.date),</span>
<span class="sd">                ...     ],</span>
<span class="sd">                ...     fkey_defs=[</span>
<span class="sd">                ...         ForeignKeyDefinition(</span>
<span class="sd">                ...             colnames=[&quot;Subject&quot;],</span>
<span class="sd">                ...             pk_sname=ml.default_schema,  # Schema of referenced table</span>
<span class="sd">                ...             pk_tname=&quot;Subject&quot;,          # Name of referenced table</span>
<span class="sd">                ...             pk_colnames=[&quot;RID&quot;],         # Column(s) in referenced table</span>
<span class="sd">                ...             on_delete=&quot;CASCADE&quot;,         # Delete samples when subject deleted</span>
<span class="sd">                ...         )</span>
<span class="sd">                ...     ],</span>
<span class="sd">                ...     comment=&quot;Biological samples collected from subjects&quot;</span>
<span class="sd">                ... )</span>
<span class="sd">                &gt;&gt;&gt; sample_table = ml.create_table(sample_def)</span>

<span class="sd">            **Table with unique key constraint**:</span>

<span class="sd">                &gt;&gt;&gt; from deriva_ml import (</span>
<span class="sd">                ...     TableDefinition, ColumnDefinition, KeyDefinition, BuiltinTypes</span>
<span class="sd">                ... )</span>
<span class="sd">                &gt;&gt;&gt;</span>
<span class="sd">                &gt;&gt;&gt; protocol_def = TableDefinition(</span>
<span class="sd">                ...     name=&quot;Protocol&quot;,</span>
<span class="sd">                ...     column_defs=[</span>
<span class="sd">                ...         ColumnDefinition(name=&quot;Name&quot;, type=BuiltinTypes.text, nullok=False),</span>
<span class="sd">                ...         ColumnDefinition(name=&quot;Version&quot;, type=BuiltinTypes.text, nullok=False),</span>
<span class="sd">                ...         ColumnDefinition(name=&quot;Description&quot;, type=BuiltinTypes.markdown),</span>
<span class="sd">                ...     ],</span>
<span class="sd">                ...     key_defs=[</span>
<span class="sd">                ...         KeyDefinition(</span>
<span class="sd">                ...             colnames=[&quot;Name&quot;, &quot;Version&quot;],</span>
<span class="sd">                ...             constraint_names=[[&quot;myschema&quot;, &quot;Protocol_Name_Version_key&quot;]],</span>
<span class="sd">                ...             comment=&quot;Each protocol name+version must be unique&quot;</span>
<span class="sd">                ...         )</span>
<span class="sd">                ...     ],</span>
<span class="sd">                ...     comment=&quot;Experimental protocols with versioning&quot;</span>
<span class="sd">                ... )</span>
<span class="sd">                &gt;&gt;&gt; protocol_table = ml.create_table(protocol_def)</span>

<span class="sd">            **Batch creation without navbar updates**:</span>

<span class="sd">                &gt;&gt;&gt; ml.create_table(table1_def, update_navbar=False)</span>
<span class="sd">                &gt;&gt;&gt; ml.create_table(table2_def, update_navbar=False)</span>
<span class="sd">                &gt;&gt;&gt; ml.create_table(table3_def, update_navbar=False)</span>
<span class="sd">                &gt;&gt;&gt; ml.apply_catalog_annotations()  # Update navbar once at the end</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Use default schema if none specified</span>
        <span class="n">schema</span> <span class="o">=</span> <span class="n">schema</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">_require_default_schema</span><span class="p">()</span>

        <span class="c1"># Create table in domain schema using provided definition</span>
        <span class="c1"># Handle both TableDefinition (dataclass with to_dict) and plain dicts</span>
        <span class="n">table_dict</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span> <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="s1">&#39;to_dict&#39;</span><span class="p">)</span> <span class="k">else</span> <span class="n">table</span>
        <span class="n">new_table</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">schemas</span><span class="p">[</span><span class="n">schema</span><span class="p">]</span><span class="o">.</span><span class="n">create_table</span><span class="p">(</span><span class="n">table_dict</span><span class="p">)</span>

        <span class="c1"># Update navbar to include the new table</span>
        <span class="k">if</span> <span class="n">update_navbar</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">apply_catalog_annotations</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">new_table</span>

    <span class="c1"># =========================================================================</span>
    <span class="c1"># Cache and Directory Management</span>
    <span class="c1"># =========================================================================</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">clear_cache</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">older_than_days</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Clear the dataset cache directory.</span>

<span class="sd">        Removes cached dataset bags from the cache directory. Can optionally filter</span>
<span class="sd">        by age to only remove old cache entries.</span>

<span class="sd">        Args:</span>
<span class="sd">            older_than_days: If provided, only remove cache entries older than this</span>
<span class="sd">                many days. If None, removes all cache entries.</span>

<span class="sd">        Returns:</span>
<span class="sd">            dict with keys:</span>
<span class="sd">                - &#39;files_removed&#39;: Number of files removed</span>
<span class="sd">                - &#39;dirs_removed&#39;: Number of directories removed</span>
<span class="sd">                - &#39;bytes_freed&#39;: Total bytes freed</span>
<span class="sd">                - &#39;errors&#39;: Number of removal errors</span>

<span class="sd">        Example:</span>
<span class="sd">            &gt;&gt;&gt; ml = DerivaML(&#39;deriva.example.org&#39;, &#39;my_catalog&#39;)</span>
<span class="sd">            &gt;&gt;&gt; # Clear all cache</span>
<span class="sd">            &gt;&gt;&gt; result = ml.clear_cache()</span>
<span class="sd">            &gt;&gt;&gt; print(f&quot;Freed {result[&#39;bytes_freed&#39;] / 1e6:.1f} MB&quot;)</span>
<span class="sd">            &gt;&gt;&gt;</span>
<span class="sd">            &gt;&gt;&gt; # Clear cache older than 7 days</span>
<span class="sd">            &gt;&gt;&gt; result = ml.clear_cache(older_than_days=7)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span><span class="w"> </span><span class="nn">shutil</span>
        <span class="kn">import</span><span class="w"> </span><span class="nn">time</span>

        <span class="n">stats</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;files_removed&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;dirs_removed&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;bytes_freed&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;errors&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">}</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">cache_dir</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
            <span class="k">return</span> <span class="n">stats</span>

        <span class="n">cutoff_time</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">older_than_days</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">cutoff_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="p">(</span><span class="n">older_than_days</span> <span class="o">*</span> <span class="mi">24</span> <span class="o">*</span> <span class="mi">60</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cache_dir</span><span class="o">.</span><span class="n">iterdir</span><span class="p">():</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="c1"># Check age if filtering</span>
                    <span class="k">if</span> <span class="n">cutoff_time</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">entry_mtime</span> <span class="o">=</span> <span class="n">entry</span><span class="o">.</span><span class="n">stat</span><span class="p">()</span><span class="o">.</span><span class="n">st_mtime</span>
                        <span class="k">if</span> <span class="n">entry_mtime</span> <span class="o">&gt;</span> <span class="n">cutoff_time</span><span class="p">:</span>
                            <span class="k">continue</span>  <span class="c1"># Skip recent entries</span>

                    <span class="c1"># Calculate size before removal</span>
                    <span class="k">if</span> <span class="n">entry</span><span class="o">.</span><span class="n">is_dir</span><span class="p">():</span>
                        <span class="n">entry_size</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">stat</span><span class="p">()</span><span class="o">.</span><span class="n">st_size</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">entry</span><span class="o">.</span><span class="n">rglob</span><span class="p">(</span><span class="s1">&#39;*&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">is_file</span><span class="p">())</span>
                        <span class="n">shutil</span><span class="o">.</span><span class="n">rmtree</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>
                        <span class="n">stats</span><span class="p">[</span><span class="s1">&#39;dirs_removed&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">entry_size</span> <span class="o">=</span> <span class="n">entry</span><span class="o">.</span><span class="n">stat</span><span class="p">()</span><span class="o">.</span><span class="n">st_size</span>
                        <span class="n">entry</span><span class="o">.</span><span class="n">unlink</span><span class="p">()</span>
                        <span class="n">stats</span><span class="p">[</span><span class="s1">&#39;files_removed&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>

                    <span class="n">stats</span><span class="p">[</span><span class="s1">&#39;bytes_freed&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">entry_size</span>
                <span class="k">except</span> <span class="p">(</span><span class="ne">OSError</span><span class="p">,</span> <span class="ne">PermissionError</span><span class="p">)</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed to remove cache entry </span><span class="si">{</span><span class="n">entry</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="n">stats</span><span class="p">[</span><span class="s1">&#39;errors&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="k">except</span> <span class="ne">OSError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed to iterate cache directory: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">stats</span><span class="p">[</span><span class="s1">&#39;errors&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="k">return</span> <span class="n">stats</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_cache_size</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">float</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the current size of the cache directory.</span>

<span class="sd">        Returns:</span>
<span class="sd">            dict with keys:</span>
<span class="sd">                - &#39;total_bytes&#39;: Total size in bytes</span>
<span class="sd">                - &#39;total_mb&#39;: Total size in megabytes</span>
<span class="sd">                - &#39;file_count&#39;: Number of files</span>
<span class="sd">                - &#39;dir_count&#39;: Number of directories</span>

<span class="sd">        Example:</span>
<span class="sd">            &gt;&gt;&gt; ml = DerivaML(&#39;deriva.example.org&#39;, &#39;my_catalog&#39;)</span>
<span class="sd">            &gt;&gt;&gt; size = ml.get_cache_size()</span>
<span class="sd">            &gt;&gt;&gt; print(f&quot;Cache size: {size[&#39;total_mb&#39;]:.1f} MB ({size[&#39;file_count&#39;]} files)&quot;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">stats</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;total_bytes&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;total_mb&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;file_count&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;dir_count&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">}</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">cache_dir</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
            <span class="k">return</span> <span class="n">stats</span>

        <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cache_dir</span><span class="o">.</span><span class="n">rglob</span><span class="p">(</span><span class="s1">&#39;*&#39;</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">entry</span><span class="o">.</span><span class="n">is_file</span><span class="p">():</span>
                <span class="n">stats</span><span class="p">[</span><span class="s1">&#39;total_bytes&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">entry</span><span class="o">.</span><span class="n">stat</span><span class="p">()</span><span class="o">.</span><span class="n">st_size</span>
                <span class="n">stats</span><span class="p">[</span><span class="s1">&#39;file_count&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">elif</span> <span class="n">entry</span><span class="o">.</span><span class="n">is_dir</span><span class="p">():</span>
                <span class="n">stats</span><span class="p">[</span><span class="s1">&#39;dir_count&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="n">stats</span><span class="p">[</span><span class="s1">&#39;total_mb&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">stats</span><span class="p">[</span><span class="s1">&#39;total_bytes&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1024</span> <span class="o">*</span> <span class="mi">1024</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">stats</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">list_execution_dirs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">any</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;List execution working directories.</span>

<span class="sd">        Returns information about each execution directory in the working directory,</span>
<span class="sd">        useful for identifying orphaned or incomplete execution outputs.</span>

<span class="sd">        Returns:</span>
<span class="sd">            List of dicts, each containing:</span>
<span class="sd">                - &#39;execution_rid&#39;: The execution RID (directory name)</span>
<span class="sd">                - &#39;path&#39;: Full path to the directory</span>
<span class="sd">                - &#39;size_bytes&#39;: Total size in bytes</span>
<span class="sd">                - &#39;size_mb&#39;: Total size in megabytes</span>
<span class="sd">                - &#39;modified&#39;: Last modification time (datetime)</span>
<span class="sd">                - &#39;file_count&#39;: Number of files</span>

<span class="sd">        Example:</span>
<span class="sd">            &gt;&gt;&gt; ml = DerivaML(&#39;deriva.example.org&#39;, &#39;my_catalog&#39;)</span>
<span class="sd">            &gt;&gt;&gt; dirs = ml.list_execution_dirs()</span>
<span class="sd">            &gt;&gt;&gt; for d in dirs:</span>
<span class="sd">            ...     print(f&quot;{d[&#39;execution_rid&#39;]}: {d[&#39;size_mb&#39;]:.1f} MB&quot;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span>

        <span class="kn">from</span><span class="w"> </span><span class="nn">deriva_ml.dataset.upload</span><span class="w"> </span><span class="kn">import</span> <span class="n">upload_root</span>

        <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">exec_root</span> <span class="o">=</span> <span class="n">upload_root</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">working_dir</span><span class="p">)</span> <span class="o">/</span> <span class="s2">&quot;execution&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">exec_root</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
            <span class="k">return</span> <span class="n">results</span>

        <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">exec_root</span><span class="o">.</span><span class="n">iterdir</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">entry</span><span class="o">.</span><span class="n">is_dir</span><span class="p">():</span>
                <span class="n">size_bytes</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">stat</span><span class="p">()</span><span class="o">.</span><span class="n">st_size</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">entry</span><span class="o">.</span><span class="n">rglob</span><span class="p">(</span><span class="s1">&#39;*&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">is_file</span><span class="p">())</span>
                <span class="n">file_count</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="mi">1</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">entry</span><span class="o">.</span><span class="n">rglob</span><span class="p">(</span><span class="s1">&#39;*&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">is_file</span><span class="p">())</span>
                <span class="n">mtime</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">fromtimestamp</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">stat</span><span class="p">()</span><span class="o">.</span><span class="n">st_mtime</span><span class="p">)</span>

                <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
                    <span class="s1">&#39;execution_rid&#39;</span><span class="p">:</span> <span class="n">entry</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                    <span class="s1">&#39;path&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">entry</span><span class="p">),</span>
                    <span class="s1">&#39;size_bytes&#39;</span><span class="p">:</span> <span class="n">size_bytes</span><span class="p">,</span>
                    <span class="s1">&#39;size_mb&#39;</span><span class="p">:</span> <span class="n">size_bytes</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1024</span> <span class="o">*</span> <span class="mi">1024</span><span class="p">),</span>
                    <span class="s1">&#39;modified&#39;</span><span class="p">:</span> <span class="n">mtime</span><span class="p">,</span>
                    <span class="s1">&#39;file_count&#39;</span><span class="p">:</span> <span class="n">file_count</span><span class="p">,</span>
                <span class="p">})</span>

        <span class="k">return</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="s1">&#39;modified&#39;</span><span class="p">],</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">clean_execution_dirs</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">older_than_days</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">exclude_rids</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Clean up execution working directories.</span>

<span class="sd">        Removes execution output directories from the local working directory.</span>
<span class="sd">        Use this to free up disk space from completed or orphaned executions.</span>

<span class="sd">        Args:</span>
<span class="sd">            older_than_days: If provided, only remove directories older than this</span>
<span class="sd">                many days. If None, removes all execution directories (except excluded).</span>
<span class="sd">            exclude_rids: List of execution RIDs to preserve (never remove).</span>

<span class="sd">        Returns:</span>
<span class="sd">            dict with keys:</span>
<span class="sd">                - &#39;dirs_removed&#39;: Number of directories removed</span>
<span class="sd">                - &#39;bytes_freed&#39;: Total bytes freed</span>
<span class="sd">                - &#39;errors&#39;: Number of removal errors</span>

<span class="sd">        Example:</span>
<span class="sd">            &gt;&gt;&gt; ml = DerivaML(&#39;deriva.example.org&#39;, &#39;my_catalog&#39;)</span>
<span class="sd">            &gt;&gt;&gt; # Clean all execution dirs older than 30 days</span>
<span class="sd">            &gt;&gt;&gt; result = ml.clean_execution_dirs(older_than_days=30)</span>
<span class="sd">            &gt;&gt;&gt; print(f&quot;Freed {result[&#39;bytes_freed&#39;] / 1e9:.2f} GB&quot;)</span>
<span class="sd">            &gt;&gt;&gt;</span>
<span class="sd">            &gt;&gt;&gt; # Clean all except specific executions</span>
<span class="sd">            &gt;&gt;&gt; result = ml.clean_execution_dirs(exclude_rids=[&#39;1-ABC&#39;, &#39;1-DEF&#39;])</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span><span class="w"> </span><span class="nn">shutil</span>
        <span class="kn">import</span><span class="w"> </span><span class="nn">time</span>

        <span class="kn">from</span><span class="w"> </span><span class="nn">deriva_ml.dataset.upload</span><span class="w"> </span><span class="kn">import</span> <span class="n">upload_root</span>

        <span class="n">stats</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;dirs_removed&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;bytes_freed&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;errors&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">}</span>
        <span class="n">exclude_rids</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">exclude_rids</span> <span class="ow">or</span> <span class="p">[])</span>

        <span class="n">exec_root</span> <span class="o">=</span> <span class="n">upload_root</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">working_dir</span><span class="p">)</span> <span class="o">/</span> <span class="s2">&quot;execution&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">exec_root</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
            <span class="k">return</span> <span class="n">stats</span>

        <span class="n">cutoff_time</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">older_than_days</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">cutoff_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="p">(</span><span class="n">older_than_days</span> <span class="o">*</span> <span class="mi">24</span> <span class="o">*</span> <span class="mi">60</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">exec_root</span><span class="o">.</span><span class="n">iterdir</span><span class="p">():</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">entry</span><span class="o">.</span><span class="n">is_dir</span><span class="p">():</span>
                <span class="k">continue</span>

            <span class="c1"># Skip excluded RIDs</span>
            <span class="k">if</span> <span class="n">entry</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">exclude_rids</span><span class="p">:</span>
                <span class="k">continue</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="c1"># Check age if filtering</span>
                <span class="k">if</span> <span class="n">cutoff_time</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">entry_mtime</span> <span class="o">=</span> <span class="n">entry</span><span class="o">.</span><span class="n">stat</span><span class="p">()</span><span class="o">.</span><span class="n">st_mtime</span>
                    <span class="k">if</span> <span class="n">entry_mtime</span> <span class="o">&gt;</span> <span class="n">cutoff_time</span><span class="p">:</span>
                        <span class="k">continue</span>

                <span class="c1"># Calculate size before removal</span>
                <span class="n">entry_size</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">stat</span><span class="p">()</span><span class="o">.</span><span class="n">st_size</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">entry</span><span class="o">.</span><span class="n">rglob</span><span class="p">(</span><span class="s1">&#39;*&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">is_file</span><span class="p">())</span>
                <span class="n">shutil</span><span class="o">.</span><span class="n">rmtree</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>
                <span class="n">stats</span><span class="p">[</span><span class="s1">&#39;dirs_removed&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">stats</span><span class="p">[</span><span class="s1">&#39;bytes_freed&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">entry_size</span>

            <span class="k">except</span> <span class="p">(</span><span class="ne">OSError</span><span class="p">,</span> <span class="ne">PermissionError</span><span class="p">)</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed to remove execution dir </span><span class="si">{</span><span class="n">entry</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="n">stats</span><span class="p">[</span><span class="s1">&#39;errors&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="k">return</span> <span class="n">stats</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_storage_summary</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get a summary of local storage usage.</span>

<span class="sd">        Returns:</span>
<span class="sd">            dict with keys:</span>
<span class="sd">                - &#39;working_dir&#39;: Path to working directory</span>
<span class="sd">                - &#39;cache_dir&#39;: Path to cache directory</span>
<span class="sd">                - &#39;cache_size_mb&#39;: Cache size in MB</span>
<span class="sd">                - &#39;cache_file_count&#39;: Number of files in cache</span>
<span class="sd">                - &#39;execution_dir_count&#39;: Number of execution directories</span>
<span class="sd">                - &#39;execution_size_mb&#39;: Total size of execution directories in MB</span>
<span class="sd">                - &#39;total_size_mb&#39;: Combined size in MB</span>

<span class="sd">        Example:</span>
<span class="sd">            &gt;&gt;&gt; ml = DerivaML(&#39;deriva.example.org&#39;, &#39;my_catalog&#39;)</span>
<span class="sd">            &gt;&gt;&gt; summary = ml.get_storage_summary()</span>
<span class="sd">            &gt;&gt;&gt; print(f&quot;Total storage: {summary[&#39;total_size_mb&#39;]:.1f} MB&quot;)</span>
<span class="sd">            &gt;&gt;&gt; print(f&quot;  Cache: {summary[&#39;cache_size_mb&#39;]:.1f} MB&quot;)</span>
<span class="sd">            &gt;&gt;&gt; print(f&quot;  Executions: {summary[&#39;execution_size_mb&#39;]:.1f} MB&quot;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">cache_stats</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_cache_size</span><span class="p">()</span>
        <span class="n">exec_dirs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">list_execution_dirs</span><span class="p">()</span>

        <span class="n">exec_size_mb</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;size_mb&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">exec_dirs</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">{</span>
            <span class="s1">&#39;working_dir&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">working_dir</span><span class="p">),</span>
            <span class="s1">&#39;cache_dir&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cache_dir</span><span class="p">),</span>
            <span class="s1">&#39;cache_size_mb&#39;</span><span class="p">:</span> <span class="n">cache_stats</span><span class="p">[</span><span class="s1">&#39;total_mb&#39;</span><span class="p">],</span>
            <span class="s1">&#39;cache_file_count&#39;</span><span class="p">:</span> <span class="n">cache_stats</span><span class="p">[</span><span class="s1">&#39;file_count&#39;</span><span class="p">],</span>
            <span class="s1">&#39;execution_dir_count&#39;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">exec_dirs</span><span class="p">),</span>
            <span class="s1">&#39;execution_size_mb&#39;</span><span class="p">:</span> <span class="n">exec_size_mb</span><span class="p">,</span>
            <span class="s1">&#39;total_size_mb&#39;</span><span class="p">:</span> <span class="n">cache_stats</span><span class="p">[</span><span class="s1">&#39;total_mb&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">exec_size_mb</span><span class="p">,</span>
        <span class="p">}</span>

    <span class="c1"># =========================================================================</span>
    <span class="c1"># Schema Validation</span>
    <span class="c1"># =========================================================================</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">validate_schema</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">strict</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;SchemaValidationReport&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Validate that the catalog&#39;s ML schema matches the expected structure.</span>

<span class="sd">        This method inspects the catalog schema and verifies that it contains all</span>
<span class="sd">        the required tables, columns, vocabulary terms, and relationships that are</span>
<span class="sd">        created by the ML schema initialization routines in create_schema.py.</span>

<span class="sd">        The validation checks:</span>
<span class="sd">        - All required ML tables exist (Dataset, Execution, Workflow, etc.)</span>
<span class="sd">        - All required columns exist with correct types</span>
<span class="sd">        - All required vocabulary tables exist (Asset_Type, Dataset_Type, etc.)</span>
<span class="sd">        - All required vocabulary terms are initialized</span>
<span class="sd">        - All association tables exist for relationships</span>

<span class="sd">        In strict mode, the validator also reports errors for:</span>
<span class="sd">        - Extra tables not in the expected schema</span>
<span class="sd">        - Extra columns not in the expected table definitions</span>

<span class="sd">        Args:</span>
<span class="sd">            strict: If True, extra tables and columns are reported as errors.</span>
<span class="sd">                   If False (default), they are reported as informational items.</span>
<span class="sd">                   Use strict=True to verify a clean ML catalog matches exactly.</span>
<span class="sd">                   Use strict=False to validate a catalog that may have domain extensions.</span>

<span class="sd">        Returns:</span>
<span class="sd">            SchemaValidationReport with validation results. Key attributes:</span>
<span class="sd">                - is_valid: True if no errors were found</span>
<span class="sd">                - errors: List of error-level issues</span>
<span class="sd">                - warnings: List of warning-level issues</span>
<span class="sd">                - info: List of informational items</span>
<span class="sd">                - to_text(): Human-readable report</span>
<span class="sd">                - to_dict(): JSON-serializable dictionary</span>

<span class="sd">        Example:</span>
<span class="sd">            &gt;&gt;&gt; ml = DerivaML(&#39;localhost&#39;, &#39;my_catalog&#39;)</span>
<span class="sd">            &gt;&gt;&gt; report = ml.validate_schema(strict=False)</span>
<span class="sd">            &gt;&gt;&gt; if report.is_valid:</span>
<span class="sd">            ...     print(&quot;Schema is valid!&quot;)</span>
<span class="sd">            ... else:</span>
<span class="sd">            ...     print(report.to_text())</span>

<span class="sd">            &gt;&gt;&gt; # Strict validation for a fresh ML catalog</span>
<span class="sd">            &gt;&gt;&gt; report = ml.validate_schema(strict=True)</span>
<span class="sd">            &gt;&gt;&gt; print(f&quot;Found {len(report.errors)} errors, {len(report.warnings)} warnings&quot;)</span>

<span class="sd">            &gt;&gt;&gt; # Get report as dictionary for JSON/logging</span>
<span class="sd">            &gt;&gt;&gt; import json</span>
<span class="sd">            &gt;&gt;&gt; print(json.dumps(report.to_dict(), indent=2))</span>

<span class="sd">        Note:</span>
<span class="sd">            This method validates the ML schema (typically &#39;deriva-ml&#39;), not the</span>
<span class="sd">            domain schema. Domain-specific tables and columns are not checked</span>
<span class="sd">            unless they are part of the ML schema itself.</span>

<span class="sd">        See Also:</span>
<span class="sd">            - deriva_ml.schema.validation.SchemaValidationReport</span>
<span class="sd">            - deriva_ml.schema.validation.validate_ml_schema</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">deriva_ml.schema.validation</span><span class="w"> </span><span class="kn">import</span> <span class="n">validate_ml_schema</span>
        <span class="k">return</span> <span class="n">validate_ml_schema</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="n">strict</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="deriva_ml.core.DerivaML.catalog_provenance" class="doc doc-heading">
            <span class="doc doc-object-name doc-attribute-name">catalog_provenance</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">catalog_provenance</span><span class="p">:</span> <span class="p">(</span>
    <span class="s2">&quot;CatalogProvenance | None&quot;</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Get the provenance information for this catalog.</p>
<p>Returns provenance information if the catalog has it set. This includes
information about how the catalog was created (clone, create, schema),
who created it, when, and any workflow information.</p>
<p>For cloned catalogs, additional details about the clone operation are
available in the <code>clone_details</code> attribute.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>&#39;CatalogProvenance | None&#39;</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>CatalogProvenance if available, None otherwise.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>ml = DerivaML('localhost', '45')
prov = ml.catalog_provenance
if prov:
...     print(f"Created: {prov.created_at} by {prov.created_by}")
...     print(f"Method: {prov.creation_method.value}")
...     if prov.is_clone:
...         print(f"Cloned from: {prov.clone_details.source_hostname}")</p>
</blockquote>
</blockquote>
</blockquote>
</details>
    </div>

</div>




<div class="doc doc-object doc-function">


<h3 id="deriva_ml.core.DerivaML.__del__" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">__del__</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">__del__</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Cleanup method to handle incomplete executions.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/deriva_ml/core/base.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__del__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Cleanup method to handle incomplete executions.&quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Mark execution as aborted if not completed</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_execution</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_execution</span><span class="o">.</span><span class="n">status</span> <span class="o">!=</span> <span class="n">Status</span><span class="o">.</span><span class="n">completed</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_execution</span><span class="o">.</span><span class="n">update_status</span><span class="p">(</span><span class="n">Status</span><span class="o">.</span><span class="n">aborted</span><span class="p">,</span> <span class="s2">&quot;Execution Aborted&quot;</span><span class="p">)</span>
    <span class="k">except</span> <span class="p">(</span><span class="ne">AttributeError</span><span class="p">,</span> <span class="n">requests</span><span class="o">.</span><span class="n">HTTPError</span><span class="p">):</span>
        <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="deriva_ml.core.DerivaML.__init__" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">__init__</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">__init__</span><span class="p">(</span>
    <span class="n">hostname</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">catalog_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">domain_schemas</span><span class="p">:</span> <span class="nb">str</span>
    <span class="o">|</span> <span class="nb">set</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
    <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">default_schema</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">project_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">cache_dir</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">working_dir</span><span class="p">:</span> <span class="nb">str</span>
    <span class="o">|</span> <span class="n">Path</span>
    <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">hydra_runtime_output_dir</span><span class="p">:</span> <span class="nb">str</span>
    <span class="o">|</span> <span class="n">Path</span>
    <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">ml_schema</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">ML_SCHEMA</span><span class="p">,</span>
    <span class="n">logging_level</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">WARNING</span><span class="p">,</span>
    <span class="n">deriva_logging_level</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">WARNING</span><span class="p">,</span>
    <span class="n">credential</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">s3_bucket</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">use_minid</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">check_auth</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">clean_execution_dir</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Initializes a DerivaML instance.</p>
<p>This method will connect to a catalog and initialize local configuration for the ML execution.
This class is intended to be used as a base class on which domain-specific interfaces are built.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>hostname</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Hostname of the Deriva server.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>catalog_id</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Catalog ID. Either an identifier or a catalog name.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>domain_schemas</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <span title="set">set</span>[<span title="str">str</span>] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional set of domain schema names. If None, auto-detects all
non-system schemas. Use this when working with catalogs that have multiple
user-defined schemas.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>default_schema</code>
            </td>
            <td>
                  <code><span title="str">str</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The default schema for table creation operations. If None and
there is exactly one domain schema, that schema is used. If there are multiple
domain schemas, this must be specified for table creation to work without
explicit schema parameters.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>ml_schema</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Schema name for ML schema. Used if you have a non-standard configuration of deriva-ml.</p>
              </div>
            </td>
            <td>
                  <code><span title="deriva_ml.core.definitions.ML_SCHEMA">ML_SCHEMA</span></code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>project_name</code>
            </td>
            <td>
                  <code><span title="str">str</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Project name. Defaults to name of default_schema.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>cache_dir</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <span title="pathlib.Path">Path</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Directory path for caching data downloaded from the Deriva server as bdbag. If not provided,
will default to working_dir.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>working_dir</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <span title="pathlib.Path">Path</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Directory path for storing data used by or generated by any computations. If no value is
provided, will default to  ${HOME}/deriva_ml</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>s3_bucket</code>
            </td>
            <td>
                  <code><span title="str">str</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>S3 bucket URL for dataset bag storage (e.g., 's3://my-bucket'). If provided,
enables MINID creation and S3 upload for dataset exports. If None, MINID functionality
is disabled regardless of use_minid setting.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>use_minid</code>
            </td>
            <td>
                  <code><span title="bool">bool</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Use the MINID service when downloading dataset bags. Only effective when
s3_bucket is configured. If None (default), automatically set to True when s3_bucket
is provided, False otherwise.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>check_auth</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Check if the user has access to the catalog.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>clean_execution_dir</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to automatically clean up execution working directories
after successful upload. Defaults to True. Set to False to retain local copies.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/deriva_ml/core/base.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">hostname</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">catalog_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">domain_schemas</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">set</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">default_schema</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">project_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">cache_dir</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">working_dir</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">hydra_runtime_output_dir</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">ml_schema</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">ML_SCHEMA</span><span class="p">,</span>
    <span class="n">logging_level</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">WARNING</span><span class="p">,</span>
    <span class="n">deriva_logging_level</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">WARNING</span><span class="p">,</span>
    <span class="n">credential</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">s3_bucket</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">use_minid</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">check_auth</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">clean_execution_dir</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initializes a DerivaML instance.</span>

<span class="sd">    This method will connect to a catalog and initialize local configuration for the ML execution.</span>
<span class="sd">    This class is intended to be used as a base class on which domain-specific interfaces are built.</span>

<span class="sd">    Args:</span>
<span class="sd">        hostname: Hostname of the Deriva server.</span>
<span class="sd">        catalog_id: Catalog ID. Either an identifier or a catalog name.</span>
<span class="sd">        domain_schemas: Optional set of domain schema names. If None, auto-detects all</span>
<span class="sd">            non-system schemas. Use this when working with catalogs that have multiple</span>
<span class="sd">            user-defined schemas.</span>
<span class="sd">        default_schema: The default schema for table creation operations. If None and</span>
<span class="sd">            there is exactly one domain schema, that schema is used. If there are multiple</span>
<span class="sd">            domain schemas, this must be specified for table creation to work without</span>
<span class="sd">            explicit schema parameters.</span>
<span class="sd">        ml_schema: Schema name for ML schema. Used if you have a non-standard configuration of deriva-ml.</span>
<span class="sd">        project_name: Project name. Defaults to name of default_schema.</span>
<span class="sd">        cache_dir: Directory path for caching data downloaded from the Deriva server as bdbag. If not provided,</span>
<span class="sd">            will default to working_dir.</span>
<span class="sd">        working_dir: Directory path for storing data used by or generated by any computations. If no value is</span>
<span class="sd">            provided, will default to  ${HOME}/deriva_ml</span>
<span class="sd">        s3_bucket: S3 bucket URL for dataset bag storage (e.g., &#39;s3://my-bucket&#39;). If provided,</span>
<span class="sd">            enables MINID creation and S3 upload for dataset exports. If None, MINID functionality</span>
<span class="sd">            is disabled regardless of use_minid setting.</span>
<span class="sd">        use_minid: Use the MINID service when downloading dataset bags. Only effective when</span>
<span class="sd">            s3_bucket is configured. If None (default), automatically set to True when s3_bucket</span>
<span class="sd">            is provided, False otherwise.</span>
<span class="sd">        check_auth: Check if the user has access to the catalog.</span>
<span class="sd">        clean_execution_dir: Whether to automatically clean up execution working directories</span>
<span class="sd">            after successful upload. Defaults to True. Set to False to retain local copies.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Get or use provided credentials for server access</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">credential</span> <span class="o">=</span> <span class="n">credential</span> <span class="ow">or</span> <span class="n">get_credential</span><span class="p">(</span><span class="n">hostname</span><span class="p">)</span>

    <span class="c1"># Initialize server connection and catalog access</span>
    <span class="n">server</span> <span class="o">=</span> <span class="n">DerivaServer</span><span class="p">(</span>
        <span class="s2">&quot;https&quot;</span><span class="p">,</span>
        <span class="n">hostname</span><span class="p">,</span>
        <span class="n">credentials</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">credential</span><span class="p">,</span>
        <span class="n">session_config</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_session_config</span><span class="p">(),</span>
    <span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">check_auth</span> <span class="ow">and</span> <span class="n">server</span><span class="o">.</span><span class="n">get_authn_session</span><span class="p">():</span>
            <span class="k">pass</span>
    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">DerivaMLException</span><span class="p">(</span>
            <span class="s2">&quot;You are not authorized to access this catalog. &quot;</span>
            <span class="s2">&quot;Please check your credentials and make sure you have logged in.&quot;</span>
        <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">catalog</span> <span class="o">=</span> <span class="n">server</span><span class="o">.</span><span class="n">connect_ermrest</span><span class="p">(</span><span class="n">catalog_id</span><span class="p">)</span>
    <span class="c1"># Import here to avoid circular imports</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">deriva_ml.model.catalog</span><span class="w"> </span><span class="kn">import</span> <span class="n">DerivaModel</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">DerivaModel</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">catalog</span><span class="o">.</span><span class="n">getCatalogModel</span><span class="p">(),</span>
        <span class="n">ml_schema</span><span class="o">=</span><span class="n">ml_schema</span><span class="p">,</span>
        <span class="n">domain_schemas</span><span class="o">=</span><span class="n">domain_schemas</span><span class="p">,</span>
        <span class="n">default_schema</span><span class="o">=</span><span class="n">default_schema</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1"># Store S3 bucket configuration and resolve use_minid</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">s3_bucket</span> <span class="o">=</span> <span class="n">s3_bucket</span>
    <span class="k">if</span> <span class="n">use_minid</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># Auto mode: enable MINID if s3_bucket is configured</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">use_minid</span> <span class="o">=</span> <span class="n">s3_bucket</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
    <span class="k">elif</span> <span class="n">use_minid</span> <span class="ow">and</span> <span class="n">s3_bucket</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># User requested MINID but no S3 bucket configured - disable MINID</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">use_minid</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">use_minid</span> <span class="o">=</span> <span class="n">use_minid</span>

    <span class="c1"># Set up working and cache directories</span>
    <span class="c1"># If working_dir is already provided (e.g. from DerivaMLConfig.instantiate()),</span>
    <span class="c1"># use it directly; otherwise compute the default path.</span>
    <span class="k">if</span> <span class="n">working_dir</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">working_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">working_dir</span><span class="p">)</span><span class="o">.</span><span class="n">absolute</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">working_dir</span> <span class="o">=</span> <span class="n">DerivaMLConfig</span><span class="o">.</span><span class="n">compute_workdir</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">catalog_id</span><span class="p">,</span> <span class="n">hostname</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">working_dir</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">hydra_runtime_output_dir</span> <span class="o">=</span> <span class="n">hydra_runtime_output_dir</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">cache_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">cache_dir</span><span class="p">)</span> <span class="k">if</span> <span class="n">cache_dir</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">working_dir</span> <span class="o">/</span> <span class="s2">&quot;cache&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">cache_dir</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># Set up logging using centralized configuration</span>
    <span class="c1"># This configures deriva_ml, Hydra, and deriva-py loggers without</span>
    <span class="c1"># affecting the root logger or calling basicConfig()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_logger</span> <span class="o">=</span> <span class="n">configure_logging</span><span class="p">(</span>
        <span class="n">level</span><span class="o">=</span><span class="n">logging_level</span><span class="p">,</span>
        <span class="n">deriva_level</span><span class="o">=</span><span class="n">deriva_logging_level</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_logging_level</span> <span class="o">=</span> <span class="n">logging_level</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_deriva_logging_level</span> <span class="o">=</span> <span class="n">deriva_logging_level</span>

    <span class="c1"># Apply deriva&#39;s default logger overrides for fine-grained control</span>
    <span class="n">apply_logger_overrides</span><span class="p">(</span><span class="n">DEFAULT_LOGGER_OVERRIDES</span><span class="p">)</span>

    <span class="c1"># Store instance configuration</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">host_name</span> <span class="o">=</span> <span class="n">hostname</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">catalog_id</span> <span class="o">=</span> <span class="n">catalog_id</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">ml_schema</span> <span class="o">=</span> <span class="n">ml_schema</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">configuration</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_execution</span><span class="p">:</span> <span class="n">Execution</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">domain_schemas</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">domain_schemas</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">default_schema</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">default_schema</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">project_name</span> <span class="o">=</span> <span class="n">project_name</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_schema</span> <span class="ow">or</span> <span class="s2">&quot;deriva-ml&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">start_time</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">status</span> <span class="o">=</span> <span class="n">Status</span><span class="o">.</span><span class="n">pending</span><span class="o">.</span><span class="n">value</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">clean_execution_dir</span> <span class="o">=</span> <span class="n">clean_execution_dir</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="deriva_ml.core.DerivaML.add_dataset_element_type" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">add_dataset_element_type</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">add_dataset_element_type</span><span class="p">(</span>
    <span class="n">element</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Table</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Table</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Makes it possible to add objects from the specified table to a dataset.</p>
<p>A dataset is a heterogeneous collection of objects, each of which comes from a different table.
This routine adds the specified table as a valid element type for datasets.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>element</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <span title="deriva_ml.core.mixins.dataset.Table">Table</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the table or table object that is to be added to the dataset.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="deriva_ml.core.mixins.dataset.Table">Table</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The table object that was added to the dataset.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/deriva_ml/core/mixins/dataset.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="n">ConfigDict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="k">def</span><span class="w"> </span><span class="nf">add_dataset_element_type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">element</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Table</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Table</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Makes it possible to add objects from the specified table to a dataset.</span>

<span class="sd">    A dataset is a heterogeneous collection of objects, each of which comes from a different table.</span>
<span class="sd">    This routine adds the specified table as a valid element type for datasets.</span>

<span class="sd">    Args:</span>
<span class="sd">        element: Name of the table or table object that is to be added to the dataset.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The table object that was added to the dataset.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Import here to avoid circular imports</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">deriva_ml.dataset.catalog_graph</span><span class="w"> </span><span class="kn">import</span> <span class="n">CatalogGraph</span>

    <span class="c1"># Add table to map</span>
    <span class="n">element_table</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">name_to_table</span><span class="p">(</span><span class="n">element</span><span class="p">)</span>
    <span class="n">atable_def</span> <span class="o">=</span> <span class="n">Table</span><span class="o">.</span><span class="n">define_association</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">_dataset_table</span><span class="p">,</span> <span class="n">element_table</span><span class="p">])</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">table</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">create_table</span><span class="p">(</span><span class="n">atable_def</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">if</span> <span class="s2">&quot;already exists&quot;</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">):</span>
            <span class="n">table</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">name_to_table</span><span class="p">(</span><span class="n">atable_def</span><span class="p">[</span><span class="s2">&quot;table_name&quot;</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">e</span>

    <span class="c1"># self.model = self.catalog.getCatalogModel()</span>
    <span class="n">annotations</span> <span class="o">=</span> <span class="n">CatalogGraph</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s3_bucket</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">s3_bucket</span><span class="p">,</span> <span class="n">use_minid</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">use_minid</span><span class="p">)</span><span class="o">.</span><span class="n">generate_dataset_download_annotations</span><span class="p">()</span>  <span class="c1"># type: ignore[arg-type]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_dataset_table</span><span class="o">.</span><span class="n">annotations</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">annotations</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">apply</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">table</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="deriva_ml.core.DerivaML.add_files" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">add_files</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">add_files</span><span class="p">(</span>
    <span class="n">files</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">FileSpec</span><span class="p">],</span>
    <span class="n">execution_rid</span><span class="p">:</span> <span class="n">RID</span><span class="p">,</span>
    <span class="n">dataset_types</span><span class="p">:</span> <span class="nb">str</span>
    <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
    <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">description</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Dataset&quot;</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Adds files to the catalog with their metadata.</p>
<p>Registers files in the catalog along with their metadata (MD5, length, URL) and associates them with
specified file types. Links files to the specified execution record for provenance tracking.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>files</code>
            </td>
            <td>
                  <code><span title="typing.Iterable">Iterable</span>[<a class="autorefs autorefs-internal" title="FileSpec (deriva_ml.core.definitions.FileSpec)" href="../deriva_definitions/#deriva_ml.core.definitions.FileSpec">FileSpec</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>File specifications containing MD5 checksum, length, and URL.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>execution_rid</code>
            </td>
            <td>
                  <code><span title="deriva_ml.core.definitions.RID">RID</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Execution RID to associate files with (required for provenance).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dataset_types</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <span title="list">list</span>[<span title="str">str</span>] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>One or more dataset type terms from File_Type vocabulary.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>description</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Description of the files.</p>
              </div>
            </td>
            <td>
                  <code>&#39;&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>Dataset</code></td>            <td>
                  <code>&#39;Dataset&#39;</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dataset that represents the newly added files.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="DerivaMLException (deriva_ml.core.exceptions.DerivaMLException)" href="../exceptions/#deriva_ml.core.exceptions.DerivaMLException">DerivaMLException</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If file_types are invalid or execution_rid is not an execution record.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <p>Add files via an execution:
    &gt;&gt;&gt; with ml.create_execution(config) as exe:
    ...     files = [FileSpec(url="path/to/file.txt", md5="abc123", length=1000)]
    ...     dataset = exe.add_files(files, dataset_types="text")</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/deriva_ml/core/mixins/file.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">add_files</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">files</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">FileSpec</span><span class="p">],</span>
    <span class="n">execution_rid</span><span class="p">:</span> <span class="n">RID</span><span class="p">,</span>
    <span class="n">dataset_types</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">description</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Dataset&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Adds files to the catalog with their metadata.</span>

<span class="sd">    Registers files in the catalog along with their metadata (MD5, length, URL) and associates them with</span>
<span class="sd">    specified file types. Links files to the specified execution record for provenance tracking.</span>

<span class="sd">    Args:</span>
<span class="sd">        files: File specifications containing MD5 checksum, length, and URL.</span>
<span class="sd">        execution_rid: Execution RID to associate files with (required for provenance).</span>
<span class="sd">        dataset_types: One or more dataset type terms from File_Type vocabulary.</span>
<span class="sd">        description: Description of the files.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dataset: Dataset that represents the newly added files.</span>

<span class="sd">    Raises:</span>
<span class="sd">        DerivaMLException: If file_types are invalid or execution_rid is not an execution record.</span>

<span class="sd">    Examples:</span>
<span class="sd">        Add files via an execution:</span>
<span class="sd">            &gt;&gt;&gt; with ml.create_execution(config) as exe:</span>
<span class="sd">            ...     files = [FileSpec(url=&quot;path/to/file.txt&quot;, md5=&quot;abc123&quot;, length=1000)]</span>
<span class="sd">            ...     dataset = exe.add_files(files, dataset_types=&quot;text&quot;)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Import here to avoid circular imports</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">deriva_ml.dataset.dataset</span><span class="w"> </span><span class="kn">import</span> <span class="n">Dataset</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">resolve_rid</span><span class="p">(</span><span class="n">execution_rid</span><span class="p">)</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">name</span> <span class="o">!=</span> <span class="s2">&quot;Execution&quot;</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">DerivaMLTableTypeError</span><span class="p">(</span><span class="s2">&quot;Execution&quot;</span><span class="p">,</span> <span class="n">execution_rid</span><span class="p">)</span>

    <span class="n">filespec_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">files</span><span class="p">)</span>

    <span class="c1"># Get a list of all defined file types and their synonyms.</span>
    <span class="n">defined_types</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span>
        <span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">([[</span><span class="n">t</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">synonyms</span> <span class="ow">or</span> <span class="p">[])</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">list_vocabulary_terms</span><span class="p">(</span><span class="n">MLVocab</span><span class="o">.</span><span class="n">asset_type</span><span class="p">)])</span>
    <span class="p">)</span>

    <span class="c1"># Get a list of all of the file types used in the filespec_list</span>
    <span class="n">spec_types</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">(</span><span class="n">filespec</span><span class="o">.</span><span class="n">file_types</span> <span class="k">for</span> <span class="n">filespec</span> <span class="ow">in</span> <span class="n">filespec_list</span><span class="p">))</span>

    <span class="c1"># Now make sure that all of the file types and dataset_types in the spec list are defined.</span>
    <span class="k">if</span> <span class="n">spec_types</span> <span class="o">-</span> <span class="n">defined_types</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">DerivaMLInvalidTerm</span><span class="p">(</span><span class="n">MLVocab</span><span class="o">.</span><span class="n">asset_type</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">spec_types</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">defined_types</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Normalize dataset_types, make sure File type is included.</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dataset_types</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
        <span class="n">dataset_types</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;File&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">dataset_types</span> <span class="k">if</span> <span class="s2">&quot;File&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">dataset_types</span> <span class="k">else</span> <span class="n">dataset_types</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">dataset_types</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;File&quot;</span><span class="p">,</span> <span class="n">dataset_types</span><span class="p">]</span> <span class="k">if</span> <span class="n">dataset_types</span> <span class="k">else</span> <span class="p">[</span><span class="s2">&quot;File&quot;</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">ds_type</span> <span class="ow">in</span> <span class="n">dataset_types</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lookup_term</span><span class="p">(</span><span class="n">MLVocab</span><span class="o">.</span><span class="n">dataset_type</span><span class="p">,</span> <span class="n">ds_type</span><span class="p">)</span>

    <span class="c1"># Add files to the file table, and collect up the resulting entries by directory name.</span>
    <span class="n">pb</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pathBuilder</span><span class="p">()</span>
    <span class="n">file_records</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span>
        <span class="n">pb</span><span class="o">.</span><span class="n">schemas</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ml_schema</span><span class="p">]</span><span class="o">.</span><span class="n">tables</span><span class="p">[</span><span class="s2">&quot;File&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">insert</span><span class="p">([</span><span class="n">f</span><span class="o">.</span><span class="n">model_dump</span><span class="p">(</span><span class="n">by_alias</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">filespec_list</span><span class="p">])</span>
    <span class="p">)</span>

    <span class="c1"># Get the name of the association table between file_table and file_type and add file_type records</span>
    <span class="n">atable</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">find_association</span><span class="p">(</span><span class="n">MLTable</span><span class="o">.</span><span class="n">file</span><span class="p">,</span> <span class="n">MLVocab</span><span class="o">.</span><span class="n">asset_type</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">name</span>
    <span class="c1"># Need to get a link between file record and file_types.</span>
    <span class="n">type_map</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">file_spec</span><span class="o">.</span><span class="n">md5</span><span class="p">:</span> <span class="n">file_spec</span><span class="o">.</span><span class="n">file_types</span> <span class="o">+</span> <span class="p">([]</span> <span class="k">if</span> <span class="s2">&quot;File&quot;</span> <span class="ow">in</span> <span class="n">file_spec</span><span class="o">.</span><span class="n">file_types</span> <span class="k">else</span> <span class="p">[])</span>
        <span class="k">for</span> <span class="n">file_spec</span> <span class="ow">in</span> <span class="n">filespec_list</span>
    <span class="p">}</span>
    <span class="n">file_type_records</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">{</span><span class="n">MLVocab</span><span class="o">.</span><span class="n">asset_type</span><span class="o">.</span><span class="n">value</span><span class="p">:</span> <span class="n">file_type</span><span class="p">,</span> <span class="s2">&quot;File&quot;</span><span class="p">:</span> <span class="n">file_record</span><span class="p">[</span><span class="s2">&quot;RID&quot;</span><span class="p">]}</span>
        <span class="k">for</span> <span class="n">file_record</span> <span class="ow">in</span> <span class="n">file_records</span>
        <span class="k">for</span> <span class="n">file_type</span> <span class="ow">in</span> <span class="n">type_map</span><span class="p">[</span><span class="n">file_record</span><span class="p">[</span><span class="s2">&quot;MD5&quot;</span><span class="p">]]</span>
    <span class="p">]</span>
    <span class="n">pb</span><span class="o">.</span><span class="n">schemas</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ml_schema</span><span class="p">]</span><span class="o">.</span><span class="n">tables</span><span class="p">[</span><span class="n">atable</span><span class="p">]</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">file_type_records</span><span class="p">)</span>

    <span class="c1"># Link files to the execution for provenance tracking.</span>
    <span class="n">pb</span><span class="o">.</span><span class="n">schemas</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ml_schema</span><span class="p">]</span><span class="o">.</span><span class="n">File_Execution</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span>
        <span class="p">[</span>
            <span class="p">{</span><span class="s2">&quot;File&quot;</span><span class="p">:</span> <span class="n">file_record</span><span class="p">[</span><span class="s2">&quot;RID&quot;</span><span class="p">],</span> <span class="s2">&quot;Execution&quot;</span><span class="p">:</span> <span class="n">execution_rid</span><span class="p">,</span> <span class="s2">&quot;Asset_Role&quot;</span><span class="p">:</span> <span class="s2">&quot;Output&quot;</span><span class="p">}</span>
            <span class="k">for</span> <span class="n">file_record</span> <span class="ow">in</span> <span class="n">file_records</span>
        <span class="p">]</span>
    <span class="p">)</span>

    <span class="c1"># Now create datasets to capture the original directory structure of the files.</span>
    <span class="n">dir_rid_map</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">file_records</span><span class="p">:</span>
        <span class="n">dir_rid_map</span><span class="p">[</span><span class="n">Path</span><span class="p">(</span><span class="n">urlsplit</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="s2">&quot;URL&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">path</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="s2">&quot;RID&quot;</span><span class="p">])</span>

    <span class="n">nested_datasets</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">path_length</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">dataset</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="c1"># Start with the longest path so we get subdirectories first.</span>
    <span class="k">for</span> <span class="n">p</span><span class="p">,</span> <span class="n">rids</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">dir_rid_map</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">kv</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">kv</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">parts</span><span class="p">),</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="n">dataset</span> <span class="o">=</span> <span class="n">Dataset</span><span class="o">.</span><span class="n">create_dataset</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>  <span class="c1"># type: ignore[arg-type]</span>
            <span class="n">dataset_types</span><span class="o">=</span><span class="n">dataset_types</span><span class="p">,</span>
            <span class="n">execution_rid</span><span class="o">=</span><span class="n">execution_rid</span><span class="p">,</span>
            <span class="n">description</span><span class="o">=</span><span class="n">description</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">members</span> <span class="o">=</span> <span class="n">rids</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">parts</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">path_length</span><span class="p">:</span>
            <span class="c1"># Going up one level in directory, so Create nested dataset</span>
            <span class="n">members</span> <span class="o">=</span> <span class="p">[</span><span class="n">m</span><span class="o">.</span><span class="n">dataset_rid</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">nested_datasets</span><span class="p">]</span> <span class="o">+</span> <span class="n">rids</span>
            <span class="n">nested_datasets</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">dataset</span><span class="o">.</span><span class="n">add_dataset_members</span><span class="p">(</span><span class="n">members</span><span class="o">=</span><span class="n">members</span><span class="p">,</span> <span class="n">execution_rid</span><span class="o">=</span><span class="n">execution_rid</span><span class="p">)</span>
        <span class="n">nested_datasets</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span>
        <span class="n">path_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">parts</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">dataset</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="deriva_ml.core.DerivaML.add_page" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">add_page</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">add_page</span><span class="p">(</span>
    <span class="n">title</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">content</span><span class="p">:</span> <span class="nb">str</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Adds page to web interface.</p>
<p>Creates a new page in the catalog's web interface with the specified title and content. The page will be
accessible through the catalog's navigation system.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>title</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The title of the page to be displayed in navigation and headers.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>content</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The main content of the page can include HTML markup.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="DerivaMLException (deriva_ml.core.exceptions.DerivaMLException)" href="../exceptions/#deriva_ml.core.exceptions.DerivaMLException">DerivaMLException</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the page creation fails or the user lacks necessary permissions.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>ml.add_page(
...     title="Analysis Results",
...     content="<h1>Results</h1><p>Analysis completed successfully...</p>"
... )</p>
</blockquote>
</blockquote>
</blockquote>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/deriva_ml/core/base.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">add_page</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">title</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">content</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Adds page to web interface.</span>

<span class="sd">    Creates a new page in the catalog&#39;s web interface with the specified title and content. The page will be</span>
<span class="sd">    accessible through the catalog&#39;s navigation system.</span>

<span class="sd">    Args:</span>
<span class="sd">        title: The title of the page to be displayed in navigation and headers.</span>
<span class="sd">        content: The main content of the page can include HTML markup.</span>

<span class="sd">    Raises:</span>
<span class="sd">        DerivaMLException: If the page creation fails or the user lacks necessary permissions.</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; ml.add_page(</span>
<span class="sd">        ...     title=&quot;Analysis Results&quot;,</span>
<span class="sd">        ...     content=&quot;&lt;h1&gt;Results&lt;/h1&gt;&lt;p&gt;Analysis completed successfully...&lt;/p&gt;&quot;</span>
<span class="sd">        ... )</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Insert page into www tables with title and content</span>
    <span class="c1"># Use default schema or first domain schema for www tables</span>
    <span class="n">schema</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_schema</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">domain_schemas</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">domain_schemas</span> <span class="k">else</span> <span class="kc">None</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">schema</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">DerivaMLException</span><span class="p">(</span><span class="s2">&quot;No domain schema available for adding pages&quot;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">pathBuilder</span><span class="p">()</span><span class="o">.</span><span class="n">www</span><span class="o">.</span><span class="n">tables</span><span class="p">[</span><span class="n">schema</span><span class="p">]</span><span class="o">.</span><span class="n">insert</span><span class="p">([{</span><span class="s2">&quot;Title&quot;</span><span class="p">:</span> <span class="n">title</span><span class="p">,</span> <span class="s2">&quot;Content&quot;</span><span class="p">:</span> <span class="n">content</span><span class="p">}])</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="deriva_ml.core.DerivaML.add_term" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">add_term</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">add_term</span><span class="p">(</span>
    <span class="n">table</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Table</span><span class="p">,</span>
    <span class="n">term_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">description</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">synonyms</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">exists_ok</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">VocabularyTermHandle</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Adds a term to a vocabulary table.</p>
<p>Creates a new standardized term with description and optional synonyms in a vocabulary table.
Can either create a new term or return an existing one if it already exists.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>table</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <span title="deriva_ml.core.mixins.vocabulary.Table">Table</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Vocabulary table to add term to (name or Table object).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>term_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Primary name of the term (must be unique within vocabulary).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>description</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Explanation of term's meaning and usage.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>synonyms</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Alternative names for the term.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>exists_ok</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, return the existing term if found. If False, raise error.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>VocabularyTermHandle</code></td>            <td>
                  <code><a class="autorefs autorefs-internal" title="VocabularyTermHandle (deriva_ml.core.definitions.VocabularyTermHandle)" href="../deriva_definitions/#deriva_ml.core.definitions.VocabularyTermHandle">VocabularyTermHandle</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Object representing the created or existing term, with
methods to modify it in the catalog.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="DerivaMLException (deriva_ml.core.exceptions.DerivaMLException)" href="../exceptions/#deriva_ml.core.exceptions.DerivaMLException">DerivaMLException</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If a term exists and exists_ok=False, or if the table is not a vocabulary table.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <p>Add a new tissue type:
    &gt;&gt;&gt; term = ml.add_term(
    ...     table="tissue_types",
    ...     term_name="epithelial",
    ...     description="Epithelial tissue type",
    ...     synonyms=["epithelium"]
    ... )
    &gt;&gt;&gt; # Modify the term
    &gt;&gt;&gt; term.description = "Updated description"
    &gt;&gt;&gt; term.synonyms = ("epithelium", "epithelial_tissue")</p>
<p>Attempt to add an existing term:
    &gt;&gt;&gt; term = ml.add_term("tissue_types", "epithelial", "...", exists_ok=True)</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/deriva_ml/core/mixins/vocabulary.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="n">ConfigDict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="k">def</span><span class="w"> </span><span class="nf">add_term</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">table</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Table</span><span class="p">,</span>
    <span class="n">term_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">description</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">synonyms</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">exists_ok</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">VocabularyTermHandle</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Adds a term to a vocabulary table.</span>

<span class="sd">    Creates a new standardized term with description and optional synonyms in a vocabulary table.</span>
<span class="sd">    Can either create a new term or return an existing one if it already exists.</span>

<span class="sd">    Args:</span>
<span class="sd">        table: Vocabulary table to add term to (name or Table object).</span>
<span class="sd">        term_name: Primary name of the term (must be unique within vocabulary).</span>
<span class="sd">        description: Explanation of term&#39;s meaning and usage.</span>
<span class="sd">        synonyms: Alternative names for the term.</span>
<span class="sd">        exists_ok: If True, return the existing term if found. If False, raise error.</span>

<span class="sd">    Returns:</span>
<span class="sd">        VocabularyTermHandle: Object representing the created or existing term, with</span>
<span class="sd">            methods to modify it in the catalog.</span>

<span class="sd">    Raises:</span>
<span class="sd">        DerivaMLException: If a term exists and exists_ok=False, or if the table is not a vocabulary table.</span>

<span class="sd">    Examples:</span>
<span class="sd">        Add a new tissue type:</span>
<span class="sd">            &gt;&gt;&gt; term = ml.add_term(</span>
<span class="sd">            ...     table=&quot;tissue_types&quot;,</span>
<span class="sd">            ...     term_name=&quot;epithelial&quot;,</span>
<span class="sd">            ...     description=&quot;Epithelial tissue type&quot;,</span>
<span class="sd">            ...     synonyms=[&quot;epithelium&quot;]</span>
<span class="sd">            ... )</span>
<span class="sd">            &gt;&gt;&gt; # Modify the term</span>
<span class="sd">            &gt;&gt;&gt; term.description = &quot;Updated description&quot;</span>
<span class="sd">            &gt;&gt;&gt; term.synonyms = (&quot;epithelium&quot;, &quot;epithelial_tissue&quot;)</span>

<span class="sd">        Attempt to add an existing term:</span>
<span class="sd">            &gt;&gt;&gt; term = ml.add_term(&quot;tissue_types&quot;, &quot;epithelial&quot;, &quot;...&quot;, exists_ok=True)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Initialize an empty synonyms list if None</span>
    <span class="n">synonyms</span> <span class="o">=</span> <span class="n">synonyms</span> <span class="ow">or</span> <span class="p">[]</span>

    <span class="c1"># Get table reference and validate if it is a vocabulary table</span>
    <span class="n">vocab_table</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">name_to_table</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>
    <span class="n">pb</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pathBuilder</span><span class="p">()</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">is_vocabulary</span><span class="p">(</span><span class="n">vocab_table</span><span class="p">)):</span>
        <span class="k">raise</span> <span class="n">DerivaMLTableTypeError</span><span class="p">(</span><span class="s2">&quot;vocabulary&quot;</span><span class="p">,</span> <span class="n">vocab_table</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

    <span class="c1"># Get schema and table names for path building</span>
    <span class="n">schema_name</span> <span class="o">=</span> <span class="n">vocab_table</span><span class="o">.</span><span class="n">schema</span><span class="o">.</span><span class="n">name</span>
    <span class="n">table_name</span> <span class="o">=</span> <span class="n">vocab_table</span><span class="o">.</span><span class="n">name</span>
    <span class="n">cols</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">vocab_columns</span><span class="p">(</span><span class="n">vocab_table</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Attempt to insert a new term</span>
        <span class="n">term_data</span> <span class="o">=</span> <span class="n">pb</span><span class="o">.</span><span class="n">schemas</span><span class="p">[</span><span class="n">schema_name</span><span class="p">]</span><span class="o">.</span><span class="n">tables</span><span class="p">[</span><span class="n">table_name</span><span class="p">]</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="p">{</span>
                    <span class="n">cols</span><span class="p">[</span><span class="s2">&quot;Name&quot;</span><span class="p">]:</span> <span class="n">term_name</span><span class="p">,</span>
                    <span class="n">cols</span><span class="p">[</span><span class="s2">&quot;Description&quot;</span><span class="p">]:</span> <span class="n">description</span><span class="p">,</span>
                    <span class="n">cols</span><span class="p">[</span><span class="s2">&quot;Synonyms&quot;</span><span class="p">]:</span> <span class="n">synonyms</span><span class="p">,</span>
                <span class="p">}</span>
            <span class="p">],</span>
            <span class="n">defaults</span><span class="o">=</span><span class="p">{</span><span class="n">cols</span><span class="p">[</span><span class="s2">&quot;ID&quot;</span><span class="p">],</span> <span class="n">cols</span><span class="p">[</span><span class="s2">&quot;URI&quot;</span><span class="p">]},</span>
        <span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">term_handle</span> <span class="o">=</span> <span class="n">VocabularyTermHandle</span><span class="p">(</span><span class="n">ml</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="n">table_name</span><span class="p">,</span> <span class="o">**</span><span class="n">term_data</span><span class="p">)</span>
        <span class="c1"># Invalidate cache for this vocabulary since we added a new term</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">clear_vocabulary_cache</span><span class="p">(</span><span class="n">vocab_table</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">term_handle</span>
    <span class="k">except</span> <span class="n">DataPathException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="c1"># Insert failed  check if it&#39;s because the term already exists</span>
        <span class="c1"># or because of some other database error (permissions, schema, etc.)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">existing_term</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lookup_term</span><span class="p">(</span><span class="n">vocab_table</span><span class="p">,</span> <span class="n">term_name</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">DerivaMLInvalidTerm</span><span class="p">:</span>
            <span class="c1"># Term doesn&#39;t exist  the insert failed for another reason</span>
            <span class="k">raise</span> <span class="n">DerivaMLException</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Failed to insert term &#39;</span><span class="si">{</span><span class="n">term_name</span><span class="si">}</span><span class="s2">&#39; into </span><span class="si">{</span><span class="n">vocab_table</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>
        <span class="c1"># Term does exist  either return it or raise depending on exists_ok</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">exists_ok</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DerivaMLInvalidTerm</span><span class="p">(</span><span class="n">vocab_table</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">term_name</span><span class="p">,</span> <span class="n">msg</span><span class="o">=</span><span class="s2">&quot;term already exists&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">existing_term</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="deriva_ml.core.DerivaML.add_visible_column" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">add_visible_column</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">add_visible_column</span><span class="p">(</span>
    <span class="n">table</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Table</span><span class="p">,</span>
    <span class="n">context</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">column</span><span class="p">:</span> <span class="nb">str</span>
    <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
    <span class="o">|</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
    <span class="n">position</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Any</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Add a column to the visible-columns list for a specific context.</p>
<p>Convenience method for adding columns without replacing the entire
visible-columns annotation. Changes are staged until apply_annotations()
is called.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>table</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <span title="deriva_ml.core.mixins.annotation.Table">Table</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Table name or Table object.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>context</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The context to modify (e.g., "compact", "detailed", "entry").</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>column</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <span title="list">list</span>[<span title="str">str</span>] | <span title="dict">dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Column to add. Can be:
- String: column name (e.g., "Filename")
- List: foreign key reference (e.g., ["schema", "fkey_name"])
- Dict: pseudo-column definition</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>position</code>
            </td>
            <td>
                  <code><span title="int">int</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Position to insert at (0-indexed). If None, appends to end.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The updated column list for the context.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="DerivaMLException (deriva_ml.core.exceptions.DerivaMLException)" href="../exceptions/#deriva_ml.core.exceptions.DerivaMLException">DerivaMLException</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If context references another context.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>ml.add_visible_column("Image", "compact", "Description")
ml.add_visible_column("Image", "detailed", ["domain", "Image_Subject_fkey"], 1)
ml.apply_annotations()</p>
</blockquote>
</blockquote>
</blockquote>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/deriva_ml/core/mixins/annotation.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="n">ConfigDict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="k">def</span><span class="w"> </span><span class="nf">add_visible_column</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">table</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Table</span><span class="p">,</span>
    <span class="n">context</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">column</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
    <span class="n">position</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Add a column to the visible-columns list for a specific context.</span>

<span class="sd">    Convenience method for adding columns without replacing the entire</span>
<span class="sd">    visible-columns annotation. Changes are staged until apply_annotations()</span>
<span class="sd">    is called.</span>

<span class="sd">    Args:</span>
<span class="sd">        table: Table name or Table object.</span>
<span class="sd">        context: The context to modify (e.g., &quot;compact&quot;, &quot;detailed&quot;, &quot;entry&quot;).</span>
<span class="sd">        column: Column to add. Can be:</span>
<span class="sd">            - String: column name (e.g., &quot;Filename&quot;)</span>
<span class="sd">            - List: foreign key reference (e.g., [&quot;schema&quot;, &quot;fkey_name&quot;])</span>
<span class="sd">            - Dict: pseudo-column definition</span>
<span class="sd">        position: Position to insert at (0-indexed). If None, appends to end.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The updated column list for the context.</span>

<span class="sd">    Raises:</span>
<span class="sd">        DerivaMLException: If context references another context.</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; ml.add_visible_column(&quot;Image&quot;, &quot;compact&quot;, &quot;Description&quot;)</span>
<span class="sd">        &gt;&gt;&gt; ml.add_visible_column(&quot;Image&quot;, &quot;detailed&quot;, [&quot;domain&quot;, &quot;Image_Subject_fkey&quot;], 1)</span>
<span class="sd">        &gt;&gt;&gt; ml.apply_annotations()</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">table_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">name_to_table</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>

    <span class="c1"># Get or create visible_columns annotation</span>
    <span class="n">visible_cols</span> <span class="o">=</span> <span class="n">table_obj</span><span class="o">.</span><span class="n">annotations</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">VISIBLE_COLUMNS_TAG</span><span class="p">,</span> <span class="p">{})</span>
    <span class="k">if</span> <span class="n">visible_cols</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">visible_cols</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="c1"># Get or create the context list</span>
    <span class="n">context_list</span> <span class="o">=</span> <span class="n">visible_cols</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="p">[])</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">context_list</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">raise</span> <span class="n">DerivaMLException</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Context &#39;</span><span class="si">{</span><span class="n">context</span><span class="si">}</span><span class="s2">&#39; references another context &#39;</span><span class="si">{</span><span class="n">context_list</span><span class="si">}</span><span class="s2">&#39;. &quot;</span>
            <span class="s2">&quot;Set it explicitly first with set_visible_columns().&quot;</span>
        <span class="p">)</span>

    <span class="c1"># Make a copy to avoid modifying in place</span>
    <span class="n">context_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">context_list</span><span class="p">)</span>

    <span class="c1"># Insert at position or append</span>
    <span class="k">if</span> <span class="n">position</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">context_list</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">position</span><span class="p">,</span> <span class="n">column</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">context_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">column</span><span class="p">)</span>

    <span class="c1"># Update the annotation</span>
    <span class="n">visible_cols</span><span class="p">[</span><span class="n">context</span><span class="p">]</span> <span class="o">=</span> <span class="n">context_list</span>
    <span class="n">table_obj</span><span class="o">.</span><span class="n">annotations</span><span class="p">[</span><span class="n">VISIBLE_COLUMNS_TAG</span><span class="p">]</span> <span class="o">=</span> <span class="n">visible_cols</span>

    <span class="k">return</span> <span class="n">context_list</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="deriva_ml.core.DerivaML.add_visible_foreign_key" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">add_visible_foreign_key</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">add_visible_foreign_key</span><span class="p">(</span>
    <span class="n">table</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Table</span><span class="p">,</span>
    <span class="n">context</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">foreign_key</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
    <span class="o">|</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
    <span class="n">position</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Any</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Add a foreign key to the visible-foreign-keys list for a specific context.</p>
<p>Convenience method for adding related tables without replacing the entire
visible-foreign-keys annotation. Changes are staged until apply_annotations()
is called.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>table</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <span title="deriva_ml.core.mixins.annotation.Table">Table</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Table name or Table object.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>context</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The context to modify (typically "detailed" or "*").</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>foreign_key</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>] | <span title="dict">dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Foreign key to add. Can be:
- List: inbound foreign key reference (e.g., ["schema", "Other_Table_fkey"])
- Dict: pseudo-column definition for complex relationships</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>position</code>
            </td>
            <td>
                  <code><span title="int">int</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Position to insert at (0-indexed). If None, appends to end.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The updated foreign key list for the context.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="DerivaMLException (deriva_ml.core.exceptions.DerivaMLException)" href="../exceptions/#deriva_ml.core.exceptions.DerivaMLException">DerivaMLException</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If context references another context.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>ml.add_visible_foreign_key("Subject", "detailed", ["domain", "Image_Subject_fkey"])
ml.apply_annotations()</p>
</blockquote>
</blockquote>
</blockquote>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/deriva_ml/core/mixins/annotation.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="n">ConfigDict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="k">def</span><span class="w"> </span><span class="nf">add_visible_foreign_key</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">table</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Table</span><span class="p">,</span>
    <span class="n">context</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">foreign_key</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
    <span class="n">position</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Add a foreign key to the visible-foreign-keys list for a specific context.</span>

<span class="sd">    Convenience method for adding related tables without replacing the entire</span>
<span class="sd">    visible-foreign-keys annotation. Changes are staged until apply_annotations()</span>
<span class="sd">    is called.</span>

<span class="sd">    Args:</span>
<span class="sd">        table: Table name or Table object.</span>
<span class="sd">        context: The context to modify (typically &quot;detailed&quot; or &quot;*&quot;).</span>
<span class="sd">        foreign_key: Foreign key to add. Can be:</span>
<span class="sd">            - List: inbound foreign key reference (e.g., [&quot;schema&quot;, &quot;Other_Table_fkey&quot;])</span>
<span class="sd">            - Dict: pseudo-column definition for complex relationships</span>
<span class="sd">        position: Position to insert at (0-indexed). If None, appends to end.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The updated foreign key list for the context.</span>

<span class="sd">    Raises:</span>
<span class="sd">        DerivaMLException: If context references another context.</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; ml.add_visible_foreign_key(&quot;Subject&quot;, &quot;detailed&quot;, [&quot;domain&quot;, &quot;Image_Subject_fkey&quot;])</span>
<span class="sd">        &gt;&gt;&gt; ml.apply_annotations()</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">table_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">name_to_table</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>

    <span class="c1"># Get or create visible_foreign_keys annotation</span>
    <span class="n">visible_fkeys</span> <span class="o">=</span> <span class="n">table_obj</span><span class="o">.</span><span class="n">annotations</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">VISIBLE_FOREIGN_KEYS_TAG</span><span class="p">,</span> <span class="p">{})</span>
    <span class="k">if</span> <span class="n">visible_fkeys</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">visible_fkeys</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="c1"># Get or create the context list</span>
    <span class="n">context_list</span> <span class="o">=</span> <span class="n">visible_fkeys</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="p">[])</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">context_list</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">raise</span> <span class="n">DerivaMLException</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Context &#39;</span><span class="si">{</span><span class="n">context</span><span class="si">}</span><span class="s2">&#39; references another context &#39;</span><span class="si">{</span><span class="n">context_list</span><span class="si">}</span><span class="s2">&#39;. &quot;</span>
            <span class="s2">&quot;Set it explicitly first with set_visible_foreign_keys().&quot;</span>
        <span class="p">)</span>

    <span class="c1"># Make a copy to avoid modifying in place</span>
    <span class="n">context_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">context_list</span><span class="p">)</span>

    <span class="c1"># Insert at position or append</span>
    <span class="k">if</span> <span class="n">position</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">context_list</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">position</span><span class="p">,</span> <span class="n">foreign_key</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">context_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">foreign_key</span><span class="p">)</span>

    <span class="c1"># Update the annotation</span>
    <span class="n">visible_fkeys</span><span class="p">[</span><span class="n">context</span><span class="p">]</span> <span class="o">=</span> <span class="n">context_list</span>
    <span class="n">table_obj</span><span class="o">.</span><span class="n">annotations</span><span class="p">[</span><span class="n">VISIBLE_FOREIGN_KEYS_TAG</span><span class="p">]</span> <span class="o">=</span> <span class="n">visible_fkeys</span>

    <span class="k">return</span> <span class="n">context_list</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="deriva_ml.core.DerivaML.add_workflow" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">add_workflow</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">add_workflow</span><span class="p">(</span><span class="n">workflow</span><span class="p">:</span> <span class="n">Workflow</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">RID</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Adds a workflow to the catalog.</p>
<p>Registers a new workflow in the catalog or returns the RID of an existing workflow with the same
URL or checksum.</p>
<p>Each workflow represents a specific computational process or analysis pipeline.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>workflow</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Workflow (deriva_ml.execution.workflow.Workflow)" href="../workflow/#deriva_ml.execution.workflow.Workflow">Workflow</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Workflow object containing name, URL, type, version, and description.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>RID</code></td>            <td>
                  <code><span title="deriva_ml.core.definitions.RID">RID</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Resource Identifier of the added or existing workflow.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="DerivaMLException (deriva_ml.core.exceptions.DerivaMLException)" href="../exceptions/#deriva_ml.core.exceptions.DerivaMLException">DerivaMLException</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If workflow insertion fails or required fields are missing.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">workflow</span> <span class="o">=</span> <span class="n">Workflow</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Gene Analysis&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">url</span><span class="o">=</span><span class="s2">&quot;https://github.com/org/repo/workflows/gene_analysis.py&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">workflow_type</span><span class="o">=</span><span class="s2">&quot;python_script&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">version</span><span class="o">=</span><span class="s2">&quot;1.0.0&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Analyzes gene expression patterns&quot;</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">workflow_rid</span> <span class="o">=</span> <span class="n">ml</span><span class="o">.</span><span class="n">add_workflow</span><span class="p">(</span><span class="n">workflow</span><span class="p">)</span>
</code></pre></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/deriva_ml/core/mixins/workflow.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">add_workflow</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">workflow</span><span class="p">:</span> <span class="n">Workflow</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">RID</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Adds a workflow to the catalog.</span>

<span class="sd">    Registers a new workflow in the catalog or returns the RID of an existing workflow with the same</span>
<span class="sd">    URL or checksum.</span>

<span class="sd">    Each workflow represents a specific computational process or analysis pipeline.</span>

<span class="sd">    Args:</span>
<span class="sd">        workflow: Workflow object containing name, URL, type, version, and description.</span>

<span class="sd">    Returns:</span>
<span class="sd">        RID: Resource Identifier of the added or existing workflow.</span>

<span class="sd">    Raises:</span>
<span class="sd">        DerivaMLException: If workflow insertion fails or required fields are missing.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; workflow = Workflow(</span>
<span class="sd">        ...     name=&quot;Gene Analysis&quot;,</span>
<span class="sd">        ...     url=&quot;https://github.com/org/repo/workflows/gene_analysis.py&quot;,</span>
<span class="sd">        ...     workflow_type=&quot;python_script&quot;,</span>
<span class="sd">        ...     version=&quot;1.0.0&quot;,</span>
<span class="sd">        ...     description=&quot;Analyzes gene expression patterns&quot;</span>
<span class="sd">        ... )</span>
<span class="sd">        &gt;&gt;&gt; workflow_rid = ml.add_workflow(workflow)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Check if a workflow already exists by URL or checksum</span>
    <span class="k">if</span> <span class="n">workflow_rid</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_find_workflow_rid_by_url</span><span class="p">(</span><span class="n">workflow</span><span class="o">.</span><span class="n">checksum</span> <span class="ow">or</span> <span class="n">workflow</span><span class="o">.</span><span class="n">url</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">workflow_rid</span>

    <span class="c1"># Get an ML schema path for the workflow table</span>
    <span class="n">ml_schema_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pathBuilder</span><span class="p">()</span><span class="o">.</span><span class="n">schemas</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ml_schema</span><span class="p">]</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Create a workflow record</span>
        <span class="n">workflow_record</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;URL&quot;</span><span class="p">:</span> <span class="n">workflow</span><span class="o">.</span><span class="n">url</span><span class="p">,</span>
            <span class="s2">&quot;Name&quot;</span><span class="p">:</span> <span class="n">workflow</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
            <span class="s2">&quot;Description&quot;</span><span class="p">:</span> <span class="n">workflow</span><span class="o">.</span><span class="n">description</span><span class="p">,</span>
            <span class="s2">&quot;Checksum&quot;</span><span class="p">:</span> <span class="n">workflow</span><span class="o">.</span><span class="n">checksum</span><span class="p">,</span>
            <span class="s2">&quot;Version&quot;</span><span class="p">:</span> <span class="n">workflow</span><span class="o">.</span><span class="n">version</span><span class="p">,</span>
            <span class="n">MLVocab</span><span class="o">.</span><span class="n">workflow_type</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">lookup_term</span><span class="p">(</span><span class="n">MLVocab</span><span class="o">.</span><span class="n">workflow_type</span><span class="p">,</span> <span class="n">workflow</span><span class="o">.</span><span class="n">workflow_type</span><span class="p">)</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="c1"># Insert a workflow and get its RID</span>
        <span class="n">workflow_rid</span> <span class="o">=</span> <span class="n">ml_schema_path</span><span class="o">.</span><span class="n">Workflow</span><span class="o">.</span><span class="n">insert</span><span class="p">([</span><span class="n">workflow_record</span><span class="p">])[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;RID&quot;</span><span class="p">]</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">error</span> <span class="o">=</span> <span class="n">format_exception</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
        <span class="k">raise</span> <span class="n">DerivaMLException</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed to insert workflow. Error: </span><span class="si">{</span><span class="n">error</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">workflow_rid</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="deriva_ml.core.DerivaML.apply_annotations" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">apply_annotations</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">apply_annotations</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Apply all staged annotation changes to the catalog.</p>
<p>Commits any annotation changes made via set_display_annotation,
set_visible_columns, set_visible_foreign_keys, set_table_display,
or set_column_display to the remote catalog.</p>


<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>ml.set_display_annotation("Image", {"name": "Images"})
ml.set_visible_columns("Image", {"compact": ["RID", "Filename"]})
ml.apply_annotations()  # Commit all changes</p>
</blockquote>
</blockquote>
</blockquote>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/deriva_ml/core/mixins/annotation.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">apply_annotations</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Apply all staged annotation changes to the catalog.</span>

<span class="sd">    Commits any annotation changes made via set_display_annotation,</span>
<span class="sd">    set_visible_columns, set_visible_foreign_keys, set_table_display,</span>
<span class="sd">    or set_column_display to the remote catalog.</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; ml.set_display_annotation(&quot;Image&quot;, {&quot;name&quot;: &quot;Images&quot;})</span>
<span class="sd">        &gt;&gt;&gt; ml.set_visible_columns(&quot;Image&quot;, {&quot;compact&quot;: [&quot;RID&quot;, &quot;Filename&quot;]})</span>
<span class="sd">        &gt;&gt;&gt; ml.apply_annotations()  # Commit all changes</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">apply</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="deriva_ml.core.DerivaML.apply_catalog_annotations" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">apply_catalog_annotations</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">apply_catalog_annotations</span><span class="p">(</span>
    <span class="n">navbar_brand_text</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;ML Data Browser&quot;</span><span class="p">,</span>
    <span class="n">head_title</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;Catalog ML&quot;</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Apply catalog-level annotations including the navigation bar and display settings.</p>
<p>This method configures the Chaise web interface for the catalog. Chaise is Deriva's
web-based data browser that provides a user-friendly interface for exploring and
managing catalog data. This method sets up annotations that control how Chaise
displays and organizes the catalog.</p>
<p><strong>Navigation Bar Structure</strong>:
The method creates a navigation bar with the following menus:
- <strong>User Info</strong>: Links to Users, Groups, and RID Lease tables
- <strong>Deriva-ML</strong>: Core ML tables (Workflow, Execution, Dataset, Dataset_Version, etc.)
- <strong>WWW</strong>: Web content tables (Page, File)
- <strong>{Domain Schema}</strong>: All domain-specific tables (excludes vocabularies and associations)
- <strong>Vocabulary</strong>: All controlled vocabulary tables from both ML and domain schemas
- <strong>Assets</strong>: All asset tables from both ML and domain schemas
- <strong>Features</strong>: All feature tables with entries named "TableName:FeatureName"
- <strong>Catalog Registry</strong>: Link to the ermrest registry
- <strong>Documentation</strong>: Links to ML notebook instructions and Deriva-ML docs</p>
<p><strong>Display Settings</strong>:
- Underscores in table/column names displayed as spaces
- System columns (RID) shown in compact and entry views
- Default table set to Dataset
- Faceting and record deletion enabled
- Export configurations available to all users</p>
<p><strong>Bulk Upload Configuration</strong>:
Configures upload patterns for asset tables, enabling drag-and-drop file uploads
through the Chaise interface.</p>
<p>Call this after creating the domain schema and all tables to initialize the catalog's
web interface. The navigation menus are dynamically built based on the current schema
structure, automatically organizing tables into appropriate categories.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>navbar_brand_text</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Text displayed in the navigation bar brand area.</p>
              </div>
            </td>
            <td>
                  <code>&#39;ML Data Browser&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>head_title</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Title displayed in the browser tab.</p>
              </div>
            </td>
            <td>
                  <code>&#39;Catalog ML&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>ml = DerivaML('deriva.example.org', 'my_catalog')</p>
<h4 id="deriva_ml.core.DerivaML.apply_catalog_annotations--after-creating-domain-schema-and-tables">After creating domain schema and tables...</h4>
<p>ml.apply_catalog_annotations()</p>
<h4 id="deriva_ml.core.DerivaML.apply_catalog_annotations--or-with-custom-branding">Or with custom branding:</h4>
<p>ml.apply_catalog_annotations("My Project Browser", "My ML Project")</p>
</blockquote>
</blockquote>
</blockquote>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/deriva_ml/core/base.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">apply_catalog_annotations</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">navbar_brand_text</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;ML Data Browser&quot;</span><span class="p">,</span>
    <span class="n">head_title</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;Catalog ML&quot;</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Apply catalog-level annotations including the navigation bar and display settings.</span>

<span class="sd">    This method configures the Chaise web interface for the catalog. Chaise is Deriva&#39;s</span>
<span class="sd">    web-based data browser that provides a user-friendly interface for exploring and</span>
<span class="sd">    managing catalog data. This method sets up annotations that control how Chaise</span>
<span class="sd">    displays and organizes the catalog.</span>

<span class="sd">    **Navigation Bar Structure**:</span>
<span class="sd">    The method creates a navigation bar with the following menus:</span>
<span class="sd">    - **User Info**: Links to Users, Groups, and RID Lease tables</span>
<span class="sd">    - **Deriva-ML**: Core ML tables (Workflow, Execution, Dataset, Dataset_Version, etc.)</span>
<span class="sd">    - **WWW**: Web content tables (Page, File)</span>
<span class="sd">    - **{Domain Schema}**: All domain-specific tables (excludes vocabularies and associations)</span>
<span class="sd">    - **Vocabulary**: All controlled vocabulary tables from both ML and domain schemas</span>
<span class="sd">    - **Assets**: All asset tables from both ML and domain schemas</span>
<span class="sd">    - **Features**: All feature tables with entries named &quot;TableName:FeatureName&quot;</span>
<span class="sd">    - **Catalog Registry**: Link to the ermrest registry</span>
<span class="sd">    - **Documentation**: Links to ML notebook instructions and Deriva-ML docs</span>

<span class="sd">    **Display Settings**:</span>
<span class="sd">    - Underscores in table/column names displayed as spaces</span>
<span class="sd">    - System columns (RID) shown in compact and entry views</span>
<span class="sd">    - Default table set to Dataset</span>
<span class="sd">    - Faceting and record deletion enabled</span>
<span class="sd">    - Export configurations available to all users</span>

<span class="sd">    **Bulk Upload Configuration**:</span>
<span class="sd">    Configures upload patterns for asset tables, enabling drag-and-drop file uploads</span>
<span class="sd">    through the Chaise interface.</span>

<span class="sd">    Call this after creating the domain schema and all tables to initialize the catalog&#39;s</span>
<span class="sd">    web interface. The navigation menus are dynamically built based on the current schema</span>
<span class="sd">    structure, automatically organizing tables into appropriate categories.</span>

<span class="sd">    Args:</span>
<span class="sd">        navbar_brand_text: Text displayed in the navigation bar brand area.</span>
<span class="sd">        head_title: Title displayed in the browser tab.</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; ml = DerivaML(&#39;deriva.example.org&#39;, &#39;my_catalog&#39;)</span>
<span class="sd">        &gt;&gt;&gt; # After creating domain schema and tables...</span>
<span class="sd">        &gt;&gt;&gt; ml.apply_catalog_annotations()</span>
<span class="sd">        &gt;&gt;&gt; # Or with custom branding:</span>
<span class="sd">        &gt;&gt;&gt; ml.apply_catalog_annotations(&quot;My Project Browser&quot;, &quot;My ML Project&quot;)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">catalog_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">catalog</span><span class="o">.</span><span class="n">catalog_id</span>
    <span class="n">ml_schema</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ml_schema</span>

    <span class="c1"># Build domain schema menu items (one menu per domain schema)</span>
    <span class="n">domain_schema_menus</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">domain_schema</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">domain_schemas</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">domain_schema</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">schemas</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="n">domain_schema_menus</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">domain_schema</span><span class="p">,</span>
            <span class="s2">&quot;children&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="p">{</span>
                    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">tname</span><span class="p">,</span>
                    <span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;/chaise/recordset/#</span><span class="si">{</span><span class="n">catalog_id</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">domain_schema</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">tname</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="p">}</span>
                <span class="k">for</span> <span class="n">tname</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">schemas</span><span class="p">[</span><span class="n">domain_schema</span><span class="p">]</span><span class="o">.</span><span class="n">tables</span>
                <span class="c1"># Don&#39;t include controlled vocabularies, association tables, or feature tables.</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">is_vocabulary</span><span class="p">(</span><span class="n">tname</span><span class="p">)</span>
                    <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">is_association</span><span class="p">(</span><span class="n">tname</span><span class="p">,</span> <span class="n">pure</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">max_arity</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
                <span class="p">)</span>
            <span class="p">],</span>
        <span class="p">})</span>

    <span class="c1"># Build vocabulary menu items (ML schema + all domain schemas)</span>
    <span class="n">vocab_children</span> <span class="o">=</span> <span class="p">[{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ml_schema</span><span class="si">}</span><span class="s2"> Vocabularies&quot;</span><span class="p">,</span> <span class="s2">&quot;header&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">}]</span>
    <span class="n">vocab_children</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span>
        <span class="p">{</span>
            <span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;/chaise/recordset/#</span><span class="si">{</span><span class="n">catalog_id</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">ml_schema</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">tname</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">tname</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="k">for</span> <span class="n">tname</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">schemas</span><span class="p">[</span><span class="n">ml_schema</span><span class="p">]</span><span class="o">.</span><span class="n">tables</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">is_vocabulary</span><span class="p">(</span><span class="n">tname</span><span class="p">)</span>
    <span class="p">])</span>
    <span class="k">for</span> <span class="n">domain_schema</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">domain_schemas</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">domain_schema</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">schemas</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="n">vocab_children</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">domain_schema</span><span class="si">}</span><span class="s2"> Vocabularies&quot;</span><span class="p">,</span> <span class="s2">&quot;header&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
        <span class="n">vocab_children</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span>
            <span class="p">{</span>
                <span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;/chaise/recordset/#</span><span class="si">{</span><span class="n">catalog_id</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">domain_schema</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">tname</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">tname</span><span class="p">,</span>
            <span class="p">}</span>
            <span class="k">for</span> <span class="n">tname</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">schemas</span><span class="p">[</span><span class="n">domain_schema</span><span class="p">]</span><span class="o">.</span><span class="n">tables</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">is_vocabulary</span><span class="p">(</span><span class="n">tname</span><span class="p">)</span>
        <span class="p">])</span>

    <span class="c1"># Build asset menu items (ML schema + all domain schemas)</span>
    <span class="n">asset_children</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;/chaise/recordset/#</span><span class="si">{</span><span class="n">catalog_id</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">ml_schema</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">tname</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">tname</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="k">for</span> <span class="n">tname</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">schemas</span><span class="p">[</span><span class="n">ml_schema</span><span class="p">]</span><span class="o">.</span><span class="n">tables</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">is_asset</span><span class="p">(</span><span class="n">tname</span><span class="p">)</span>
    <span class="p">]</span>
    <span class="k">for</span> <span class="n">domain_schema</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">domain_schemas</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">domain_schema</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">schemas</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="n">asset_children</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span>
            <span class="p">{</span>
                <span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;/chaise/recordset/#</span><span class="si">{</span><span class="n">catalog_id</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">domain_schema</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">tname</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">tname</span><span class="p">,</span>
            <span class="p">}</span>
            <span class="k">for</span> <span class="n">tname</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">schemas</span><span class="p">[</span><span class="n">domain_schema</span><span class="p">]</span><span class="o">.</span><span class="n">tables</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">is_asset</span><span class="p">(</span><span class="n">tname</span><span class="p">)</span>
        <span class="p">])</span>

    <span class="n">catalog_annotation</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">deriva_tags</span><span class="o">.</span><span class="n">display</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;name_style&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;underline_space&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">}},</span>
        <span class="n">deriva_tags</span><span class="o">.</span><span class="n">chaise_config</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;headTitle&quot;</span><span class="p">:</span> <span class="n">head_title</span><span class="p">,</span>
            <span class="s2">&quot;navbarBrandText&quot;</span><span class="p">:</span> <span class="n">navbar_brand_text</span><span class="p">,</span>
            <span class="s2">&quot;systemColumnsDisplayEntry&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;RID&quot;</span><span class="p">],</span>
            <span class="s2">&quot;systemColumnsDisplayCompact&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;RID&quot;</span><span class="p">],</span>
            <span class="s2">&quot;defaultTable&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;table&quot;</span><span class="p">:</span> <span class="s2">&quot;Dataset&quot;</span><span class="p">,</span> <span class="s2">&quot;schema&quot;</span><span class="p">:</span> <span class="s2">&quot;deriva-ml&quot;</span><span class="p">},</span>
            <span class="s2">&quot;deleteRecord&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
            <span class="s2">&quot;showFaceting&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
            <span class="s2">&quot;shareCiteAcls&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
            <span class="s2">&quot;exportConfigsSubmenu&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;acls&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;show&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;*&quot;</span><span class="p">],</span> <span class="s2">&quot;enable&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;*&quot;</span><span class="p">]}},</span>
            <span class="s2">&quot;resolverImplicitCatalog&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
            <span class="s2">&quot;navbarMenu&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;newTab&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
                <span class="s2">&quot;children&quot;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="p">{</span>
                        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;User Info&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;children&quot;</span><span class="p">:</span> <span class="p">[</span>
                            <span class="p">{</span>
                                <span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;/chaise/recordset/#</span><span class="si">{</span><span class="n">catalog_id</span><span class="si">}</span><span class="s2">/public:ERMrest_Client&quot;</span><span class="p">,</span>
                                <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Users&quot;</span><span class="p">,</span>
                            <span class="p">},</span>
                            <span class="p">{</span>
                                <span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;/chaise/recordset/#</span><span class="si">{</span><span class="n">catalog_id</span><span class="si">}</span><span class="s2">/public:ERMrest_Group&quot;</span><span class="p">,</span>
                                <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Groups&quot;</span><span class="p">,</span>
                            <span class="p">},</span>
                            <span class="p">{</span>
                                <span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;/chaise/recordset/#</span><span class="si">{</span><span class="n">catalog_id</span><span class="si">}</span><span class="s2">/public:ERMrest_RID_Lease&quot;</span><span class="p">,</span>
                                <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;ERMrest RID Lease&quot;</span><span class="p">,</span>
                            <span class="p">},</span>
                        <span class="p">],</span>
                    <span class="p">},</span>
                    <span class="p">{</span>  <span class="c1"># All the primary tables in deriva-ml schema.</span>
                        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Deriva-ML&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;children&quot;</span><span class="p">:</span> <span class="p">[</span>
                            <span class="p">{</span>
                                <span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;/chaise/recordset/#</span><span class="si">{</span><span class="n">catalog_id</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">ml_schema</span><span class="si">}</span><span class="s2">:Workflow&quot;</span><span class="p">,</span>
                                <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Workflow&quot;</span><span class="p">,</span>
                            <span class="p">},</span>
                            <span class="p">{</span>
                                <span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;/chaise/recordset/#</span><span class="si">{</span><span class="n">catalog_id</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">ml_schema</span><span class="si">}</span><span class="s2">:Execution&quot;</span><span class="p">,</span>
                                <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Execution&quot;</span><span class="p">,</span>
                            <span class="p">},</span>
                            <span class="p">{</span>
                                <span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;/chaise/recordset/#</span><span class="si">{</span><span class="n">catalog_id</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">ml_schema</span><span class="si">}</span><span class="s2">:Execution_Metadata&quot;</span><span class="p">,</span>
                                <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Execution Metadata&quot;</span><span class="p">,</span>
                            <span class="p">},</span>
                            <span class="p">{</span>
                                <span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;/chaise/recordset/#</span><span class="si">{</span><span class="n">catalog_id</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">ml_schema</span><span class="si">}</span><span class="s2">:Execution_Asset&quot;</span><span class="p">,</span>
                                <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Execution Asset&quot;</span><span class="p">,</span>
                            <span class="p">},</span>
                            <span class="p">{</span>
                                <span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;/chaise/recordset/#</span><span class="si">{</span><span class="n">catalog_id</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">ml_schema</span><span class="si">}</span><span class="s2">:Dataset&quot;</span><span class="p">,</span>
                                <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Dataset&quot;</span><span class="p">,</span>
                            <span class="p">},</span>
                            <span class="p">{</span>
                                <span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;/chaise/recordset/#</span><span class="si">{</span><span class="n">catalog_id</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">ml_schema</span><span class="si">}</span><span class="s2">:Dataset_Version&quot;</span><span class="p">,</span>
                                <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Dataset Version&quot;</span><span class="p">,</span>
                            <span class="p">},</span>
                        <span class="p">],</span>
                    <span class="p">},</span>
                    <span class="p">{</span>  <span class="c1"># WWW schema tables.</span>
                        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;WWW&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;children&quot;</span><span class="p">:</span> <span class="p">[</span>
                            <span class="p">{</span>
                                <span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;/chaise/recordset/#</span><span class="si">{</span><span class="n">catalog_id</span><span class="si">}</span><span class="s2">/WWW:Page&quot;</span><span class="p">,</span>
                                <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Page&quot;</span><span class="p">,</span>
                            <span class="p">},</span>
                            <span class="p">{</span>
                                <span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;/chaise/recordset/#</span><span class="si">{</span><span class="n">catalog_id</span><span class="si">}</span><span class="s2">/WWW:File&quot;</span><span class="p">,</span>
                                <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;File&quot;</span><span class="p">,</span>
                            <span class="p">},</span>
                        <span class="p">],</span>
                    <span class="p">},</span>
                    <span class="o">*</span><span class="n">domain_schema_menus</span><span class="p">,</span>  <span class="c1"># One menu per domain schema</span>
                    <span class="p">{</span>  <span class="c1"># Vocabulary menu with all controlled vocabularies.</span>
                        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Vocabulary&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;children&quot;</span><span class="p">:</span> <span class="n">vocab_children</span><span class="p">,</span>
                    <span class="p">},</span>
                    <span class="p">{</span>  <span class="c1"># List of all asset tables.</span>
                        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Assets&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;children&quot;</span><span class="p">:</span> <span class="n">asset_children</span><span class="p">,</span>
                    <span class="p">},</span>
                    <span class="p">{</span>  <span class="c1"># List of all feature tables in the catalog.</span>
                        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Features&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;children&quot;</span><span class="p">:</span> <span class="p">[</span>
                            <span class="p">{</span>
                                <span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;/chaise/recordset/#</span><span class="si">{</span><span class="n">catalog_id</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">f</span><span class="o">.</span><span class="n">feature_table</span><span class="o">.</span><span class="n">schema</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">f</span><span class="o">.</span><span class="n">feature_table</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                                <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">f</span><span class="o">.</span><span class="n">target_table</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">f</span><span class="o">.</span><span class="n">feature_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                            <span class="p">}</span>
                            <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">find_features</span><span class="p">()</span>
                        <span class="p">],</span>
                    <span class="p">},</span>
                    <span class="p">{</span>
                        <span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="s2">&quot;/chaise/recordset/#0/ermrest:registry@sort(RID)&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Catalog Registry&quot;</span><span class="p">,</span>
                    <span class="p">},</span>
                    <span class="p">{</span>
                        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Documentation&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;children&quot;</span><span class="p">:</span> <span class="p">[</span>
                            <span class="p">{</span>
                                <span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="s2">&quot;https://github.com/informatics-isi-edu/deriva-ml/blob/main/docs/ml_workflow_instruction.md&quot;</span><span class="p">,</span>
                                <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;ML Notebook Instruction&quot;</span><span class="p">,</span>
                            <span class="p">},</span>
                            <span class="p">{</span>
                                <span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="s2">&quot;https://informatics-isi-edu.github.io/deriva-ml/&quot;</span><span class="p">,</span>
                                <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Deriva-ML Documentation&quot;</span><span class="p">,</span>
                            <span class="p">},</span>
                        <span class="p">],</span>
                    <span class="p">},</span>
                <span class="p">],</span>
            <span class="p">},</span>
        <span class="p">},</span>
        <span class="n">deriva_tags</span><span class="o">.</span><span class="n">bulk_upload</span><span class="p">:</span> <span class="n">bulk_upload_configuration</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">),</span>
    <span class="p">}</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">annotations</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">catalog_annotation</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">apply</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="deriva_ml.core.DerivaML.catalog_snapshot" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">catalog_snapshot</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">catalog_snapshot</span><span class="p">(</span>
    <span class="n">version_snapshot</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Returns a DerivaML instance for a specific snapshot of the catalog.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/deriva_ml/core/base.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">catalog_snapshot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">version_snapshot</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns a DerivaML instance for a specific snapshot of the catalog.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">DerivaML</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">host_name</span><span class="p">,</span>
        <span class="n">version_snapshot</span><span class="p">,</span>
        <span class="n">logging_level</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_logging_level</span><span class="p">,</span>
        <span class="n">deriva_logging_level</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_deriva_logging_level</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="deriva_ml.core.DerivaML.chaise_url" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">chaise_url</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">chaise_url</span><span class="p">(</span>
    <span class="n">table</span><span class="p">:</span> <span class="n">RID</span> <span class="o">|</span> <span class="n">Table</span> <span class="o">|</span> <span class="nb">str</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Generates Chaise web interface URL.</p>
<p>Chaise is Deriva's web interface for data exploration. This method creates a URL that directly links to
the specified table or record.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>table</code>
            </td>
            <td>
                  <code><span title="deriva_ml.core.definitions.RID">RID</span> | <span title="deriva_ml.core.base.Table">Table</span> | <span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Table to generate URL for (name, Table object, or RID).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>str</code></td>            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>URL in format: https://{host}/chaise/recordset/#{catalog}/{schema}:{table}</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="DerivaMLException (deriva_ml.core.exceptions.DerivaMLException)" href="../exceptions/#deriva_ml.core.exceptions.DerivaMLException">DerivaMLException</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If table or RID cannot be found.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <p>Using table name:
    &gt;&gt;&gt; ml.chaise_url("experiment_table")
    'https://deriva.org/chaise/recordset/#1/schema:experiment_table'</p>
<p>Using RID:
    &gt;&gt;&gt; ml.chaise_url("1-abc123")</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/deriva_ml/core/base.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">chaise_url</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">:</span> <span class="n">RID</span> <span class="o">|</span> <span class="n">Table</span> <span class="o">|</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generates Chaise web interface URL.</span>

<span class="sd">    Chaise is Deriva&#39;s web interface for data exploration. This method creates a URL that directly links to</span>
<span class="sd">    the specified table or record.</span>

<span class="sd">    Args:</span>
<span class="sd">        table: Table to generate URL for (name, Table object, or RID).</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: URL in format: https://{host}/chaise/recordset/#{catalog}/{schema}:{table}</span>

<span class="sd">    Raises:</span>
<span class="sd">        DerivaMLException: If table or RID cannot be found.</span>

<span class="sd">    Examples:</span>
<span class="sd">        Using table name:</span>
<span class="sd">            &gt;&gt;&gt; ml.chaise_url(&quot;experiment_table&quot;)</span>
<span class="sd">            &#39;https://deriva.org/chaise/recordset/#1/schema:experiment_table&#39;</span>

<span class="sd">        Using RID:</span>
<span class="sd">            &gt;&gt;&gt; ml.chaise_url(&quot;1-abc123&quot;)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Get the table object and build base URI</span>
    <span class="n">table_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">name_to_table</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">uri</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">catalog</span><span class="o">.</span><span class="n">get_server_uri</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;ermrest/catalog/&quot;</span><span class="p">,</span> <span class="s2">&quot;chaise/recordset/#&quot;</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">DerivaMLException</span><span class="p">:</span>
        <span class="c1"># Handle RID case</span>
        <span class="n">uri</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cite</span><span class="p">(</span><span class="n">cast</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">table</span><span class="p">))</span>
    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">uri</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">urlquote</span><span class="p">(</span><span class="n">table_obj</span><span class="o">.</span><span class="n">schema</span><span class="o">.</span><span class="n">name</span><span class="p">)</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">urlquote</span><span class="p">(</span><span class="n">table_obj</span><span class="o">.</span><span class="n">name</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="deriva_ml.core.DerivaML.cite" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">cite</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">cite</span><span class="p">(</span>
    <span class="n">entity</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">current</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Generates citation URL for an entity.</p>
<p>Creates a URL that can be used to reference a specific entity in the catalog.
By default, includes the catalog snapshot time to ensure version stability
(permanent citation). With current=True, returns a URL to the current state.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>entity</code>
            </td>
            <td>
                  <code><span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>] | <span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Either a RID string or a dictionary containing entity data with a 'RID' key.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>current</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, return URL to current catalog state (no snapshot).
     If False (default), return permanent citation URL with snapshot time.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>str</code></td>            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Citation URL. Format depends on <code>current</code> parameter:
- current=False: https://{host}/id/{catalog}/{rid}@{snapshot_time}
- current=True: https://{host}/id/{catalog}/{rid}</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="DerivaMLException (deriva_ml.core.exceptions.DerivaMLException)" href="../exceptions/#deriva_ml.core.exceptions.DerivaMLException">DerivaMLException</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If an entity doesn't exist or lacks a RID.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <p>Permanent citation (default):
    &gt;&gt;&gt; url = ml.cite("1-abc123")
    &gt;&gt;&gt; print(url)
    'https://deriva.org/id/1/1-abc123@2024-01-01T12:00:00'</p>
<p>Current catalog URL:
    &gt;&gt;&gt; url = ml.cite("1-abc123", current=True)
    &gt;&gt;&gt; print(url)
    'https://deriva.org/id/1/1-abc123'</p>
<p>Using a dictionary:
    &gt;&gt;&gt; url = ml.cite({"RID": "1-abc123"})</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/deriva_ml/core/base.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">cite</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entity</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="nb">str</span><span class="p">,</span> <span class="n">current</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generates citation URL for an entity.</span>

<span class="sd">    Creates a URL that can be used to reference a specific entity in the catalog.</span>
<span class="sd">    By default, includes the catalog snapshot time to ensure version stability</span>
<span class="sd">    (permanent citation). With current=True, returns a URL to the current state.</span>

<span class="sd">    Args:</span>
<span class="sd">        entity: Either a RID string or a dictionary containing entity data with a &#39;RID&#39; key.</span>
<span class="sd">        current: If True, return URL to current catalog state (no snapshot).</span>
<span class="sd">                 If False (default), return permanent citation URL with snapshot time.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: Citation URL. Format depends on `current` parameter:</span>
<span class="sd">            - current=False: https://{host}/id/{catalog}/{rid}@{snapshot_time}</span>
<span class="sd">            - current=True: https://{host}/id/{catalog}/{rid}</span>

<span class="sd">    Raises:</span>
<span class="sd">        DerivaMLException: If an entity doesn&#39;t exist or lacks a RID.</span>

<span class="sd">    Examples:</span>
<span class="sd">        Permanent citation (default):</span>
<span class="sd">            &gt;&gt;&gt; url = ml.cite(&quot;1-abc123&quot;)</span>
<span class="sd">            &gt;&gt;&gt; print(url)</span>
<span class="sd">            &#39;https://deriva.org/id/1/1-abc123@2024-01-01T12:00:00&#39;</span>

<span class="sd">        Current catalog URL:</span>
<span class="sd">            &gt;&gt;&gt; url = ml.cite(&quot;1-abc123&quot;, current=True)</span>
<span class="sd">            &gt;&gt;&gt; print(url)</span>
<span class="sd">            &#39;https://deriva.org/id/1/1-abc123&#39;</span>

<span class="sd">        Using a dictionary:</span>
<span class="sd">            &gt;&gt;&gt; url = ml.cite({&quot;RID&quot;: &quot;1-abc123&quot;})</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Return if already a citation URL</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">entity</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="n">entity</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;https://</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">host_name</span><span class="si">}</span><span class="s2">/id/</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">catalog_id</span><span class="si">}</span><span class="s2">/&quot;</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">entity</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Resolve RID and create citation URL</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">resolve_rid</span><span class="p">(</span><span class="n">rid</span> <span class="o">:=</span> <span class="n">entity</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">entity</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">else</span> <span class="n">entity</span><span class="p">[</span><span class="s2">&quot;RID&quot;</span><span class="p">])</span>
        <span class="n">base_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;https://</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">host_name</span><span class="si">}</span><span class="s2">/id/</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">catalog_id</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">rid</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">if</span> <span class="n">current</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">base_url</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">base_url</span><span class="si">}</span><span class="s2">@</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">catalog</span><span class="o">.</span><span class="n">latest_snapshot</span><span class="p">()</span><span class="o">.</span><span class="n">snaptime</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">except</span> <span class="ne">KeyError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">DerivaMLException</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Entity </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2"> does not have RID column&quot;</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">DerivaMLException</span> <span class="k">as</span> <span class="n">_e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">DerivaMLException</span><span class="p">(</span><span class="s2">&quot;Entity RID does not exist&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="deriva_ml.core.DerivaML.clean_execution_dirs" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">clean_execution_dirs</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">clean_execution_dirs</span><span class="p">(</span>
    <span class="n">older_than_days</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">exclude_rids</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
    <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Clean up execution working directories.</p>
<p>Removes execution output directories from the local working directory.
Use this to free up disk space from completed or orphaned executions.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>older_than_days</code>
            </td>
            <td>
                  <code><span title="int">int</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If provided, only remove directories older than this
many days. If None, removes all execution directories (except excluded).</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>exclude_rids</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of execution RIDs to preserve (never remove).</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dict with keys:
- 'dirs_removed': Number of directories removed
- 'bytes_freed': Total bytes freed
- 'errors': Number of removal errors</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>ml = DerivaML('deriva.example.org', 'my_catalog')</p>
<h4 id="deriva_ml.core.DerivaML.clean_execution_dirs--clean-all-execution-dirs-older-than-30-days">Clean all execution dirs older than 30 days</h4>
<p>result = ml.clean_execution_dirs(older_than_days=30)
print(f"Freed {result['bytes_freed'] / 1e9:.2f} GB")</p>
<h4 id="deriva_ml.core.DerivaML.clean_execution_dirs--clean-all-except-specific-executions">Clean all except specific executions</h4>
<p>result = ml.clean_execution_dirs(exclude_rids=['1-ABC', '1-DEF'])</p>
</blockquote>
</blockquote>
</blockquote>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/deriva_ml/core/base.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1133</span>
<span class="normal">1134</span>
<span class="normal">1135</span>
<span class="normal">1136</span>
<span class="normal">1137</span>
<span class="normal">1138</span>
<span class="normal">1139</span>
<span class="normal">1140</span>
<span class="normal">1141</span>
<span class="normal">1142</span>
<span class="normal">1143</span>
<span class="normal">1144</span>
<span class="normal">1145</span>
<span class="normal">1146</span>
<span class="normal">1147</span>
<span class="normal">1148</span>
<span class="normal">1149</span>
<span class="normal">1150</span>
<span class="normal">1151</span>
<span class="normal">1152</span>
<span class="normal">1153</span>
<span class="normal">1154</span>
<span class="normal">1155</span>
<span class="normal">1156</span>
<span class="normal">1157</span>
<span class="normal">1158</span>
<span class="normal">1159</span>
<span class="normal">1160</span>
<span class="normal">1161</span>
<span class="normal">1162</span>
<span class="normal">1163</span>
<span class="normal">1164</span>
<span class="normal">1165</span>
<span class="normal">1166</span>
<span class="normal">1167</span>
<span class="normal">1168</span>
<span class="normal">1169</span>
<span class="normal">1170</span>
<span class="normal">1171</span>
<span class="normal">1172</span>
<span class="normal">1173</span>
<span class="normal">1174</span>
<span class="normal">1175</span>
<span class="normal">1176</span>
<span class="normal">1177</span>
<span class="normal">1178</span>
<span class="normal">1179</span>
<span class="normal">1180</span>
<span class="normal">1181</span>
<span class="normal">1182</span>
<span class="normal">1183</span>
<span class="normal">1184</span>
<span class="normal">1185</span>
<span class="normal">1186</span>
<span class="normal">1187</span>
<span class="normal">1188</span>
<span class="normal">1189</span>
<span class="normal">1190</span>
<span class="normal">1191</span>
<span class="normal">1192</span>
<span class="normal">1193</span>
<span class="normal">1194</span>
<span class="normal">1195</span>
<span class="normal">1196</span>
<span class="normal">1197</span>
<span class="normal">1198</span>
<span class="normal">1199</span>
<span class="normal">1200</span>
<span class="normal">1201</span>
<span class="normal">1202</span>
<span class="normal">1203</span>
<span class="normal">1204</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">clean_execution_dirs</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">older_than_days</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">exclude_rids</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Clean up execution working directories.</span>

<span class="sd">    Removes execution output directories from the local working directory.</span>
<span class="sd">    Use this to free up disk space from completed or orphaned executions.</span>

<span class="sd">    Args:</span>
<span class="sd">        older_than_days: If provided, only remove directories older than this</span>
<span class="sd">            many days. If None, removes all execution directories (except excluded).</span>
<span class="sd">        exclude_rids: List of execution RIDs to preserve (never remove).</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict with keys:</span>
<span class="sd">            - &#39;dirs_removed&#39;: Number of directories removed</span>
<span class="sd">            - &#39;bytes_freed&#39;: Total bytes freed</span>
<span class="sd">            - &#39;errors&#39;: Number of removal errors</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; ml = DerivaML(&#39;deriva.example.org&#39;, &#39;my_catalog&#39;)</span>
<span class="sd">        &gt;&gt;&gt; # Clean all execution dirs older than 30 days</span>
<span class="sd">        &gt;&gt;&gt; result = ml.clean_execution_dirs(older_than_days=30)</span>
<span class="sd">        &gt;&gt;&gt; print(f&quot;Freed {result[&#39;bytes_freed&#39;] / 1e9:.2f} GB&quot;)</span>
<span class="sd">        &gt;&gt;&gt;</span>
<span class="sd">        &gt;&gt;&gt; # Clean all except specific executions</span>
<span class="sd">        &gt;&gt;&gt; result = ml.clean_execution_dirs(exclude_rids=[&#39;1-ABC&#39;, &#39;1-DEF&#39;])</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">shutil</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">time</span>

    <span class="kn">from</span><span class="w"> </span><span class="nn">deriva_ml.dataset.upload</span><span class="w"> </span><span class="kn">import</span> <span class="n">upload_root</span>

    <span class="n">stats</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;dirs_removed&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;bytes_freed&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;errors&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">}</span>
    <span class="n">exclude_rids</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">exclude_rids</span> <span class="ow">or</span> <span class="p">[])</span>

    <span class="n">exec_root</span> <span class="o">=</span> <span class="n">upload_root</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">working_dir</span><span class="p">)</span> <span class="o">/</span> <span class="s2">&quot;execution&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">exec_root</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
        <span class="k">return</span> <span class="n">stats</span>

    <span class="n">cutoff_time</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="n">older_than_days</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">cutoff_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="p">(</span><span class="n">older_than_days</span> <span class="o">*</span> <span class="mi">24</span> <span class="o">*</span> <span class="mi">60</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">exec_root</span><span class="o">.</span><span class="n">iterdir</span><span class="p">():</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">entry</span><span class="o">.</span><span class="n">is_dir</span><span class="p">():</span>
            <span class="k">continue</span>

        <span class="c1"># Skip excluded RIDs</span>
        <span class="k">if</span> <span class="n">entry</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">exclude_rids</span><span class="p">:</span>
            <span class="k">continue</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Check age if filtering</span>
            <span class="k">if</span> <span class="n">cutoff_time</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">entry_mtime</span> <span class="o">=</span> <span class="n">entry</span><span class="o">.</span><span class="n">stat</span><span class="p">()</span><span class="o">.</span><span class="n">st_mtime</span>
                <span class="k">if</span> <span class="n">entry_mtime</span> <span class="o">&gt;</span> <span class="n">cutoff_time</span><span class="p">:</span>
                    <span class="k">continue</span>

            <span class="c1"># Calculate size before removal</span>
            <span class="n">entry_size</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">stat</span><span class="p">()</span><span class="o">.</span><span class="n">st_size</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">entry</span><span class="o">.</span><span class="n">rglob</span><span class="p">(</span><span class="s1">&#39;*&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">is_file</span><span class="p">())</span>
            <span class="n">shutil</span><span class="o">.</span><span class="n">rmtree</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>
            <span class="n">stats</span><span class="p">[</span><span class="s1">&#39;dirs_removed&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">stats</span><span class="p">[</span><span class="s1">&#39;bytes_freed&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">entry_size</span>

        <span class="k">except</span> <span class="p">(</span><span class="ne">OSError</span><span class="p">,</span> <span class="ne">PermissionError</span><span class="p">)</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed to remove execution dir </span><span class="si">{</span><span class="n">entry</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">stats</span><span class="p">[</span><span class="s1">&#39;errors&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="k">return</span> <span class="n">stats</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="deriva_ml.core.DerivaML.clear_cache" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">clear_cache</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">clear_cache</span><span class="p">(</span>
    <span class="n">older_than_days</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Clear the dataset cache directory.</p>
<p>Removes cached dataset bags from the cache directory. Can optionally filter
by age to only remove old cache entries.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>older_than_days</code>
            </td>
            <td>
                  <code><span title="int">int</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If provided, only remove cache entries older than this
many days. If None, removes all cache entries.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dict with keys:
- 'files_removed': Number of files removed
- 'dirs_removed': Number of directories removed
- 'bytes_freed': Total bytes freed
- 'errors': Number of removal errors</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>ml = DerivaML('deriva.example.org', 'my_catalog')</p>
<h4 id="deriva_ml.core.DerivaML.clear_cache--clear-all-cache">Clear all cache</h4>
<p>result = ml.clear_cache()
print(f"Freed {result['bytes_freed'] / 1e6:.1f} MB")</p>
<h4 id="deriva_ml.core.DerivaML.clear_cache--clear-cache-older-than-7-days">Clear cache older than 7 days</h4>
<p>result = ml.clear_cache(older_than_days=7)</p>
</blockquote>
</blockquote>
</blockquote>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/deriva_ml/core/base.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 987</span>
<span class="normal"> 988</span>
<span class="normal"> 989</span>
<span class="normal"> 990</span>
<span class="normal"> 991</span>
<span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span>
<span class="normal">1047</span>
<span class="normal">1048</span>
<span class="normal">1049</span>
<span class="normal">1050</span>
<span class="normal">1051</span>
<span class="normal">1052</span>
<span class="normal">1053</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">clear_cache</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">older_than_days</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Clear the dataset cache directory.</span>

<span class="sd">    Removes cached dataset bags from the cache directory. Can optionally filter</span>
<span class="sd">    by age to only remove old cache entries.</span>

<span class="sd">    Args:</span>
<span class="sd">        older_than_days: If provided, only remove cache entries older than this</span>
<span class="sd">            many days. If None, removes all cache entries.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict with keys:</span>
<span class="sd">            - &#39;files_removed&#39;: Number of files removed</span>
<span class="sd">            - &#39;dirs_removed&#39;: Number of directories removed</span>
<span class="sd">            - &#39;bytes_freed&#39;: Total bytes freed</span>
<span class="sd">            - &#39;errors&#39;: Number of removal errors</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; ml = DerivaML(&#39;deriva.example.org&#39;, &#39;my_catalog&#39;)</span>
<span class="sd">        &gt;&gt;&gt; # Clear all cache</span>
<span class="sd">        &gt;&gt;&gt; result = ml.clear_cache()</span>
<span class="sd">        &gt;&gt;&gt; print(f&quot;Freed {result[&#39;bytes_freed&#39;] / 1e6:.1f} MB&quot;)</span>
<span class="sd">        &gt;&gt;&gt;</span>
<span class="sd">        &gt;&gt;&gt; # Clear cache older than 7 days</span>
<span class="sd">        &gt;&gt;&gt; result = ml.clear_cache(older_than_days=7)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">shutil</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">time</span>

    <span class="n">stats</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;files_removed&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;dirs_removed&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;bytes_freed&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;errors&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">}</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">cache_dir</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
        <span class="k">return</span> <span class="n">stats</span>

    <span class="n">cutoff_time</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="n">older_than_days</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">cutoff_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="p">(</span><span class="n">older_than_days</span> <span class="o">*</span> <span class="mi">24</span> <span class="o">*</span> <span class="mi">60</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cache_dir</span><span class="o">.</span><span class="n">iterdir</span><span class="p">():</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="c1"># Check age if filtering</span>
                <span class="k">if</span> <span class="n">cutoff_time</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">entry_mtime</span> <span class="o">=</span> <span class="n">entry</span><span class="o">.</span><span class="n">stat</span><span class="p">()</span><span class="o">.</span><span class="n">st_mtime</span>
                    <span class="k">if</span> <span class="n">entry_mtime</span> <span class="o">&gt;</span> <span class="n">cutoff_time</span><span class="p">:</span>
                        <span class="k">continue</span>  <span class="c1"># Skip recent entries</span>

                <span class="c1"># Calculate size before removal</span>
                <span class="k">if</span> <span class="n">entry</span><span class="o">.</span><span class="n">is_dir</span><span class="p">():</span>
                    <span class="n">entry_size</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">stat</span><span class="p">()</span><span class="o">.</span><span class="n">st_size</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">entry</span><span class="o">.</span><span class="n">rglob</span><span class="p">(</span><span class="s1">&#39;*&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">is_file</span><span class="p">())</span>
                    <span class="n">shutil</span><span class="o">.</span><span class="n">rmtree</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>
                    <span class="n">stats</span><span class="p">[</span><span class="s1">&#39;dirs_removed&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">entry_size</span> <span class="o">=</span> <span class="n">entry</span><span class="o">.</span><span class="n">stat</span><span class="p">()</span><span class="o">.</span><span class="n">st_size</span>
                    <span class="n">entry</span><span class="o">.</span><span class="n">unlink</span><span class="p">()</span>
                    <span class="n">stats</span><span class="p">[</span><span class="s1">&#39;files_removed&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>

                <span class="n">stats</span><span class="p">[</span><span class="s1">&#39;bytes_freed&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">entry_size</span>
            <span class="k">except</span> <span class="p">(</span><span class="ne">OSError</span><span class="p">,</span> <span class="ne">PermissionError</span><span class="p">)</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed to remove cache entry </span><span class="si">{</span><span class="n">entry</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="n">stats</span><span class="p">[</span><span class="s1">&#39;errors&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="k">except</span> <span class="ne">OSError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed to iterate cache directory: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">stats</span><span class="p">[</span><span class="s1">&#39;errors&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="k">return</span> <span class="n">stats</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="deriva_ml.core.DerivaML.clear_vocabulary_cache" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">clear_vocabulary_cache</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">clear_vocabulary_cache</span><span class="p">(</span>
    <span class="n">table</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Table</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Clear the vocabulary term cache.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>table</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <span title="deriva_ml.core.mixins.vocabulary.Table">Table</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If provided, only clear cache for this specific vocabulary table.
   If None, clear the entire cache.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/deriva_ml/core/mixins/vocabulary.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">clear_vocabulary_cache</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Table</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Clear the vocabulary term cache.</span>

<span class="sd">    Args:</span>
<span class="sd">        table: If provided, only clear cache for this specific vocabulary table.</span>
<span class="sd">               If None, clear the entire cache.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">cache</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_vocab_cache</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">table</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">cache</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">vocab_table</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">name_to_table</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>
        <span class="n">cache_key</span> <span class="o">=</span> <span class="p">(</span><span class="n">vocab_table</span><span class="o">.</span><span class="n">schema</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">vocab_table</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="n">cache</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">cache_key</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="deriva_ml.core.DerivaML.create_asset" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">create_asset</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">create_asset</span><span class="p">(</span>
    <span class="n">asset_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">column_defs</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span>
        <span class="n">ColumnDefinition</span>
    <span class="p">]</span>
    <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">fkey_defs</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span>
        <span class="n">ColumnDefinition</span>
    <span class="p">]</span>
    <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">referenced_tables</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">Table</span><span class="p">]</span>
    <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">comment</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="n">schema</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">update_navbar</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Table</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Creates an asset table.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>asset_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the asset table.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>column_defs</code>
            </td>
            <td>
                  <code><span title="typing.Iterable">Iterable</span>[<a class="autorefs autorefs-internal" title="ColumnDefinition


  
      module-attribute
   (deriva_ml.core.definitions.ColumnDefinition)" href="../deriva_definitions/#deriva_ml.core.definitions.ColumnDefinition">ColumnDefinition</a>] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Iterable of ColumnDefinition objects to provide additional metadata for asset.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>fkey_defs</code>
            </td>
            <td>
                  <code><span title="typing.Iterable">Iterable</span>[<a class="autorefs autorefs-internal" title="ColumnDefinition


  
      module-attribute
   (deriva_ml.core.definitions.ColumnDefinition)" href="../deriva_definitions/#deriva_ml.core.definitions.ColumnDefinition">ColumnDefinition</a>] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Iterable of ForeignKeyDefinition objects to provide additional metadata for asset.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>referenced_tables</code>
            </td>
            <td>
                  <code><span title="typing.Iterable">Iterable</span>[<span title="deriva_ml.core.mixins.asset.Table">Table</span>] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Iterable of Table objects to which asset should provide foreign-key references to.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>comment</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Description of the asset table. (Default value = '')</p>
              </div>
            </td>
            <td>
                  <code>&#39;&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>schema</code>
            </td>
            <td>
                  <code><span title="str">str</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Schema in which to create the asset table.  Defaults to domain_schema.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>update_navbar</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True (default), automatically updates the navigation bar to include
the new asset table. Set to False during batch asset creation to avoid redundant
updates, then call apply_catalog_annotations() once at the end.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="deriva_ml.core.mixins.asset.Table">Table</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Table object for the asset table.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/deriva_ml/core/mixins/asset.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">create_asset</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">asset_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">column_defs</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">ColumnDefinition</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">fkey_defs</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">ColumnDefinition</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">referenced_tables</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">Table</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">comment</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="n">schema</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">update_navbar</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Table</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates an asset table.</span>

<span class="sd">    Args:</span>
<span class="sd">        asset_name: Name of the asset table.</span>
<span class="sd">        column_defs: Iterable of ColumnDefinition objects to provide additional metadata for asset.</span>
<span class="sd">        fkey_defs: Iterable of ForeignKeyDefinition objects to provide additional metadata for asset.</span>
<span class="sd">        referenced_tables: Iterable of Table objects to which asset should provide foreign-key references to.</span>
<span class="sd">        comment: Description of the asset table. (Default value = &#39;&#39;)</span>
<span class="sd">        schema: Schema in which to create the asset table.  Defaults to domain_schema.</span>
<span class="sd">        update_navbar: If True (default), automatically updates the navigation bar to include</span>
<span class="sd">            the new asset table. Set to False during batch asset creation to avoid redundant</span>
<span class="sd">            updates, then call apply_catalog_annotations() once at the end.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Table object for the asset table.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Initialize empty collections if None provided</span>
    <span class="n">column_defs</span> <span class="o">=</span> <span class="n">column_defs</span> <span class="ow">or</span> <span class="p">[]</span>
    <span class="n">fkey_defs</span> <span class="o">=</span> <span class="n">fkey_defs</span> <span class="ow">or</span> <span class="p">[]</span>
    <span class="n">referenced_tables</span> <span class="o">=</span> <span class="n">referenced_tables</span> <span class="ow">or</span> <span class="p">[]</span>
    <span class="n">schema</span> <span class="o">=</span> <span class="n">schema</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">_require_default_schema</span><span class="p">()</span>

    <span class="c1"># Add an asset type to vocabulary</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">add_term</span><span class="p">(</span><span class="n">MLVocab</span><span class="o">.</span><span class="n">asset_type</span><span class="p">,</span> <span class="n">asset_name</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;A </span><span class="si">{</span><span class="n">asset_name</span><span class="si">}</span><span class="s2"> asset&quot;</span><span class="p">)</span>

    <span class="c1"># Create the main asset table</span>
    <span class="c1"># Note: column_defs and fkey_defs should be ColumnDef/ForeignKeyDef objects</span>
    <span class="n">asset_table</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">schemas</span><span class="p">[</span><span class="n">schema</span><span class="p">]</span><span class="o">.</span><span class="n">create_table</span><span class="p">(</span>
        <span class="n">AssetTableDef</span><span class="p">(</span>
            <span class="n">schema_name</span><span class="o">=</span><span class="n">schema</span><span class="p">,</span>
            <span class="n">name</span><span class="o">=</span><span class="n">asset_name</span><span class="p">,</span>
            <span class="n">columns</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">column_defs</span><span class="p">),</span>
            <span class="n">foreign_keys</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">fkey_defs</span><span class="p">),</span>
            <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="p">)</span>

    <span class="c1"># Create an association table between asset and asset type</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">create_table</span><span class="p">(</span>
        <span class="n">Table</span><span class="o">.</span><span class="n">define_association</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="p">(</span><span class="n">asset_table</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">asset_table</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;Asset_Type&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">name_to_table</span><span class="p">(</span><span class="s2">&quot;Asset_Type&quot;</span><span class="p">)),</span>
            <span class="p">]</span>
        <span class="p">),</span>
        <span class="n">schema</span><span class="o">=</span><span class="n">schema</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1"># Create references to other tables if specified</span>
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">referenced_tables</span><span class="p">:</span>
        <span class="n">asset_table</span><span class="o">.</span><span class="n">create_reference</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">name_to_table</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>

    <span class="c1"># Create an association table for tracking execution</span>
    <span class="n">atable</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">create_table</span><span class="p">(</span>
        <span class="n">Table</span><span class="o">.</span><span class="n">define_association</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="p">(</span><span class="n">asset_name</span><span class="p">,</span> <span class="n">asset_table</span><span class="p">),</span>
                <span class="p">(</span>
                    <span class="s2">&quot;Execution&quot;</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">schemas</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ml_schema</span><span class="p">]</span><span class="o">.</span><span class="n">tables</span><span class="p">[</span><span class="s2">&quot;Execution&quot;</span><span class="p">],</span>
                <span class="p">),</span>
            <span class="p">]</span>
        <span class="p">),</span>
        <span class="n">schema</span><span class="o">=</span><span class="n">schema</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">atable</span><span class="o">.</span><span class="n">create_reference</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">name_to_table</span><span class="p">(</span><span class="s2">&quot;Asset_Role&quot;</span><span class="p">))</span>

    <span class="c1"># Add asset annotations</span>
    <span class="n">asset_annotation</span><span class="p">(</span><span class="n">asset_table</span><span class="p">)</span>

    <span class="c1"># Update navbar to include the new asset table</span>
    <span class="k">if</span> <span class="n">update_navbar</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">apply_catalog_annotations</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">asset_table</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="deriva_ml.core.DerivaML.create_execution" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">create_execution</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">create_execution</span><span class="p">(</span>
    <span class="n">configuration</span><span class="p">:</span> <span class="n">ExecutionConfiguration</span><span class="p">,</span>
    <span class="n">workflow</span><span class="p">:</span> <span class="s2">&quot;Workflow | RID | None&quot;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">dry_run</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Execution&quot;</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Create an execution environment.</p>
<p>Initializes a local compute environment for executing an ML or analytic routine.
This has several side effects:</p>
<ol>
<li>Downloads datasets specified in the configuration to the cache directory.
   If no version is specified, creates a new minor version for the dataset.</li>
<li>Downloads any execution assets to the working directory.</li>
<li>Creates an execution record in the catalog (unless dry_run=True).</li>
</ol>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>configuration</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="ExecutionConfiguration (deriva_ml.execution.execution_configuration.ExecutionConfiguration)" href="../execution_configuration/#deriva_ml.execution.execution_configuration.ExecutionConfiguration">ExecutionConfiguration</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>ExecutionConfiguration specifying execution parameters.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>workflow</code>
            </td>
            <td>
                  <code>&#39;Workflow | RID | None&#39;</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional Workflow object or RID if not present in configuration.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dry_run</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, skip creating catalog records and uploading results.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>Execution</code></td>            <td>
                  <code>&#39;Execution&#39;</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An execution object for managing the execution lifecycle.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>config = ExecutionConfiguration(
...     workflow=workflow,
...     description="Process samples",
...     datasets=[DatasetSpec(rid="4HM")],
... )
with ml.create_execution(config) as execution:
...     # Run analysis
...     pass
execution.upload_execution_outputs()</p>
</blockquote>
</blockquote>
</blockquote>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/deriva_ml/core/mixins/execution.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">create_execution</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">configuration</span><span class="p">:</span> <span class="n">ExecutionConfiguration</span><span class="p">,</span> <span class="n">workflow</span><span class="p">:</span> <span class="s2">&quot;Workflow | RID | None&quot;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">dry_run</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Execution&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create an execution environment.</span>

<span class="sd">    Initializes a local compute environment for executing an ML or analytic routine.</span>
<span class="sd">    This has several side effects:</span>

<span class="sd">    1. Downloads datasets specified in the configuration to the cache directory.</span>
<span class="sd">       If no version is specified, creates a new minor version for the dataset.</span>
<span class="sd">    2. Downloads any execution assets to the working directory.</span>
<span class="sd">    3. Creates an execution record in the catalog (unless dry_run=True).</span>

<span class="sd">    Args:</span>
<span class="sd">        configuration: ExecutionConfiguration specifying execution parameters.</span>
<span class="sd">        workflow: Optional Workflow object or RID if not present in configuration.</span>
<span class="sd">        dry_run: If True, skip creating catalog records and uploading results.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Execution: An execution object for managing the execution lifecycle.</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; config = ExecutionConfiguration(</span>
<span class="sd">        ...     workflow=workflow,</span>
<span class="sd">        ...     description=&quot;Process samples&quot;,</span>
<span class="sd">        ...     datasets=[DatasetSpec(rid=&quot;4HM&quot;)],</span>
<span class="sd">        ... )</span>
<span class="sd">        &gt;&gt;&gt; with ml.create_execution(config) as execution:</span>
<span class="sd">        ...     # Run analysis</span>
<span class="sd">        ...     pass</span>
<span class="sd">        &gt;&gt;&gt; execution.upload_execution_outputs()</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Import here to avoid circular dependency</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">deriva_ml.execution.execution</span><span class="w"> </span><span class="kn">import</span> <span class="n">Execution</span>

    <span class="c1"># Create and store an execution instance</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_execution</span> <span class="o">=</span> <span class="n">Execution</span><span class="p">(</span><span class="n">configuration</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">workflow</span><span class="o">=</span><span class="n">workflow</span><span class="p">,</span> <span class="n">dry_run</span><span class="o">=</span><span class="n">dry_run</span><span class="p">)</span>  <span class="c1"># type: ignore[arg-type]</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_execution</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="deriva_ml.core.DerivaML.create_feature" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">create_feature</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">create_feature</span><span class="p">(</span>
    <span class="n">target_table</span><span class="p">:</span> <span class="n">Table</span> <span class="o">|</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">feature_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">terms</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Table</span> <span class="o">|</span> <span class="nb">str</span><span class="p">]</span>
    <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">assets</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Table</span> <span class="o">|</span> <span class="nb">str</span><span class="p">]</span>
    <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">metadata</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span>
        <span class="n">ColumnDefinition</span>
        <span class="o">|</span> <span class="n">Table</span>
        <span class="o">|</span> <span class="n">Key</span>
        <span class="o">|</span> <span class="nb">str</span>
    <span class="p">]</span>
    <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">optional</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">comment</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="n">update_navbar</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">type</span><span class="p">[</span><span class="n">FeatureRecord</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Creates a new feature definition.</p>
<p>A feature represents a measurable property or characteristic that can be associated with records in the target
table. Features can include vocabulary terms, asset references, and additional metadata.</p>
<p><strong>Side Effects</strong>:
This method dynamically creates:
1. A new association table in the domain schema to store feature values
2. A Pydantic model class (subclass of FeatureRecord) for creating validated feature instances</p>
<p>The returned Pydantic model class provides type-safe construction of feature records with
automatic validation of values against the feature's definition (vocabulary terms, asset
references, etc.). Use this class to create feature instances that can be inserted into
the catalog.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>target_table</code>
            </td>
            <td>
                  <code><span title="deriva_ml.core.mixins.feature.Table">Table</span> | <span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Table to associate the feature with (name or Table object).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>feature_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Unique name for the feature within the target table.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>terms</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="deriva_ml.core.mixins.feature.Table">Table</span> | <span title="str">str</span>] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional vocabulary tables/names whose terms can be used as feature values.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>assets</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="deriva_ml.core.mixins.feature.Table">Table</span> | <span title="str">str</span>] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional asset tables/names that can be referenced by this feature.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>metadata</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<a class="autorefs autorefs-internal" title="ColumnDefinition


  
      module-attribute
   (deriva_ml.core.definitions.ColumnDefinition)" href="../deriva_definitions/#deriva_ml.core.definitions.ColumnDefinition">ColumnDefinition</a> | <span title="deriva_ml.core.mixins.feature.Table">Table</span> | <span title="deriva_ml.core.mixins.feature.Key">Key</span> | <span title="str">str</span>] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional columns, tables, or keys to include in a feature definition.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>optional</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Column names that are not required when creating feature instances.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>comment</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Description of the feature's purpose and usage.</p>
              </div>
            </td>
            <td>
                  <code>&#39;&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>update_navbar</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True (default), automatically updates the navigation bar to include
the new feature table. Set to False during batch feature creation to avoid
redundant updates, then call apply_catalog_annotations() once at the end.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="type">type</span>[<a class="autorefs autorefs-internal" title="FeatureRecord (deriva_ml.feature.FeatureRecord)" href="../feature/#deriva_ml.feature.FeatureRecord">FeatureRecord</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>type[FeatureRecord]: A dynamically generated Pydantic model class for creating
validated feature instances. The class has fields corresponding to the feature's
terms, assets, and metadata columns.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="DerivaMLException (deriva_ml.core.exceptions.DerivaMLException)" href="../exceptions/#deriva_ml.core.exceptions.DerivaMLException">DerivaMLException</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If a feature definition is invalid or conflicts with existing features.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <p>Create a feature with confidence score:
    &gt;&gt;&gt; DiagnosisFeature = ml.create_feature(
    ...     target_table="Image",
    ...     feature_name="Diagnosis",
    ...     terms=["Diagnosis_Type"],
    ...     metadata=[ColumnDefinition(name="confidence", type=BuiltinTypes.float4)],
    ...     comment="Clinical diagnosis label"
    ... )
    &gt;&gt;&gt; # Use the returned class to create validated feature instances
    &gt;&gt;&gt; record = DiagnosisFeature(
    ...     Image="1-ABC",  # Target record RID
    ...     Diagnosis_Type="Normal",  # Vocabulary term
    ...     confidence=0.95,
    ...     Execution="2-XYZ"  # Execution that produced this value
    ... )</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/deriva_ml/core/mixins/feature.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">create_feature</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">target_table</span><span class="p">:</span> <span class="n">Table</span> <span class="o">|</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">feature_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">terms</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Table</span> <span class="o">|</span> <span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">assets</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Table</span> <span class="o">|</span> <span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">metadata</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">ColumnDefinition</span> <span class="o">|</span> <span class="n">Table</span> <span class="o">|</span> <span class="n">Key</span> <span class="o">|</span> <span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">optional</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">comment</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="n">update_navbar</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">type</span><span class="p">[</span><span class="n">FeatureRecord</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates a new feature definition.</span>

<span class="sd">    A feature represents a measurable property or characteristic that can be associated with records in the target</span>
<span class="sd">    table. Features can include vocabulary terms, asset references, and additional metadata.</span>

<span class="sd">    **Side Effects**:</span>
<span class="sd">    This method dynamically creates:</span>
<span class="sd">    1. A new association table in the domain schema to store feature values</span>
<span class="sd">    2. A Pydantic model class (subclass of FeatureRecord) for creating validated feature instances</span>

<span class="sd">    The returned Pydantic model class provides type-safe construction of feature records with</span>
<span class="sd">    automatic validation of values against the feature&#39;s definition (vocabulary terms, asset</span>
<span class="sd">    references, etc.). Use this class to create feature instances that can be inserted into</span>
<span class="sd">    the catalog.</span>

<span class="sd">    Args:</span>
<span class="sd">        target_table: Table to associate the feature with (name or Table object).</span>
<span class="sd">        feature_name: Unique name for the feature within the target table.</span>
<span class="sd">        terms: Optional vocabulary tables/names whose terms can be used as feature values.</span>
<span class="sd">        assets: Optional asset tables/names that can be referenced by this feature.</span>
<span class="sd">        metadata: Optional columns, tables, or keys to include in a feature definition.</span>
<span class="sd">        optional: Column names that are not required when creating feature instances.</span>
<span class="sd">        comment: Description of the feature&#39;s purpose and usage.</span>
<span class="sd">        update_navbar: If True (default), automatically updates the navigation bar to include</span>
<span class="sd">            the new feature table. Set to False during batch feature creation to avoid</span>
<span class="sd">            redundant updates, then call apply_catalog_annotations() once at the end.</span>

<span class="sd">    Returns:</span>
<span class="sd">        type[FeatureRecord]: A dynamically generated Pydantic model class for creating</span>
<span class="sd">            validated feature instances. The class has fields corresponding to the feature&#39;s</span>
<span class="sd">            terms, assets, and metadata columns.</span>

<span class="sd">    Raises:</span>
<span class="sd">        DerivaMLException: If a feature definition is invalid or conflicts with existing features.</span>

<span class="sd">    Examples:</span>
<span class="sd">        Create a feature with confidence score:</span>
<span class="sd">            &gt;&gt;&gt; DiagnosisFeature = ml.create_feature(</span>
<span class="sd">            ...     target_table=&quot;Image&quot;,</span>
<span class="sd">            ...     feature_name=&quot;Diagnosis&quot;,</span>
<span class="sd">            ...     terms=[&quot;Diagnosis_Type&quot;],</span>
<span class="sd">            ...     metadata=[ColumnDefinition(name=&quot;confidence&quot;, type=BuiltinTypes.float4)],</span>
<span class="sd">            ...     comment=&quot;Clinical diagnosis label&quot;</span>
<span class="sd">            ... )</span>
<span class="sd">            &gt;&gt;&gt; # Use the returned class to create validated feature instances</span>
<span class="sd">            &gt;&gt;&gt; record = DiagnosisFeature(</span>
<span class="sd">            ...     Image=&quot;1-ABC&quot;,  # Target record RID</span>
<span class="sd">            ...     Diagnosis_Type=&quot;Normal&quot;,  # Vocabulary term</span>
<span class="sd">            ...     confidence=0.95,</span>
<span class="sd">            ...     Execution=&quot;2-XYZ&quot;  # Execution that produced this value</span>
<span class="sd">            ... )</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Initialize empty collections if None provided</span>
    <span class="n">terms</span> <span class="o">=</span> <span class="n">terms</span> <span class="ow">or</span> <span class="p">[]</span>
    <span class="n">assets</span> <span class="o">=</span> <span class="n">assets</span> <span class="ow">or</span> <span class="p">[]</span>
    <span class="n">metadata</span> <span class="o">=</span> <span class="n">metadata</span> <span class="ow">or</span> <span class="p">[]</span>
    <span class="n">optional</span> <span class="o">=</span> <span class="n">optional</span> <span class="ow">or</span> <span class="p">[]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">normalize_metadata</span><span class="p">(</span><span class="n">m</span><span class="p">:</span> <span class="n">Key</span> <span class="o">|</span> <span class="n">Table</span> <span class="o">|</span> <span class="n">ColumnDefinition</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Key</span> <span class="o">|</span> <span class="n">Table</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Helper function to normalize metadata references.</span>

<span class="sd">        Handles:</span>
<span class="sd">        - str: Table name, converted to Table object</span>
<span class="sd">        - ColumnDefinition: Dataclass with to_dict() method</span>
<span class="sd">        - dict: Already in dict format (from Column.define())</span>
<span class="sd">        - Key/Table: Passed through unchanged</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">name_to_table</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="c1"># Already a dict (e.g., from Column.define())</span>
            <span class="k">return</span> <span class="n">m</span>
        <span class="k">elif</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="s1">&#39;to_dict&#39;</span><span class="p">):</span>
            <span class="c1"># ColumnDefinition or similar dataclass</span>
            <span class="k">return</span> <span class="n">m</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">m</span>

    <span class="c1"># Validate asset and term tables</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">is_asset</span><span class="p">,</span> <span class="n">assets</span><span class="p">)):</span>
        <span class="k">raise</span> <span class="n">DerivaMLException</span><span class="p">(</span><span class="s2">&quot;Invalid create_feature asset table.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">is_vocabulary</span><span class="p">,</span> <span class="n">terms</span><span class="p">)):</span>
        <span class="k">raise</span> <span class="n">DerivaMLException</span><span class="p">(</span><span class="s2">&quot;Invalid create_feature asset table.&quot;</span><span class="p">)</span>

    <span class="c1"># Get references to required tables</span>
    <span class="n">target_table</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">name_to_table</span><span class="p">(</span><span class="n">target_table</span><span class="p">)</span>
    <span class="n">execution</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">schemas</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ml_schema</span><span class="p">]</span><span class="o">.</span><span class="n">tables</span><span class="p">[</span><span class="s2">&quot;Execution&quot;</span><span class="p">]</span>
    <span class="n">feature_name_table</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">schemas</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ml_schema</span><span class="p">]</span><span class="o">.</span><span class="n">tables</span><span class="p">[</span><span class="s2">&quot;Feature_Name&quot;</span><span class="p">]</span>

    <span class="c1"># Add feature name to vocabulary</span>
    <span class="n">feature_name_term</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_term</span><span class="p">(</span><span class="s2">&quot;Feature_Name&quot;</span><span class="p">,</span> <span class="n">feature_name</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="n">comment</span><span class="p">)</span>
    <span class="n">atable_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Execution_</span><span class="si">{</span><span class="n">target_table</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">feature_name_term</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="c1"># Create an association table implementing the feature</span>
    <span class="n">atable</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">create_table</span><span class="p">(</span>
        <span class="n">target_table</span><span class="o">.</span><span class="n">define_association</span><span class="p">(</span>
            <span class="n">table_name</span><span class="o">=</span><span class="n">atable_name</span><span class="p">,</span>
            <span class="n">associates</span><span class="o">=</span><span class="p">[</span><span class="n">execution</span><span class="p">,</span> <span class="n">target_table</span><span class="p">,</span> <span class="n">feature_name_table</span><span class="p">],</span>
            <span class="n">metadata</span><span class="o">=</span><span class="p">[</span><span class="n">normalize_metadata</span><span class="p">(</span><span class="n">m</span><span class="p">)</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">chain</span><span class="p">(</span><span class="n">assets</span><span class="p">,</span> <span class="n">terms</span><span class="p">,</span> <span class="n">metadata</span><span class="p">)],</span>
            <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="p">)</span>
    <span class="c1"># Configure optional columns and default feature name</span>
    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">optional</span><span class="p">:</span>
        <span class="n">atable</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">alter</span><span class="p">(</span><span class="n">nullok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">atable</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="s2">&quot;Feature_Name&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">alter</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="n">feature_name_term</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

    <span class="c1"># Update navbar to include the new feature table</span>
    <span class="k">if</span> <span class="n">update_navbar</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">apply_catalog_annotations</span><span class="p">()</span>

    <span class="c1"># Return feature record class for creating instances</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">feature_record_class</span><span class="p">(</span><span class="n">target_table</span><span class="p">,</span> <span class="n">feature_name</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="deriva_ml.core.DerivaML.create_table" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">create_table</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">create_table</span><span class="p">(</span>
    <span class="n">table</span><span class="p">:</span> <span class="n">TableDefinition</span><span class="p">,</span>
    <span class="n">schema</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">update_navbar</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Table</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Creates a new table in the domain schema.</p>
<p>Creates a table using the provided TableDefinition object, which specifies the table structure
including columns, keys, and foreign key relationships. The table is created in the domain
schema associated with this DerivaML instance.</p>
<p><strong>Required Classes</strong>:
Import the following classes from deriva_ml to define tables:</p>
<ul>
<li><code>TableDefinition</code>: Defines the complete table structure</li>
<li><code>ColumnDefinition</code>: Defines individual columns with types and constraints</li>
<li><code>KeyDefinition</code>: Defines unique key constraints (optional)</li>
<li><code>ForeignKeyDefinition</code>: Defines foreign key relationships to other tables (optional)</li>
<li><code>BuiltinTypes</code>: Enum of available column data types</li>
</ul>
<p><strong>Available Column Types</strong> (BuiltinTypes enum):
<code>text</code>, <code>int2</code>, <code>int4</code>, <code>int8</code>, <code>float4</code>, <code>float8</code>, <code>boolean</code>,
<code>date</code>, <code>timestamp</code>, <code>timestamptz</code>, <code>json</code>, <code>jsonb</code>, <code>markdown</code>,
<code>ermrest_uri</code>, <code>ermrest_rid</code>, <code>ermrest_rcb</code>, <code>ermrest_rmb</code>,
<code>ermrest_rct</code>, <code>ermrest_rmt</code></p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>table</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="TableDefinition


  
      module-attribute
   (deriva_ml.core.definitions.TableDefinition)" href="../deriva_definitions/#deriva_ml.core.definitions.TableDefinition">TableDefinition</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A TableDefinition object containing the complete specification of the table to create.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>update_navbar</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True (default), automatically updates the navigation bar to include
the new table. Set to False during batch table creation to avoid redundant updates,
then call apply_catalog_annotations() once at the end.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>Table</code></td>            <td>
                  <code><span title="deriva_ml.core.base.Table">Table</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The newly created ERMRest table object.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="DerivaMLException (deriva_ml.core.exceptions.DerivaMLException)" href="../exceptions/#deriva_ml.core.exceptions.DerivaMLException">DerivaMLException</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If table creation fails or the definition is invalid.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <p><strong>Simple table with basic columns</strong>:</p>
<pre><code>&gt;&gt;&gt; from deriva_ml import TableDefinition, ColumnDefinition, BuiltinTypes
&gt;&gt;&gt;
&gt;&gt;&gt; table_def = TableDefinition(
...     name="Experiment",
...     column_defs=[
...         ColumnDefinition(name="Name", type=BuiltinTypes.text, nullok=False),
...         ColumnDefinition(name="Date", type=BuiltinTypes.date),
...         ColumnDefinition(name="Description", type=BuiltinTypes.markdown),
...         ColumnDefinition(name="Score", type=BuiltinTypes.float4),
...     ],
...     comment="Records of experimental runs"
... )
&gt;&gt;&gt; experiment_table = ml.create_table(table_def)
</code></pre>
<p><strong>Table with foreign key to another table</strong>:</p>
<pre><code>&gt;&gt;&gt; from deriva_ml import (
...     TableDefinition, ColumnDefinition, ForeignKeyDefinition, BuiltinTypes
... )
&gt;&gt;&gt;
&gt;&gt;&gt; # Create a Sample table that references Subject
&gt;&gt;&gt; sample_def = TableDefinition(
...     name="Sample",
...     column_defs=[
...         ColumnDefinition(name="Name", type=BuiltinTypes.text, nullok=False),
...         ColumnDefinition(name="Subject", type=BuiltinTypes.text, nullok=False),
...         ColumnDefinition(name="Collection_Date", type=BuiltinTypes.date),
...     ],
...     fkey_defs=[
...         ForeignKeyDefinition(
...             colnames=["Subject"],
...             pk_sname=ml.default_schema,  # Schema of referenced table
...             pk_tname="Subject",          # Name of referenced table
...             pk_colnames=["RID"],         # Column(s) in referenced table
...             on_delete="CASCADE",         # Delete samples when subject deleted
...         )
...     ],
...     comment="Biological samples collected from subjects"
... )
&gt;&gt;&gt; sample_table = ml.create_table(sample_def)
</code></pre>
<p><strong>Table with unique key constraint</strong>:</p>
<pre><code>&gt;&gt;&gt; from deriva_ml import (
...     TableDefinition, ColumnDefinition, KeyDefinition, BuiltinTypes
... )
&gt;&gt;&gt;
&gt;&gt;&gt; protocol_def = TableDefinition(
...     name="Protocol",
...     column_defs=[
...         ColumnDefinition(name="Name", type=BuiltinTypes.text, nullok=False),
...         ColumnDefinition(name="Version", type=BuiltinTypes.text, nullok=False),
...         ColumnDefinition(name="Description", type=BuiltinTypes.markdown),
...     ],
...     key_defs=[
...         KeyDefinition(
...             colnames=["Name", "Version"],
...             constraint_names=[["myschema", "Protocol_Name_Version_key"]],
...             comment="Each protocol name+version must be unique"
...         )
...     ],
...     comment="Experimental protocols with versioning"
... )
&gt;&gt;&gt; protocol_table = ml.create_table(protocol_def)
</code></pre>
<p><strong>Batch creation without navbar updates</strong>:</p>
<pre><code>&gt;&gt;&gt; ml.create_table(table1_def, update_navbar=False)
&gt;&gt;&gt; ml.create_table(table2_def, update_navbar=False)
&gt;&gt;&gt; ml.create_table(table3_def, update_navbar=False)
&gt;&gt;&gt; ml.apply_catalog_annotations()  # Update navbar once at the end
</code></pre>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/deriva_ml/core/base.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">860</span>
<span class="normal">861</span>
<span class="normal">862</span>
<span class="normal">863</span>
<span class="normal">864</span>
<span class="normal">865</span>
<span class="normal">866</span>
<span class="normal">867</span>
<span class="normal">868</span>
<span class="normal">869</span>
<span class="normal">870</span>
<span class="normal">871</span>
<span class="normal">872</span>
<span class="normal">873</span>
<span class="normal">874</span>
<span class="normal">875</span>
<span class="normal">876</span>
<span class="normal">877</span>
<span class="normal">878</span>
<span class="normal">879</span>
<span class="normal">880</span>
<span class="normal">881</span>
<span class="normal">882</span>
<span class="normal">883</span>
<span class="normal">884</span>
<span class="normal">885</span>
<span class="normal">886</span>
<span class="normal">887</span>
<span class="normal">888</span>
<span class="normal">889</span>
<span class="normal">890</span>
<span class="normal">891</span>
<span class="normal">892</span>
<span class="normal">893</span>
<span class="normal">894</span>
<span class="normal">895</span>
<span class="normal">896</span>
<span class="normal">897</span>
<span class="normal">898</span>
<span class="normal">899</span>
<span class="normal">900</span>
<span class="normal">901</span>
<span class="normal">902</span>
<span class="normal">903</span>
<span class="normal">904</span>
<span class="normal">905</span>
<span class="normal">906</span>
<span class="normal">907</span>
<span class="normal">908</span>
<span class="normal">909</span>
<span class="normal">910</span>
<span class="normal">911</span>
<span class="normal">912</span>
<span class="normal">913</span>
<span class="normal">914</span>
<span class="normal">915</span>
<span class="normal">916</span>
<span class="normal">917</span>
<span class="normal">918</span>
<span class="normal">919</span>
<span class="normal">920</span>
<span class="normal">921</span>
<span class="normal">922</span>
<span class="normal">923</span>
<span class="normal">924</span>
<span class="normal">925</span>
<span class="normal">926</span>
<span class="normal">927</span>
<span class="normal">928</span>
<span class="normal">929</span>
<span class="normal">930</span>
<span class="normal">931</span>
<span class="normal">932</span>
<span class="normal">933</span>
<span class="normal">934</span>
<span class="normal">935</span>
<span class="normal">936</span>
<span class="normal">937</span>
<span class="normal">938</span>
<span class="normal">939</span>
<span class="normal">940</span>
<span class="normal">941</span>
<span class="normal">942</span>
<span class="normal">943</span>
<span class="normal">944</span>
<span class="normal">945</span>
<span class="normal">946</span>
<span class="normal">947</span>
<span class="normal">948</span>
<span class="normal">949</span>
<span class="normal">950</span>
<span class="normal">951</span>
<span class="normal">952</span>
<span class="normal">953</span>
<span class="normal">954</span>
<span class="normal">955</span>
<span class="normal">956</span>
<span class="normal">957</span>
<span class="normal">958</span>
<span class="normal">959</span>
<span class="normal">960</span>
<span class="normal">961</span>
<span class="normal">962</span>
<span class="normal">963</span>
<span class="normal">964</span>
<span class="normal">965</span>
<span class="normal">966</span>
<span class="normal">967</span>
<span class="normal">968</span>
<span class="normal">969</span>
<span class="normal">970</span>
<span class="normal">971</span>
<span class="normal">972</span>
<span class="normal">973</span>
<span class="normal">974</span>
<span class="normal">975</span>
<span class="normal">976</span>
<span class="normal">977</span>
<span class="normal">978</span>
<span class="normal">979</span>
<span class="normal">980</span>
<span class="normal">981</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">create_table</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">:</span> <span class="n">TableDefinition</span><span class="p">,</span> <span class="n">schema</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">update_navbar</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Table</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates a new table in the domain schema.</span>

<span class="sd">    Creates a table using the provided TableDefinition object, which specifies the table structure</span>
<span class="sd">    including columns, keys, and foreign key relationships. The table is created in the domain</span>
<span class="sd">    schema associated with this DerivaML instance.</span>

<span class="sd">    **Required Classes**:</span>
<span class="sd">    Import the following classes from deriva_ml to define tables:</span>

<span class="sd">    - ``TableDefinition``: Defines the complete table structure</span>
<span class="sd">    - ``ColumnDefinition``: Defines individual columns with types and constraints</span>
<span class="sd">    - ``KeyDefinition``: Defines unique key constraints (optional)</span>
<span class="sd">    - ``ForeignKeyDefinition``: Defines foreign key relationships to other tables (optional)</span>
<span class="sd">    - ``BuiltinTypes``: Enum of available column data types</span>

<span class="sd">    **Available Column Types** (BuiltinTypes enum):</span>
<span class="sd">    ``text``, ``int2``, ``int4``, ``int8``, ``float4``, ``float8``, ``boolean``,</span>
<span class="sd">    ``date``, ``timestamp``, ``timestamptz``, ``json``, ``jsonb``, ``markdown``,</span>
<span class="sd">    ``ermrest_uri``, ``ermrest_rid``, ``ermrest_rcb``, ``ermrest_rmb``,</span>
<span class="sd">    ``ermrest_rct``, ``ermrest_rmt``</span>

<span class="sd">    Args:</span>
<span class="sd">        table: A TableDefinition object containing the complete specification of the table to create.</span>
<span class="sd">        update_navbar: If True (default), automatically updates the navigation bar to include</span>
<span class="sd">            the new table. Set to False during batch table creation to avoid redundant updates,</span>
<span class="sd">            then call apply_catalog_annotations() once at the end.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Table: The newly created ERMRest table object.</span>

<span class="sd">    Raises:</span>
<span class="sd">        DerivaMLException: If table creation fails or the definition is invalid.</span>

<span class="sd">    Examples:</span>
<span class="sd">        **Simple table with basic columns**:</span>

<span class="sd">            &gt;&gt;&gt; from deriva_ml import TableDefinition, ColumnDefinition, BuiltinTypes</span>
<span class="sd">            &gt;&gt;&gt;</span>
<span class="sd">            &gt;&gt;&gt; table_def = TableDefinition(</span>
<span class="sd">            ...     name=&quot;Experiment&quot;,</span>
<span class="sd">            ...     column_defs=[</span>
<span class="sd">            ...         ColumnDefinition(name=&quot;Name&quot;, type=BuiltinTypes.text, nullok=False),</span>
<span class="sd">            ...         ColumnDefinition(name=&quot;Date&quot;, type=BuiltinTypes.date),</span>
<span class="sd">            ...         ColumnDefinition(name=&quot;Description&quot;, type=BuiltinTypes.markdown),</span>
<span class="sd">            ...         ColumnDefinition(name=&quot;Score&quot;, type=BuiltinTypes.float4),</span>
<span class="sd">            ...     ],</span>
<span class="sd">            ...     comment=&quot;Records of experimental runs&quot;</span>
<span class="sd">            ... )</span>
<span class="sd">            &gt;&gt;&gt; experiment_table = ml.create_table(table_def)</span>

<span class="sd">        **Table with foreign key to another table**:</span>

<span class="sd">            &gt;&gt;&gt; from deriva_ml import (</span>
<span class="sd">            ...     TableDefinition, ColumnDefinition, ForeignKeyDefinition, BuiltinTypes</span>
<span class="sd">            ... )</span>
<span class="sd">            &gt;&gt;&gt;</span>
<span class="sd">            &gt;&gt;&gt; # Create a Sample table that references Subject</span>
<span class="sd">            &gt;&gt;&gt; sample_def = TableDefinition(</span>
<span class="sd">            ...     name=&quot;Sample&quot;,</span>
<span class="sd">            ...     column_defs=[</span>
<span class="sd">            ...         ColumnDefinition(name=&quot;Name&quot;, type=BuiltinTypes.text, nullok=False),</span>
<span class="sd">            ...         ColumnDefinition(name=&quot;Subject&quot;, type=BuiltinTypes.text, nullok=False),</span>
<span class="sd">            ...         ColumnDefinition(name=&quot;Collection_Date&quot;, type=BuiltinTypes.date),</span>
<span class="sd">            ...     ],</span>
<span class="sd">            ...     fkey_defs=[</span>
<span class="sd">            ...         ForeignKeyDefinition(</span>
<span class="sd">            ...             colnames=[&quot;Subject&quot;],</span>
<span class="sd">            ...             pk_sname=ml.default_schema,  # Schema of referenced table</span>
<span class="sd">            ...             pk_tname=&quot;Subject&quot;,          # Name of referenced table</span>
<span class="sd">            ...             pk_colnames=[&quot;RID&quot;],         # Column(s) in referenced table</span>
<span class="sd">            ...             on_delete=&quot;CASCADE&quot;,         # Delete samples when subject deleted</span>
<span class="sd">            ...         )</span>
<span class="sd">            ...     ],</span>
<span class="sd">            ...     comment=&quot;Biological samples collected from subjects&quot;</span>
<span class="sd">            ... )</span>
<span class="sd">            &gt;&gt;&gt; sample_table = ml.create_table(sample_def)</span>

<span class="sd">        **Table with unique key constraint**:</span>

<span class="sd">            &gt;&gt;&gt; from deriva_ml import (</span>
<span class="sd">            ...     TableDefinition, ColumnDefinition, KeyDefinition, BuiltinTypes</span>
<span class="sd">            ... )</span>
<span class="sd">            &gt;&gt;&gt;</span>
<span class="sd">            &gt;&gt;&gt; protocol_def = TableDefinition(</span>
<span class="sd">            ...     name=&quot;Protocol&quot;,</span>
<span class="sd">            ...     column_defs=[</span>
<span class="sd">            ...         ColumnDefinition(name=&quot;Name&quot;, type=BuiltinTypes.text, nullok=False),</span>
<span class="sd">            ...         ColumnDefinition(name=&quot;Version&quot;, type=BuiltinTypes.text, nullok=False),</span>
<span class="sd">            ...         ColumnDefinition(name=&quot;Description&quot;, type=BuiltinTypes.markdown),</span>
<span class="sd">            ...     ],</span>
<span class="sd">            ...     key_defs=[</span>
<span class="sd">            ...         KeyDefinition(</span>
<span class="sd">            ...             colnames=[&quot;Name&quot;, &quot;Version&quot;],</span>
<span class="sd">            ...             constraint_names=[[&quot;myschema&quot;, &quot;Protocol_Name_Version_key&quot;]],</span>
<span class="sd">            ...             comment=&quot;Each protocol name+version must be unique&quot;</span>
<span class="sd">            ...         )</span>
<span class="sd">            ...     ],</span>
<span class="sd">            ...     comment=&quot;Experimental protocols with versioning&quot;</span>
<span class="sd">            ... )</span>
<span class="sd">            &gt;&gt;&gt; protocol_table = ml.create_table(protocol_def)</span>

<span class="sd">        **Batch creation without navbar updates**:</span>

<span class="sd">            &gt;&gt;&gt; ml.create_table(table1_def, update_navbar=False)</span>
<span class="sd">            &gt;&gt;&gt; ml.create_table(table2_def, update_navbar=False)</span>
<span class="sd">            &gt;&gt;&gt; ml.create_table(table3_def, update_navbar=False)</span>
<span class="sd">            &gt;&gt;&gt; ml.apply_catalog_annotations()  # Update navbar once at the end</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Use default schema if none specified</span>
    <span class="n">schema</span> <span class="o">=</span> <span class="n">schema</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">_require_default_schema</span><span class="p">()</span>

    <span class="c1"># Create table in domain schema using provided definition</span>
    <span class="c1"># Handle both TableDefinition (dataclass with to_dict) and plain dicts</span>
    <span class="n">table_dict</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span> <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="s1">&#39;to_dict&#39;</span><span class="p">)</span> <span class="k">else</span> <span class="n">table</span>
    <span class="n">new_table</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">schemas</span><span class="p">[</span><span class="n">schema</span><span class="p">]</span><span class="o">.</span><span class="n">create_table</span><span class="p">(</span><span class="n">table_dict</span><span class="p">)</span>

    <span class="c1"># Update navbar to include the new table</span>
    <span class="k">if</span> <span class="n">update_navbar</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">apply_catalog_annotations</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">new_table</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="deriva_ml.core.DerivaML.create_vocabulary" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">create_vocabulary</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">create_vocabulary</span><span class="p">(</span>
    <span class="n">vocab_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">comment</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="n">schema</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">update_navbar</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Table</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Creates a controlled vocabulary table.</p>
<p>A controlled vocabulary table maintains a list of standardized terms and their definitions. Each term can have
synonyms and descriptions to ensure consistent terminology usage across the dataset.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>vocab_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name for the new vocabulary table. Must be a valid SQL identifier.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>comment</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Description of the vocabulary's purpose and usage. Defaults to empty string.</p>
              </div>
            </td>
            <td>
                  <code>&#39;&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>schema</code>
            </td>
            <td>
                  <code><span title="str">str</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Schema name to create the table in. If None, uses domain_schema.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>update_navbar</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True (default), automatically updates the navigation bar to include
the new vocabulary table. Set to False during batch table creation to avoid
redundant updates, then call apply_catalog_annotations() once at the end.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>Table</code></td>            <td>
                  <code><span title="deriva_ml.core.base.Table">Table</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>ERMRest table object representing the newly created vocabulary table.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="DerivaMLException (deriva_ml.core.exceptions.DerivaMLException)" href="../exceptions/#deriva_ml.core.exceptions.DerivaMLException">DerivaMLException</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If vocab_name is invalid or already exists.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <p>Create a vocabulary for tissue types:</p>
<pre><code>&gt;&gt;&gt; table = ml.create_vocabulary(
...     vocab_name="tissue_types",
...     comment="Standard tissue classifications",
...     schema="bio_schema"
... )
</code></pre>
<p>Create multiple vocabularies without updating navbar until the end:</p>
<pre><code>&gt;&gt;&gt; ml.create_vocabulary("Species", update_navbar=False)
&gt;&gt;&gt; ml.create_vocabulary("Tissue_Type", update_navbar=False)
&gt;&gt;&gt; ml.apply_catalog_annotations()  # Update navbar once
</code></pre>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/deriva_ml/core/base.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span>
<span class="normal">807</span>
<span class="normal">808</span>
<span class="normal">809</span>
<span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span>
<span class="normal">818</span>
<span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span>
<span class="normal">827</span>
<span class="normal">828</span>
<span class="normal">829</span>
<span class="normal">830</span>
<span class="normal">831</span>
<span class="normal">832</span>
<span class="normal">833</span>
<span class="normal">834</span>
<span class="normal">835</span>
<span class="normal">836</span>
<span class="normal">837</span>
<span class="normal">838</span>
<span class="normal">839</span>
<span class="normal">840</span>
<span class="normal">841</span>
<span class="normal">842</span>
<span class="normal">843</span>
<span class="normal">844</span>
<span class="normal">845</span>
<span class="normal">846</span>
<span class="normal">847</span>
<span class="normal">848</span>
<span class="normal">849</span>
<span class="normal">850</span>
<span class="normal">851</span>
<span class="normal">852</span>
<span class="normal">853</span>
<span class="normal">854</span>
<span class="normal">855</span>
<span class="normal">856</span>
<span class="normal">857</span>
<span class="normal">858</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">create_vocabulary</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">vocab_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">comment</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">schema</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">update_navbar</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Table</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates a controlled vocabulary table.</span>

<span class="sd">    A controlled vocabulary table maintains a list of standardized terms and their definitions. Each term can have</span>
<span class="sd">    synonyms and descriptions to ensure consistent terminology usage across the dataset.</span>

<span class="sd">    Args:</span>
<span class="sd">        vocab_name: Name for the new vocabulary table. Must be a valid SQL identifier.</span>
<span class="sd">        comment: Description of the vocabulary&#39;s purpose and usage. Defaults to empty string.</span>
<span class="sd">        schema: Schema name to create the table in. If None, uses domain_schema.</span>
<span class="sd">        update_navbar: If True (default), automatically updates the navigation bar to include</span>
<span class="sd">            the new vocabulary table. Set to False during batch table creation to avoid</span>
<span class="sd">            redundant updates, then call apply_catalog_annotations() once at the end.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Table: ERMRest table object representing the newly created vocabulary table.</span>

<span class="sd">    Raises:</span>
<span class="sd">        DerivaMLException: If vocab_name is invalid or already exists.</span>

<span class="sd">    Examples:</span>
<span class="sd">        Create a vocabulary for tissue types:</span>

<span class="sd">            &gt;&gt;&gt; table = ml.create_vocabulary(</span>
<span class="sd">            ...     vocab_name=&quot;tissue_types&quot;,</span>
<span class="sd">            ...     comment=&quot;Standard tissue classifications&quot;,</span>
<span class="sd">            ...     schema=&quot;bio_schema&quot;</span>
<span class="sd">            ... )</span>

<span class="sd">        Create multiple vocabularies without updating navbar until the end:</span>

<span class="sd">            &gt;&gt;&gt; ml.create_vocabulary(&quot;Species&quot;, update_navbar=False)</span>
<span class="sd">            &gt;&gt;&gt; ml.create_vocabulary(&quot;Tissue_Type&quot;, update_navbar=False)</span>
<span class="sd">            &gt;&gt;&gt; ml.apply_catalog_annotations()  # Update navbar once</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Use default schema if none specified</span>
    <span class="n">schema</span> <span class="o">=</span> <span class="n">schema</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">_require_default_schema</span><span class="p">()</span>

    <span class="c1"># Create and return vocabulary table with RID-based URI pattern</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">vocab_table</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">schemas</span><span class="p">[</span><span class="n">schema</span><span class="p">]</span><span class="o">.</span><span class="n">create_table</span><span class="p">(</span>
            <span class="n">VocabularyTableDef</span><span class="p">(</span>
                <span class="n">name</span><span class="o">=</span><span class="n">vocab_name</span><span class="p">,</span>
                <span class="n">curie_template</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">project_name</span><span class="si">}</span><span class="s2">:</span><span class="se">{{</span><span class="s2">RID</span><span class="se">}}</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span>
    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">DerivaMLException</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Table </span><span class="si">{</span><span class="n">vocab_name</span><span class="si">}</span><span class="s2"> already exist&quot;</span><span class="p">)</span>

    <span class="c1"># Update navbar to include the new vocabulary table</span>
    <span class="k">if</span> <span class="n">update_navbar</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">apply_catalog_annotations</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">vocab_table</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="deriva_ml.core.DerivaML.create_workflow" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">create_workflow</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">create_workflow</span><span class="p">(</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">workflow_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">description</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Workflow</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Creates a new workflow definition.</p>
<p>Creates a Workflow object that represents a computational process or analysis pipeline. The workflow type
must be a term from the controlled vocabulary. This method is typically used to define new analysis
workflows before execution.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the workflow.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>workflow_type</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Type of workflow (must exist in workflow_type vocabulary).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>description</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Description of what the workflow does.</p>
              </div>
            </td>
            <td>
                  <code>&#39;&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>Workflow</code></td>            <td>
                  <code><a class="autorefs autorefs-internal" title="Workflow (deriva_ml.execution.workflow.Workflow)" href="../workflow/#deriva_ml.execution.workflow.Workflow">Workflow</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>New workflow object ready for registration.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="DerivaMLException (deriva_ml.core.exceptions.DerivaMLException)" href="../exceptions/#deriva_ml.core.exceptions.DerivaMLException">DerivaMLException</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If workflow_type is not in the vocabulary.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">workflow</span> <span class="o">=</span> <span class="n">ml</span><span class="o">.</span><span class="n">create_workflow</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;RNA Analysis&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">workflow_type</span><span class="o">=</span><span class="s2">&quot;python_notebook&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;RNA sequence analysis pipeline&quot;</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rid</span> <span class="o">=</span> <span class="n">ml</span><span class="o">.</span><span class="n">add_workflow</span><span class="p">(</span><span class="n">workflow</span><span class="p">)</span>
</code></pre></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/deriva_ml/core/mixins/workflow.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">create_workflow</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">workflow_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">description</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Workflow</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates a new workflow definition.</span>

<span class="sd">    Creates a Workflow object that represents a computational process or analysis pipeline. The workflow type</span>
<span class="sd">    must be a term from the controlled vocabulary. This method is typically used to define new analysis</span>
<span class="sd">    workflows before execution.</span>

<span class="sd">    Args:</span>
<span class="sd">        name: Name of the workflow.</span>
<span class="sd">        workflow_type: Type of workflow (must exist in workflow_type vocabulary).</span>
<span class="sd">        description: Description of what the workflow does.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Workflow: New workflow object ready for registration.</span>

<span class="sd">    Raises:</span>
<span class="sd">        DerivaMLException: If workflow_type is not in the vocabulary.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; workflow = ml.create_workflow(</span>
<span class="sd">        ...     name=&quot;RNA Analysis&quot;,</span>
<span class="sd">        ...     workflow_type=&quot;python_notebook&quot;,</span>
<span class="sd">        ...     description=&quot;RNA sequence analysis pipeline&quot;</span>
<span class="sd">        ... )</span>
<span class="sd">        &gt;&gt;&gt; rid = ml.add_workflow(workflow)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Validate workflow type exists in vocabulary</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">lookup_term</span><span class="p">(</span><span class="n">MLVocab</span><span class="o">.</span><span class="n">workflow_type</span><span class="p">,</span> <span class="n">workflow_type</span><span class="p">)</span>

    <span class="c1"># Create and return a new workflow object</span>
    <span class="k">return</span> <span class="n">Workflow</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">workflow_type</span><span class="o">=</span><span class="n">workflow_type</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="n">description</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="deriva_ml.core.DerivaML.delete_dataset" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">delete_dataset</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">delete_dataset</span><span class="p">(</span>
    <span class="n">dataset</span><span class="p">:</span> <span class="s2">&quot;Dataset&quot;</span><span class="p">,</span>
    <span class="n">recurse</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Delete a dataset from the catalog.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>dataset</code>
            </td>
            <td>
                  <code>&#39;Dataset&#39;</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The dataset to delete.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>recurse</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, delete the dataset along with any nested datasets. (Default value = False)</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/deriva_ml/core/mixins/dataset.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">delete_dataset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset</span><span class="p">:</span> <span class="s2">&quot;Dataset&quot;</span><span class="p">,</span> <span class="n">recurse</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Delete a dataset from the catalog.</span>

<span class="sd">    Args:</span>
<span class="sd">        dataset: The dataset to delete.</span>
<span class="sd">        recurse: If True, delete the dataset along with any nested datasets. (Default value = False)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Get association table entries for this dataset_table</span>
    <span class="c1"># Delete association table entries</span>
    <span class="n">dataset_rid</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">dataset_rid</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">is_dataset_rid</span><span class="p">(</span><span class="n">dataset</span><span class="o">.</span><span class="n">dataset_rid</span><span class="p">):</span>
        <span class="k">raise</span> <span class="n">DerivaMLException</span><span class="p">(</span><span class="s2">&quot;Dataset_rid is not a dataset.&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">parents</span> <span class="o">:=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">list_dataset_parents</span><span class="p">():</span>
        <span class="k">raise</span> <span class="n">DerivaMLException</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Dataset &quot;</span><span class="si">{</span><span class="n">dataset</span><span class="si">}</span><span class="s1">&quot; is in a nested dataset: </span><span class="si">{</span><span class="n">parents</span><span class="si">}</span><span class="s1">.&#39;</span><span class="p">)</span>

    <span class="n">pb</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pathBuilder</span><span class="p">()</span>
    <span class="n">dataset_path</span> <span class="o">=</span> <span class="n">pb</span><span class="o">.</span><span class="n">schemas</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_dataset_table</span><span class="o">.</span><span class="n">schema</span><span class="o">.</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">tables</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_dataset_table</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>

    <span class="c1"># list_dataset_children returns Dataset objects, so extract their RIDs</span>
    <span class="n">child_rids</span> <span class="o">=</span> <span class="p">[</span><span class="n">ds</span><span class="o">.</span><span class="n">dataset_rid</span> <span class="k">for</span> <span class="n">ds</span> <span class="ow">in</span> <span class="n">dataset</span><span class="o">.</span><span class="n">list_dataset_children</span><span class="p">()]</span> <span class="k">if</span> <span class="n">recurse</span> <span class="k">else</span> <span class="p">[]</span>
    <span class="n">rid_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">dataset_rid</span><span class="p">]</span> <span class="o">+</span> <span class="n">child_rids</span>
    <span class="n">dataset_path</span><span class="o">.</span><span class="n">update</span><span class="p">([{</span><span class="s2">&quot;RID&quot;</span><span class="p">:</span> <span class="n">r</span><span class="p">,</span> <span class="s2">&quot;Deleted&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">}</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">rid_list</span><span class="p">])</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="deriva_ml.core.DerivaML.delete_feature" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">delete_feature</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">delete_feature</span><span class="p">(</span>
    <span class="n">table</span><span class="p">:</span> <span class="n">Table</span> <span class="o">|</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">feature_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Removes a feature definition and its data.</p>
<p>Deletes the feature and its implementation table from the catalog. This operation cannot be undone and
will remove all feature values associated with this feature.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>table</code>
            </td>
            <td>
                  <code><span title="deriva_ml.core.mixins.feature.Table">Table</span> | <span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The table containing the feature, either as name or Table object.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>feature_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the feature to delete.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>bool</code></td>            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True if the feature was successfully deleted, False if it didn't exist.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="DerivaMLException (deriva_ml.core.exceptions.DerivaMLException)" href="../exceptions/#deriva_ml.core.exceptions.DerivaMLException">DerivaMLException</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If deletion fails due to constraints or permissions.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>success = ml.delete_feature("samples", "obsolete_feature")
print("Deleted" if success else "Not found")</p>
</blockquote>
</blockquote>
</blockquote>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/deriva_ml/core/mixins/feature.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">delete_feature</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">:</span> <span class="n">Table</span> <span class="o">|</span> <span class="nb">str</span><span class="p">,</span> <span class="n">feature_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Removes a feature definition and its data.</span>

<span class="sd">    Deletes the feature and its implementation table from the catalog. This operation cannot be undone and</span>
<span class="sd">    will remove all feature values associated with this feature.</span>

<span class="sd">    Args:</span>
<span class="sd">        table: The table containing the feature, either as name or Table object.</span>
<span class="sd">        feature_name: Name of the feature to delete.</span>

<span class="sd">    Returns:</span>
<span class="sd">        bool: True if the feature was successfully deleted, False if it didn&#39;t exist.</span>

<span class="sd">    Raises:</span>
<span class="sd">        DerivaMLException: If deletion fails due to constraints or permissions.</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; success = ml.delete_feature(&quot;samples&quot;, &quot;obsolete_feature&quot;)</span>
<span class="sd">        &gt;&gt;&gt; print(&quot;Deleted&quot; if success else &quot;Not found&quot;)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Get table reference and find feature</span>
    <span class="n">table</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">name_to_table</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Find and delete the feature&#39;s implementation table</span>
        <span class="n">feature</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">f</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">find_features</span><span class="p">(</span><span class="n">table</span><span class="p">)</span> <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">feature_name</span> <span class="o">==</span> <span class="n">feature_name</span><span class="p">)</span>
        <span class="n">feature</span><span class="o">.</span><span class="n">feature_table</span><span class="o">.</span><span class="n">drop</span><span class="p">()</span>
        <span class="k">return</span> <span class="kc">True</span>
    <span class="k">except</span> <span class="ne">StopIteration</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="deriva_ml.core.DerivaML.delete_term" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">delete_term</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">delete_term</span><span class="p">(</span>
    <span class="n">table</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Table</span><span class="p">,</span> <span class="n">term_name</span><span class="p">:</span> <span class="nb">str</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Delete a term from a vocabulary table.</p>
<p>Removes a term from the vocabulary. The term must not be in use by any
records in the catalog (e.g., no datasets using this dataset type, no
assets using this asset type).</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>table</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <span title="deriva_ml.core.mixins.vocabulary.Table">Table</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Vocabulary table containing the term (name or Table object).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>term_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Primary name of the term to delete.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="DerivaMLInvalidTerm (deriva_ml.core.exceptions.DerivaMLInvalidTerm)" href="../exceptions/#deriva_ml.core.exceptions.DerivaMLInvalidTerm">DerivaMLInvalidTerm</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the term doesn't exist in the vocabulary.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="DerivaMLException (deriva_ml.core.exceptions.DerivaMLException)" href="../exceptions/#deriva_ml.core.exceptions.DerivaMLException">DerivaMLException</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the term is currently in use by other records.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>ml.delete_term("Dataset_Type", "Obsolete_Type")</p>
</blockquote>
</blockquote>
</blockquote>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/deriva_ml/core/mixins/vocabulary.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="n">ConfigDict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="k">def</span><span class="w"> </span><span class="nf">delete_term</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Table</span><span class="p">,</span> <span class="n">term_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Delete a term from a vocabulary table.</span>

<span class="sd">    Removes a term from the vocabulary. The term must not be in use by any</span>
<span class="sd">    records in the catalog (e.g., no datasets using this dataset type, no</span>
<span class="sd">    assets using this asset type).</span>

<span class="sd">    Args:</span>
<span class="sd">        table: Vocabulary table containing the term (name or Table object).</span>
<span class="sd">        term_name: Primary name of the term to delete.</span>

<span class="sd">    Raises:</span>
<span class="sd">        DerivaMLInvalidTerm: If the term doesn&#39;t exist in the vocabulary.</span>
<span class="sd">        DerivaMLException: If the term is currently in use by other records.</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; ml.delete_term(&quot;Dataset_Type&quot;, &quot;Obsolete_Type&quot;)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Look up the term (validates table and term existence)</span>
    <span class="n">term</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lookup_term</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">term_name</span><span class="p">)</span>
    <span class="n">vocab_table</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">name_to_table</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>

    <span class="c1"># Check if the term is in use by examining association tables</span>
    <span class="n">associations</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">vocab_table</span><span class="o">.</span><span class="n">find_associations</span><span class="p">())</span>
    <span class="n">pb</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pathBuilder</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">assoc</span> <span class="ow">in</span> <span class="n">associations</span><span class="p">:</span>
        <span class="n">assoc_path</span> <span class="o">=</span> <span class="n">pb</span><span class="o">.</span><span class="n">schemas</span><span class="p">[</span><span class="n">assoc</span><span class="o">.</span><span class="n">schema</span><span class="o">.</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">tables</span><span class="p">[</span><span class="n">assoc</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
        <span class="c1"># Check if any rows reference this term</span>
        <span class="n">count</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">assoc_path</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">assoc_path</span><span class="p">,</span> <span class="n">vocab_table</span><span class="o">.</span><span class="n">name</span><span class="p">)</span> <span class="o">==</span> <span class="n">term</span><span class="o">.</span><span class="n">name</span><span class="p">)</span><span class="o">.</span><span class="n">entities</span><span class="p">()</span><span class="o">.</span><span class="n">fetch</span><span class="p">()))</span>
        <span class="k">if</span> <span class="n">count</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DerivaMLException</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Cannot delete term &#39;</span><span class="si">{</span><span class="n">term_name</span><span class="si">}</span><span class="s2">&#39; from </span><span class="si">{</span><span class="n">vocab_table</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">: &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;it is referenced by </span><span class="si">{</span><span class="n">count</span><span class="si">}</span><span class="s2"> record(s) in </span><span class="si">{</span><span class="n">assoc</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>

    <span class="c1"># No references found - safe to delete</span>
    <span class="n">table_path</span> <span class="o">=</span> <span class="n">pb</span><span class="o">.</span><span class="n">schemas</span><span class="p">[</span><span class="n">vocab_table</span><span class="o">.</span><span class="n">schema</span><span class="o">.</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">tables</span><span class="p">[</span><span class="n">vocab_table</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
    <span class="n">table_path</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">table_path</span><span class="o">.</span><span class="n">RID</span> <span class="o">==</span> <span class="n">term</span><span class="o">.</span><span class="n">rid</span><span class="p">)</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>

    <span class="c1"># Invalidate cache</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">clear_vocabulary_cache</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="deriva_ml.core.DerivaML.domain_path" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">domain_path</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">domain_path</span><span class="p">(</span>
    <span class="n">schema</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">datapath</span><span class="o">.</span><span class="n">DataPath</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Returns path builder for a domain schema.</p>
<p>Provides a convenient way to access tables and construct queries within a domain-specific schema.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>schema</code>
            </td>
            <td>
                  <code><span title="str">str</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Schema name to get path builder for. If None, uses default_schema.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="deriva_ml.core.mixins.path_builder.datapath.DataPath">DataPath</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>datapath._CatalogWrapper: Path builder object scoped to the specified domain schema.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="DerivaMLException (deriva_ml.core.exceptions.DerivaMLException)" href="../exceptions/#deriva_ml.core.exceptions.DerivaMLException">DerivaMLException</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If no schema specified and default_schema is not set.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>domain = ml.domain_path()  # Uses default schema
results = domain.my_table.entities().fetch()</p>
<h4 id="deriva_ml.core.DerivaML.domain_path--or-with-explicit-schema">Or with explicit schema:</h4>
<p>domain = ml.domain_path("my_schema")</p>
</blockquote>
</blockquote>
</blockquote>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/deriva_ml/core/mixins/path_builder.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">domain_path</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">schema</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">datapath</span><span class="o">.</span><span class="n">DataPath</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns path builder for a domain schema.</span>

<span class="sd">    Provides a convenient way to access tables and construct queries within a domain-specific schema.</span>

<span class="sd">    Args:</span>
<span class="sd">        schema: Schema name to get path builder for. If None, uses default_schema.</span>

<span class="sd">    Returns:</span>
<span class="sd">        datapath._CatalogWrapper: Path builder object scoped to the specified domain schema.</span>

<span class="sd">    Raises:</span>
<span class="sd">        DerivaMLException: If no schema specified and default_schema is not set.</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; domain = ml.domain_path()  # Uses default schema</span>
<span class="sd">        &gt;&gt;&gt; results = domain.my_table.entities().fetch()</span>
<span class="sd">        &gt;&gt;&gt; # Or with explicit schema:</span>
<span class="sd">        &gt;&gt;&gt; domain = ml.domain_path(&quot;my_schema&quot;)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">schema</span> <span class="o">=</span> <span class="n">schema</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">_require_default_schema</span><span class="p">()</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">pathBuilder</span><span class="p">()</span><span class="o">.</span><span class="n">schemas</span><span class="p">[</span><span class="n">schema</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="deriva_ml.core.DerivaML.download_dataset_bag" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">download_dataset_bag</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">download_dataset_bag</span><span class="p">(</span>
    <span class="n">dataset</span><span class="p">:</span> <span class="n">DatasetSpec</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;DatasetBag&quot;</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Downloads a dataset to the local filesystem.</p>
<p>Downloads a dataset specified by DatasetSpec to the local filesystem. If the catalog
has s3_bucket configured and use_minid is enabled, the bag will be uploaded to S3
and registered with the MINID service.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>dataset</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="DatasetSpec (deriva_ml.dataset.aux_classes.DatasetSpec)" href="../dataset_aux_classes/#deriva_ml.dataset.aux_classes.DatasetSpec">DatasetSpec</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Specification of the dataset to download, including version and materialization options.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>DatasetBag</code></td>            <td>
                  <code>&#39;DatasetBag&#39;</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Object containing:
- path: Local filesystem path to downloaded dataset
- rid: Dataset's Resource Identifier
- minid: Dataset's Minimal Viable Identifier (if MINID enabled)</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Note</summary>
  <p>MINID support requires s3_bucket to be configured when creating the DerivaML instance.
The catalog's use_minid setting controls whether MINIDs are created.</p>
</details>

<p><span class="doc-section-title">Examples:</span></p>
    <p>Download with default options:
    &gt;&gt;&gt; spec = DatasetSpec(rid="1-abc123")
    &gt;&gt;&gt; bag = ml.download_dataset_bag(dataset=spec)
    &gt;&gt;&gt; print(f"Downloaded to {bag.path}")</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/deriva_ml/core/mixins/dataset.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">download_dataset_bag</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">dataset</span><span class="p">:</span> <span class="n">DatasetSpec</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;DatasetBag&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Downloads a dataset to the local filesystem.</span>

<span class="sd">    Downloads a dataset specified by DatasetSpec to the local filesystem. If the catalog</span>
<span class="sd">    has s3_bucket configured and use_minid is enabled, the bag will be uploaded to S3</span>
<span class="sd">    and registered with the MINID service.</span>

<span class="sd">    Args:</span>
<span class="sd">        dataset: Specification of the dataset to download, including version and materialization options.</span>

<span class="sd">    Returns:</span>
<span class="sd">        DatasetBag: Object containing:</span>
<span class="sd">            - path: Local filesystem path to downloaded dataset</span>
<span class="sd">            - rid: Dataset&#39;s Resource Identifier</span>
<span class="sd">            - minid: Dataset&#39;s Minimal Viable Identifier (if MINID enabled)</span>

<span class="sd">    Note:</span>
<span class="sd">        MINID support requires s3_bucket to be configured when creating the DerivaML instance.</span>
<span class="sd">        The catalog&#39;s use_minid setting controls whether MINIDs are created.</span>

<span class="sd">    Examples:</span>
<span class="sd">        Download with default options:</span>
<span class="sd">            &gt;&gt;&gt; spec = DatasetSpec(rid=&quot;1-abc123&quot;)</span>
<span class="sd">            &gt;&gt;&gt; bag = ml.download_dataset_bag(dataset=spec)</span>
<span class="sd">            &gt;&gt;&gt; print(f&quot;Downloaded to {bag.path}&quot;)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">is_dataset_rid</span><span class="p">(</span><span class="n">dataset</span><span class="o">.</span><span class="n">rid</span><span class="p">):</span>
        <span class="k">raise</span> <span class="n">DerivaMLTableTypeError</span><span class="p">(</span><span class="s2">&quot;Dataset&quot;</span><span class="p">,</span> <span class="n">dataset</span><span class="o">.</span><span class="n">rid</span><span class="p">)</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lookup_dataset</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ds</span><span class="o">.</span><span class="n">download_dataset_bag</span><span class="p">(</span>
        <span class="n">version</span><span class="o">=</span><span class="n">dataset</span><span class="o">.</span><span class="n">version</span><span class="p">,</span>
        <span class="n">materialize</span><span class="o">=</span><span class="n">dataset</span><span class="o">.</span><span class="n">materialize</span><span class="p">,</span>
        <span class="n">use_minid</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">use_minid</span><span class="p">,</span>
        <span class="n">exclude_tables</span><span class="o">=</span><span class="n">dataset</span><span class="o">.</span><span class="n">exclude_tables</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="deriva_ml.core.DerivaML.download_dir" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">download_dir</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">download_dir</span><span class="p">(</span>
    <span class="n">cached</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Path</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Returns the appropriate download directory.</p>
<p>Provides the appropriate directory path for storing downloaded files, either in the cache or working directory.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>cached</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, returns the cache directory path. If False, returns the working directory path.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>Path</code></td>            <td>
                  <code><span title="pathlib.Path">Path</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Directory path where downloaded files should be stored.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>cache_dir = ml.download_dir(cached=True)
work_dir = ml.download_dir(cached=False)</p>
</blockquote>
</blockquote>
</blockquote>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/deriva_ml/core/base.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">download_dir</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cached</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Path</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns the appropriate download directory.</span>

<span class="sd">    Provides the appropriate directory path for storing downloaded files, either in the cache or working directory.</span>

<span class="sd">    Args:</span>
<span class="sd">        cached: If True, returns the cache directory path. If False, returns the working directory path.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Path: Directory path where downloaded files should be stored.</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; cache_dir = ml.download_dir(cached=True)</span>
<span class="sd">        &gt;&gt;&gt; work_dir = ml.download_dir(cached=False)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Return cache directory if cached=True, otherwise working directory</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">cache_dir</span> <span class="k">if</span> <span class="n">cached</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">working_dir</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="deriva_ml.core.DerivaML.feature_record_class" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">feature_record_class</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">feature_record_class</span><span class="p">(</span>
    <span class="n">table</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Table</span><span class="p">,</span>
    <span class="n">feature_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">type</span><span class="p">[</span><span class="n">FeatureRecord</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Returns a dynamically generated Pydantic model class for creating feature records.</p>
<p>Each feature has a unique set of columns based on its definition (terms, assets, metadata).
This method returns a Pydantic class with fields corresponding to those columns, providing:</p>
<ul>
<li><strong>Type validation</strong>: Values are validated against expected types (str, int, float, Path)</li>
<li><strong>Required field checking</strong>: Non-nullable columns must be provided</li>
<li><strong>Default values</strong>: Feature_Name is pre-filled with the feature's name</li>
</ul>
<p><strong>Field types in the generated class:</strong>
- <code>{TargetTable}</code> (str): Required. RID of the target record (e.g., Image RID)
- <code>Execution</code> (str, optional): RID of the execution for provenance tracking
- <code>Feature_Name</code> (str): Pre-filled with the feature name
- Term columns (str): Accept vocabulary term names
- Asset columns (str | Path): Accept asset RIDs or file paths
- Value columns: Accept values matching the column type (int, float, str)</p>
<p>Use <code>lookup_feature()</code> to inspect the feature's structure and see what columns
are available.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>table</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <span title="deriva_ml.core.mixins.feature.Table">Table</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The table containing the feature, either as name or Table object.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>feature_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the feature to create a record class for.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="type">type</span>[<a class="autorefs autorefs-internal" title="FeatureRecord (deriva_ml.feature.FeatureRecord)" href="../feature/#deriva_ml.feature.FeatureRecord">FeatureRecord</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>type[FeatureRecord]: A Pydantic model class for creating validated feature records.
The class name follows the pattern <code>{TargetTable}Feature{FeatureName}</code>.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="DerivaMLException (deriva_ml.core.exceptions.DerivaMLException)" href="../exceptions/#deriva_ml.core.exceptions.DerivaMLException">DerivaMLException</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the feature doesn't exist or the table is invalid.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<h4 id="deriva_ml.core.DerivaML.feature_record_class--get-the-dynamically-generated-class">Get the dynamically generated class</h4>
<p>DiagnosisFeature = ml.feature_record_class("Image", "Diagnosis")</p>
<h4 id="deriva_ml.core.DerivaML.feature_record_class--create-a-validated-feature-record">Create a validated feature record</h4>
<p>record = DiagnosisFeature(
...     Image="1-ABC",           # Target record RID
...     Diagnosis_Type="Normal", # Vocabulary term
...     confidence=0.95,         # Metadata column
...     Execution="2-XYZ"        # Provenance
... )</p>
<h4 id="deriva_ml.core.DerivaML.feature_record_class--convert-to-dict-for-insertion">Convert to dict for insertion</h4>
<p>record.model_dump()
{'Image': '1-ABC', 'Diagnosis_Type': 'Normal', 'confidence': 0.95, ...}</p>
</blockquote>
</blockquote>
</blockquote>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/deriva_ml/core/mixins/feature.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">feature_record_class</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Table</span><span class="p">,</span> <span class="n">feature_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">type</span><span class="p">[</span><span class="n">FeatureRecord</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns a dynamically generated Pydantic model class for creating feature records.</span>

<span class="sd">    Each feature has a unique set of columns based on its definition (terms, assets, metadata).</span>
<span class="sd">    This method returns a Pydantic class with fields corresponding to those columns, providing:</span>

<span class="sd">    - **Type validation**: Values are validated against expected types (str, int, float, Path)</span>
<span class="sd">    - **Required field checking**: Non-nullable columns must be provided</span>
<span class="sd">    - **Default values**: Feature_Name is pre-filled with the feature&#39;s name</span>

<span class="sd">    **Field types in the generated class:**</span>
<span class="sd">    - `{TargetTable}` (str): Required. RID of the target record (e.g., Image RID)</span>
<span class="sd">    - `Execution` (str, optional): RID of the execution for provenance tracking</span>
<span class="sd">    - `Feature_Name` (str): Pre-filled with the feature name</span>
<span class="sd">    - Term columns (str): Accept vocabulary term names</span>
<span class="sd">    - Asset columns (str | Path): Accept asset RIDs or file paths</span>
<span class="sd">    - Value columns: Accept values matching the column type (int, float, str)</span>

<span class="sd">    Use `lookup_feature()` to inspect the feature&#39;s structure and see what columns</span>
<span class="sd">    are available.</span>

<span class="sd">    Args:</span>
<span class="sd">        table: The table containing the feature, either as name or Table object.</span>
<span class="sd">        feature_name: Name of the feature to create a record class for.</span>

<span class="sd">    Returns:</span>
<span class="sd">        type[FeatureRecord]: A Pydantic model class for creating validated feature records.</span>
<span class="sd">            The class name follows the pattern `{TargetTable}Feature{FeatureName}`.</span>

<span class="sd">    Raises:</span>
<span class="sd">        DerivaMLException: If the feature doesn&#39;t exist or the table is invalid.</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; # Get the dynamically generated class</span>
<span class="sd">        &gt;&gt;&gt; DiagnosisFeature = ml.feature_record_class(&quot;Image&quot;, &quot;Diagnosis&quot;)</span>
<span class="sd">        &gt;&gt;&gt;</span>
<span class="sd">        &gt;&gt;&gt; # Create a validated feature record</span>
<span class="sd">        &gt;&gt;&gt; record = DiagnosisFeature(</span>
<span class="sd">        ...     Image=&quot;1-ABC&quot;,           # Target record RID</span>
<span class="sd">        ...     Diagnosis_Type=&quot;Normal&quot;, # Vocabulary term</span>
<span class="sd">        ...     confidence=0.95,         # Metadata column</span>
<span class="sd">        ...     Execution=&quot;2-XYZ&quot;        # Provenance</span>
<span class="sd">        ... )</span>
<span class="sd">        &gt;&gt;&gt;</span>
<span class="sd">        &gt;&gt;&gt; # Convert to dict for insertion</span>
<span class="sd">        &gt;&gt;&gt; record.model_dump()</span>
<span class="sd">        {&#39;Image&#39;: &#39;1-ABC&#39;, &#39;Diagnosis_Type&#39;: &#39;Normal&#39;, &#39;confidence&#39;: 0.95, ...}</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Look up a feature and return its record class</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">lookup_feature</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">feature_name</span><span class="p">)</span><span class="o">.</span><span class="n">feature_record_class</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="deriva_ml.core.DerivaML.find_assets" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">find_assets</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">find_assets</span><span class="p">(</span>
    <span class="n">asset_table</span><span class="p">:</span> <span class="n">Table</span>
    <span class="o">|</span> <span class="nb">str</span>
    <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">asset_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterable</span><span class="p">[</span><span class="s2">&quot;Asset&quot;</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Find assets in the catalog.</p>
<p>Returns an iterable of Asset objects matching the specified criteria.
If no criteria are specified, returns all assets from all asset tables.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>asset_table</code>
            </td>
            <td>
                  <code><span title="deriva_ml.core.mixins.asset.Table">Table</span> | <span title="str">str</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional table or table name to search. If None, searches
all asset tables.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>asset_type</code>
            </td>
            <td>
                  <code><span title="str">str</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional asset type to filter by. Only returns assets
with this type.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Iterable">Iterable</span>[&#39;Asset&#39;]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Iterable of Asset objects matching the criteria.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<h4 id="deriva_ml.core.DerivaML.find_assets--find-all-assets-in-the-model-table">Find all assets in the Model table</h4>
<p>models = list(ml.find_assets(asset_table="Model"))</p>
<h4 id="deriva_ml.core.DerivaML.find_assets--find-all-assets-with-type-training_data">Find all assets with type "Training_Data"</h4>
<p>training = list(ml.find_assets(asset_type="Training_Data"))</p>
<h4 id="deriva_ml.core.DerivaML.find_assets--find-all-assets-across-all-tables">Find all assets across all tables</h4>
<p>all_assets = list(ml.find_assets())</p>
</blockquote>
</blockquote>
</blockquote>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/deriva_ml/core/mixins/asset.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">find_assets</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">asset_table</span><span class="p">:</span> <span class="n">Table</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">asset_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterable</span><span class="p">[</span><span class="s2">&quot;Asset&quot;</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Find assets in the catalog.</span>

<span class="sd">    Returns an iterable of Asset objects matching the specified criteria.</span>
<span class="sd">    If no criteria are specified, returns all assets from all asset tables.</span>

<span class="sd">    Args:</span>
<span class="sd">        asset_table: Optional table or table name to search. If None, searches</span>
<span class="sd">            all asset tables.</span>
<span class="sd">        asset_type: Optional asset type to filter by. Only returns assets</span>
<span class="sd">            with this type.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Iterable of Asset objects matching the criteria.</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; # Find all assets in the Model table</span>
<span class="sd">        &gt;&gt;&gt; models = list(ml.find_assets(asset_table=&quot;Model&quot;))</span>

<span class="sd">        &gt;&gt;&gt; # Find all assets with type &quot;Training_Data&quot;</span>
<span class="sd">        &gt;&gt;&gt; training = list(ml.find_assets(asset_type=&quot;Training_Data&quot;))</span>

<span class="sd">        &gt;&gt;&gt; # Find all assets across all tables</span>
<span class="sd">        &gt;&gt;&gt; all_assets = list(ml.find_assets())</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Determine which tables to search</span>
    <span class="k">if</span> <span class="n">asset_table</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">tables</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">name_to_table</span><span class="p">(</span><span class="n">asset_table</span><span class="p">)]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">tables</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">list_asset_tables</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">table</span> <span class="ow">in</span> <span class="n">tables</span><span class="p">:</span>
        <span class="c1"># Get all assets from this table (now returns Asset objects)</span>
        <span class="k">for</span> <span class="n">asset</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">list_assets</span><span class="p">(</span><span class="n">table</span><span class="p">):</span>
            <span class="c1"># Filter by asset type if specified</span>
            <span class="k">if</span> <span class="n">asset_type</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">asset_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">asset</span><span class="o">.</span><span class="n">asset_types</span><span class="p">:</span>
                    <span class="k">continue</span>
            <span class="k">yield</span> <span class="n">asset</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="deriva_ml.core.DerivaML.find_datasets" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">find_datasets</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">find_datasets</span><span class="p">(</span>
    <span class="n">deleted</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterable</span><span class="p">[</span><span class="s2">&quot;Dataset&quot;</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>List all datasets in the catalog.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>deleted</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, include datasets that have been marked as deleted.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Iterable">Iterable</span>[&#39;Dataset&#39;]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Iterable of Dataset objects.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>datasets = list(ml.find_datasets())
for ds in datasets:
...     print(f"{ds.dataset_rid}: {ds.description}")</p>
</blockquote>
</blockquote>
</blockquote>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/deriva_ml/core/mixins/dataset.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">find_datasets</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">deleted</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterable</span><span class="p">[</span><span class="s2">&quot;Dataset&quot;</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;List all datasets in the catalog.</span>

<span class="sd">    Args:</span>
<span class="sd">        deleted: If True, include datasets that have been marked as deleted.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Iterable of Dataset objects.</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; datasets = list(ml.find_datasets())</span>
<span class="sd">        &gt;&gt;&gt; for ds in datasets:</span>
<span class="sd">        ...     print(f&quot;{ds.dataset_rid}: {ds.description}&quot;)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Import here to avoid circular imports</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">deriva_ml.dataset.dataset</span><span class="w"> </span><span class="kn">import</span> <span class="n">Dataset</span>

    <span class="c1"># Get datapath to the Dataset table</span>
    <span class="n">pb</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pathBuilder</span><span class="p">()</span>
    <span class="n">dataset_path</span> <span class="o">=</span> <span class="n">pb</span><span class="o">.</span><span class="n">schemas</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_dataset_table</span><span class="o">.</span><span class="n">schema</span><span class="o">.</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">tables</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_dataset_table</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">deleted</span><span class="p">:</span>
        <span class="n">filtered_path</span> <span class="o">=</span> <span class="n">dataset_path</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">filtered_path</span> <span class="o">=</span> <span class="n">dataset_path</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
            <span class="p">(</span><span class="n">dataset_path</span><span class="o">.</span><span class="n">Deleted</span> <span class="o">==</span> <span class="kc">False</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">dataset_path</span><span class="o">.</span><span class="n">Deleted</span> <span class="o">==</span> <span class="kc">None</span><span class="p">)</span>  <span class="c1"># noqa: E711, E712</span>
        <span class="p">)</span>

    <span class="c1"># Create Dataset objects - dataset_types is now a property that fetches from catalog</span>
    <span class="n">datasets</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">dataset</span> <span class="ow">in</span> <span class="n">filtered_path</span><span class="o">.</span><span class="n">entities</span><span class="p">()</span><span class="o">.</span><span class="n">fetch</span><span class="p">():</span>
        <span class="n">datasets</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">Dataset</span><span class="p">(</span>
                <span class="bp">self</span><span class="p">,</span>  <span class="c1"># type: ignore[arg-type]</span>
                <span class="n">dataset_rid</span><span class="o">=</span><span class="n">dataset</span><span class="p">[</span><span class="s2">&quot;RID&quot;</span><span class="p">],</span>
                <span class="n">description</span><span class="o">=</span><span class="n">dataset</span><span class="p">[</span><span class="s2">&quot;Description&quot;</span><span class="p">],</span>
            <span class="p">)</span>
        <span class="p">)</span>
    <span class="k">return</span> <span class="n">datasets</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="deriva_ml.core.DerivaML.find_executions" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">find_executions</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">find_executions</span><span class="p">(</span>
    <span class="n">workflow</span><span class="p">:</span> <span class="s2">&quot;Workflow | RID | None&quot;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">workflow_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">status</span><span class="p">:</span> <span class="n">Status</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterable</span><span class="p">[</span><span class="s2">&quot;ExecutionRecord&quot;</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>List all executions in the catalog.</p>
<p>Returns ExecutionRecord objects for each execution. These provide access
to execution metadata and allow updating mutable properties.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>workflow</code>
            </td>
            <td>
                  <code>&#39;Workflow | RID | None&#39;</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional Workflow object or RID to filter by.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>workflow_type</code>
            </td>
            <td>
                  <code><span title="str">str</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional workflow type name to filter by (e.g., "python_script").
This filters by the Workflow_Type vocabulary term.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>status</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Status (deriva_ml.core.enums.Status)" href="../deriva_definitions/#deriva_ml.core.definitions.Status">Status</a> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional status to filter by (e.g., Status.completed).</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Iterable">Iterable</span>[&#39;ExecutionRecord&#39;]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Iterable of ExecutionRecord objects.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <p>List all executions::</p>
<pre><code>&gt;&gt;&gt; for record in ml.find_executions():
...     print(f"{record.execution_rid}: {record.status}")
</code></pre>
<p>Filter by status::</p>
<pre><code>&gt;&gt;&gt; completed = list(ml.find_executions(status=Status.completed))
</code></pre>
<p>Filter by specific workflow::</p>
<pre><code>&gt;&gt;&gt; workflow = ml.lookup_workflow("2-ABC1")
&gt;&gt;&gt; for record in ml.find_executions(workflow=workflow):
...     print(f"{record.execution_rid}: {record.description}")
</code></pre>
<p>Filter by workflow type (all notebooks)::</p>
<pre><code>&gt;&gt;&gt; notebooks = list(ml.find_executions(workflow_type="python_notebook"))
</code></pre>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/deriva_ml/core/mixins/execution.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">find_executions</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">workflow</span><span class="p">:</span> <span class="s2">&quot;Workflow | RID | None&quot;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">workflow_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">status</span><span class="p">:</span> <span class="n">Status</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterable</span><span class="p">[</span><span class="s2">&quot;ExecutionRecord&quot;</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;List all executions in the catalog.</span>

<span class="sd">    Returns ExecutionRecord objects for each execution. These provide access</span>
<span class="sd">    to execution metadata and allow updating mutable properties.</span>

<span class="sd">    Args:</span>
<span class="sd">        workflow: Optional Workflow object or RID to filter by.</span>
<span class="sd">        workflow_type: Optional workflow type name to filter by (e.g., &quot;python_script&quot;).</span>
<span class="sd">            This filters by the Workflow_Type vocabulary term.</span>
<span class="sd">        status: Optional status to filter by (e.g., Status.completed).</span>

<span class="sd">    Returns:</span>
<span class="sd">        Iterable of ExecutionRecord objects.</span>

<span class="sd">    Example:</span>
<span class="sd">        List all executions::</span>

<span class="sd">            &gt;&gt;&gt; for record in ml.find_executions():</span>
<span class="sd">            ...     print(f&quot;{record.execution_rid}: {record.status}&quot;)</span>

<span class="sd">        Filter by status::</span>

<span class="sd">            &gt;&gt;&gt; completed = list(ml.find_executions(status=Status.completed))</span>

<span class="sd">        Filter by specific workflow::</span>

<span class="sd">            &gt;&gt;&gt; workflow = ml.lookup_workflow(&quot;2-ABC1&quot;)</span>
<span class="sd">            &gt;&gt;&gt; for record in ml.find_executions(workflow=workflow):</span>
<span class="sd">            ...     print(f&quot;{record.execution_rid}: {record.description}&quot;)</span>

<span class="sd">        Filter by workflow type (all notebooks)::</span>

<span class="sd">            &gt;&gt;&gt; notebooks = list(ml.find_executions(workflow_type=&quot;python_notebook&quot;))</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Import for type checking</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">deriva_ml.execution.workflow</span><span class="w"> </span><span class="kn">import</span> <span class="n">Workflow</span> <span class="k">as</span> <span class="n">WorkflowClass</span>

    <span class="c1"># Get datapath to the Execution table</span>
    <span class="n">pb</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pathBuilder</span><span class="p">()</span>
    <span class="n">execution_path</span> <span class="o">=</span> <span class="n">pb</span><span class="o">.</span><span class="n">schemas</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ml_schema</span><span class="p">]</span><span class="o">.</span><span class="n">Execution</span>

    <span class="c1"># Apply filters</span>
    <span class="n">filtered_path</span> <span class="o">=</span> <span class="n">execution_path</span>

    <span class="c1"># Filter by specific workflow</span>
    <span class="k">if</span> <span class="n">workflow</span><span class="p">:</span>
        <span class="n">workflow_rid</span> <span class="o">=</span> <span class="n">workflow</span><span class="o">.</span><span class="n">rid</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">workflow</span><span class="p">,</span> <span class="n">WorkflowClass</span><span class="p">)</span> <span class="k">else</span> <span class="n">workflow</span>
        <span class="n">filtered_path</span> <span class="o">=</span> <span class="n">filtered_path</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">execution_path</span><span class="o">.</span><span class="n">Workflow</span> <span class="o">==</span> <span class="n">workflow_rid</span><span class="p">)</span>

    <span class="c1"># Filter by workflow type - need to join with Workflow table</span>
    <span class="k">if</span> <span class="n">workflow_type</span><span class="p">:</span>
        <span class="n">workflow_path</span> <span class="o">=</span> <span class="n">pb</span><span class="o">.</span><span class="n">schemas</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ml_schema</span><span class="p">]</span><span class="o">.</span><span class="n">Workflow</span>
        <span class="c1"># Link to workflows with matching type</span>
        <span class="n">filtered_path</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">filtered_path</span>
            <span class="o">.</span><span class="n">link</span><span class="p">(</span><span class="n">workflow_path</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="p">(</span><span class="n">execution_path</span><span class="o">.</span><span class="n">Workflow</span> <span class="o">==</span> <span class="n">workflow_path</span><span class="o">.</span><span class="n">RID</span><span class="p">))</span>
            <span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">workflow_path</span><span class="o">.</span><span class="n">Workflow_Type</span> <span class="o">==</span> <span class="n">workflow_type</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="n">status</span><span class="p">:</span>
        <span class="n">filtered_path</span> <span class="o">=</span> <span class="n">filtered_path</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">execution_path</span><span class="o">.</span><span class="n">Status</span> <span class="o">==</span> <span class="n">status</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>

    <span class="c1"># Create ExecutionRecord objects</span>
    <span class="k">for</span> <span class="n">exec_record</span> <span class="ow">in</span> <span class="n">filtered_path</span><span class="o">.</span><span class="n">entities</span><span class="p">()</span><span class="o">.</span><span class="n">fetch</span><span class="p">():</span>
        <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">lookup_execution</span><span class="p">(</span><span class="n">exec_record</span><span class="p">[</span><span class="s2">&quot;RID&quot;</span><span class="p">])</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="deriva_ml.core.DerivaML.find_experiments" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">find_experiments</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">find_experiments</span><span class="p">(</span>
    <span class="n">workflow_rid</span><span class="p">:</span> <span class="n">RID</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">status</span><span class="p">:</span> <span class="n">Status</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterable</span><span class="p">[</span><span class="s2">&quot;Experiment&quot;</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>List all experiments (executions with Hydra configuration) in the catalog.</p>
<p>Creates Experiment objects for analyzing completed ML model runs.
Only returns executions that have Hydra configuration metadata
(i.e., a config.yaml file in Execution_Metadata assets).</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>workflow_rid</code>
            </td>
            <td>
                  <code><span title="deriva_ml.core.definitions.RID">RID</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional workflow RID to filter by.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>status</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Status (deriva_ml.core.enums.Status)" href="../deriva_definitions/#deriva_ml.core.definitions.Status">Status</a> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional status to filter by (e.g., Status.Completed).</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Iterable">Iterable</span>[&#39;Experiment&#39;]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Iterable of Experiment objects for executions with Hydra config.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>experiments = list(ml.find_experiments(status=Status.Completed))
for exp in experiments:
...     print(f"{exp.name}: {exp.config_choices}")</p>
</blockquote>
</blockquote>
</blockquote>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/deriva_ml/core/mixins/execution.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">find_experiments</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">workflow_rid</span><span class="p">:</span> <span class="n">RID</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">status</span><span class="p">:</span> <span class="n">Status</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterable</span><span class="p">[</span><span class="s2">&quot;Experiment&quot;</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;List all experiments (executions with Hydra configuration) in the catalog.</span>

<span class="sd">    Creates Experiment objects for analyzing completed ML model runs.</span>
<span class="sd">    Only returns executions that have Hydra configuration metadata</span>
<span class="sd">    (i.e., a config.yaml file in Execution_Metadata assets).</span>

<span class="sd">    Args:</span>
<span class="sd">        workflow_rid: Optional workflow RID to filter by.</span>
<span class="sd">        status: Optional status to filter by (e.g., Status.Completed).</span>

<span class="sd">    Returns:</span>
<span class="sd">        Iterable of Experiment objects for executions with Hydra config.</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; experiments = list(ml.find_experiments(status=Status.Completed))</span>
<span class="sd">        &gt;&gt;&gt; for exp in experiments:</span>
<span class="sd">        ...     print(f&quot;{exp.name}: {exp.config_choices}&quot;)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">re</span>

    <span class="kn">from</span><span class="w"> </span><span class="nn">deriva_ml.experiment</span><span class="w"> </span><span class="kn">import</span> <span class="n">Experiment</span>

    <span class="c1"># Get datapath to tables</span>
    <span class="n">pb</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pathBuilder</span><span class="p">()</span>
    <span class="n">execution_path</span> <span class="o">=</span> <span class="n">pb</span><span class="o">.</span><span class="n">schemas</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ml_schema</span><span class="p">]</span><span class="o">.</span><span class="n">Execution</span>
    <span class="n">metadata_path</span> <span class="o">=</span> <span class="n">pb</span><span class="o">.</span><span class="n">schemas</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ml_schema</span><span class="p">]</span><span class="o">.</span><span class="n">Execution_Metadata</span>
    <span class="n">meta_exec_path</span> <span class="o">=</span> <span class="n">pb</span><span class="o">.</span><span class="n">schemas</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ml_schema</span><span class="p">]</span><span class="o">.</span><span class="n">Execution_Metadata_Execution</span>

    <span class="c1"># Find executions that have metadata assets with config.yaml files</span>
    <span class="c1"># Query the association table to find executions with hydra config metadata</span>
    <span class="n">exec_rids_with_config</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>

    <span class="c1"># Get all metadata records and filter for config.yaml files in Python</span>
    <span class="c1"># (ERMrest regex support varies by deployment)</span>
    <span class="n">config_pattern</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;.*-config\.yaml$&quot;</span><span class="p">)</span>
    <span class="n">config_metadata_rids</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">meta</span> <span class="ow">in</span> <span class="n">metadata_path</span><span class="o">.</span><span class="n">entities</span><span class="p">()</span><span class="o">.</span><span class="n">fetch</span><span class="p">():</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="n">meta</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Filename&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">filename</span> <span class="ow">and</span> <span class="n">config_pattern</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
            <span class="n">config_metadata_rids</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">meta</span><span class="p">[</span><span class="s2">&quot;RID&quot;</span><span class="p">])</span>

    <span class="k">if</span> <span class="n">config_metadata_rids</span><span class="p">:</span>
        <span class="c1"># Query the association table to find which executions have these metadata</span>
        <span class="k">for</span> <span class="n">assoc_record</span> <span class="ow">in</span> <span class="n">meta_exec_path</span><span class="o">.</span><span class="n">entities</span><span class="p">()</span><span class="o">.</span><span class="n">fetch</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">assoc_record</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Execution_Metadata&quot;</span><span class="p">)</span> <span class="ow">in</span> <span class="n">config_metadata_rids</span><span class="p">:</span>
                <span class="n">exec_rids_with_config</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">assoc_record</span><span class="p">[</span><span class="s2">&quot;Execution&quot;</span><span class="p">])</span>

    <span class="c1"># Apply additional filters and yield Experiment objects</span>
    <span class="n">filtered_path</span> <span class="o">=</span> <span class="n">execution_path</span>
    <span class="k">if</span> <span class="n">workflow_rid</span><span class="p">:</span>
        <span class="n">filtered_path</span> <span class="o">=</span> <span class="n">filtered_path</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">execution_path</span><span class="o">.</span><span class="n">Workflow</span> <span class="o">==</span> <span class="n">workflow_rid</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">status</span><span class="p">:</span>
        <span class="n">filtered_path</span> <span class="o">=</span> <span class="n">filtered_path</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">execution_path</span><span class="o">.</span><span class="n">Status</span> <span class="o">==</span> <span class="n">status</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">exec_record</span> <span class="ow">in</span> <span class="n">filtered_path</span><span class="o">.</span><span class="n">entities</span><span class="p">()</span><span class="o">.</span><span class="n">fetch</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">exec_record</span><span class="p">[</span><span class="s2">&quot;RID&quot;</span><span class="p">]</span> <span class="ow">in</span> <span class="n">exec_rids_with_config</span><span class="p">:</span>
            <span class="k">yield</span> <span class="n">Experiment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exec_record</span><span class="p">[</span><span class="s2">&quot;RID&quot;</span><span class="p">])</span>  <span class="c1"># type: ignore[arg-type]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="deriva_ml.core.DerivaML.find_features" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">find_features</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">find_features</span><span class="p">(</span>
    <span class="n">table</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Table</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Feature</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Find features in the catalog.</p>
<p>Catalog-level operation to find feature definitions. If a table is specified,
returns only features for that table. If no table is specified, returns all
features across all tables in the catalog.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>table</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <span title="deriva_ml.core.mixins.feature.Table">Table</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional table to find features for. If None, returns all features
in the catalog.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<a class="autorefs autorefs-internal" title="Feature (deriva_ml.feature.Feature)" href="../feature/#deriva_ml.feature.Feature">Feature</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of Feature instances describing the features.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <p>Find all features in the catalog:
    &gt;&gt;&gt; all_features = ml.find_features()
    &gt;&gt;&gt; for f in all_features:
    ...     print(f"{f.target_table.name}.{f.feature_name}")</p>
<p>Find features for a specific table:
    &gt;&gt;&gt; image_features = ml.find_features("Image")
    &gt;&gt;&gt; print([f.feature_name for f in image_features])</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/deriva_ml/core/mixins/feature.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">find_features</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Table</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Feature</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Find features in the catalog.</span>

<span class="sd">    Catalog-level operation to find feature definitions. If a table is specified,</span>
<span class="sd">    returns only features for that table. If no table is specified, returns all</span>
<span class="sd">    features across all tables in the catalog.</span>

<span class="sd">    Args:</span>
<span class="sd">        table: Optional table to find features for. If None, returns all features</span>
<span class="sd">            in the catalog.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A list of Feature instances describing the features.</span>

<span class="sd">    Examples:</span>
<span class="sd">        Find all features in the catalog:</span>
<span class="sd">            &gt;&gt;&gt; all_features = ml.find_features()</span>
<span class="sd">            &gt;&gt;&gt; for f in all_features:</span>
<span class="sd">            ...     print(f&quot;{f.target_table.name}.{f.feature_name}&quot;)</span>

<span class="sd">        Find features for a specific table:</span>
<span class="sd">            &gt;&gt;&gt; image_features = ml.find_features(&quot;Image&quot;)</span>
<span class="sd">            &gt;&gt;&gt; print([f.feature_name for f in image_features])</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">find_features</span><span class="p">(</span><span class="n">table</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="deriva_ml.core.DerivaML.find_workflows" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">find_workflows</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">find_workflows</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Workflow</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Find all workflows in the catalog.</p>
<p>Catalog-level operation to find all workflow definitions, including their
names, URLs, types, versions, and descriptions. Each returned Workflow
is bound to the catalog, allowing its description to be updated.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<a class="autorefs autorefs-internal" title="Workflow (deriva_ml.execution.workflow.Workflow)" href="../workflow/#deriva_ml.execution.workflow.Workflow">Workflow</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>list[Workflow]: List of workflow objects, each containing:
- name: Workflow name
- url: Source code URL
- workflow_type: Type of workflow
- version: Version identifier
- description: Workflow description
- rid: Resource identifier
- checksum: Source code checksum</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <p>List all workflows and their descriptions::</p>
<pre><code>&gt;&gt;&gt; workflows = ml.find_workflows()
&gt;&gt;&gt; for w in workflows:
...     print(f"{w.name} (v{w.version}): {w.description}")
...     print(f"  Source: {w.url}")
</code></pre>
<p>Update a workflow's description (workflows are catalog-bound)::</p>
<pre><code>&gt;&gt;&gt; workflows = ml.find_workflows()
&gt;&gt;&gt; workflows[0].description = "Updated description"
</code></pre>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/deriva_ml/core/mixins/workflow.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">find_workflows</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Workflow</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Find all workflows in the catalog.</span>

<span class="sd">    Catalog-level operation to find all workflow definitions, including their</span>
<span class="sd">    names, URLs, types, versions, and descriptions. Each returned Workflow</span>
<span class="sd">    is bound to the catalog, allowing its description to be updated.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list[Workflow]: List of workflow objects, each containing:</span>
<span class="sd">            - name: Workflow name</span>
<span class="sd">            - url: Source code URL</span>
<span class="sd">            - workflow_type: Type of workflow</span>
<span class="sd">            - version: Version identifier</span>
<span class="sd">            - description: Workflow description</span>
<span class="sd">            - rid: Resource identifier</span>
<span class="sd">            - checksum: Source code checksum</span>

<span class="sd">    Examples:</span>
<span class="sd">        List all workflows and their descriptions::</span>

<span class="sd">            &gt;&gt;&gt; workflows = ml.find_workflows()</span>
<span class="sd">            &gt;&gt;&gt; for w in workflows:</span>
<span class="sd">            ...     print(f&quot;{w.name} (v{w.version}): {w.description}&quot;)</span>
<span class="sd">            ...     print(f&quot;  Source: {w.url}&quot;)</span>

<span class="sd">        Update a workflow&#39;s description (workflows are catalog-bound)::</span>

<span class="sd">            &gt;&gt;&gt; workflows = ml.find_workflows()</span>
<span class="sd">            &gt;&gt;&gt; workflows[0].description = &quot;Updated description&quot;</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Get a workflow table path and fetch all workflows</span>
    <span class="n">workflow_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pathBuilder</span><span class="p">()</span><span class="o">.</span><span class="n">schemas</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ml_schema</span><span class="p">]</span><span class="o">.</span><span class="n">Workflow</span>
    <span class="n">workflows</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">workflow_path</span><span class="o">.</span><span class="n">entities</span><span class="p">()</span><span class="o">.</span><span class="n">fetch</span><span class="p">():</span>
        <span class="n">workflow</span> <span class="o">=</span> <span class="n">Workflow</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="n">w</span><span class="p">[</span><span class="s2">&quot;Name&quot;</span><span class="p">],</span>
            <span class="n">url</span><span class="o">=</span><span class="n">w</span><span class="p">[</span><span class="s2">&quot;URL&quot;</span><span class="p">],</span>
            <span class="n">workflow_type</span><span class="o">=</span><span class="n">w</span><span class="p">[</span><span class="s2">&quot;Workflow_Type&quot;</span><span class="p">],</span>
            <span class="n">version</span><span class="o">=</span><span class="n">w</span><span class="p">[</span><span class="s2">&quot;Version&quot;</span><span class="p">],</span>
            <span class="n">description</span><span class="o">=</span><span class="n">w</span><span class="p">[</span><span class="s2">&quot;Description&quot;</span><span class="p">],</span>
            <span class="n">rid</span><span class="o">=</span><span class="n">w</span><span class="p">[</span><span class="s2">&quot;RID&quot;</span><span class="p">],</span>
            <span class="n">checksum</span><span class="o">=</span><span class="n">w</span><span class="p">[</span><span class="s2">&quot;Checksum&quot;</span><span class="p">],</span>
        <span class="p">)</span>
        <span class="c1"># Bind the workflow to this catalog instance</span>
        <span class="n">workflow</span><span class="o">.</span><span class="n">_ml_instance</span> <span class="o">=</span> <span class="bp">self</span>  <span class="c1"># type: ignore[assignment]</span>
        <span class="n">workflows</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">workflow</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">workflows</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="deriva_ml.core.DerivaML.get_cache_size" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">get_cache_size</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_cache_size</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span>
    <span class="nb">str</span><span class="p">,</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">float</span>
<span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Get the current size of the cache directory.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="int">int</span> | <span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dict with keys:
- 'total_bytes': Total size in bytes
- 'total_mb': Total size in megabytes
- 'file_count': Number of files
- 'dir_count': Number of directories</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>ml = DerivaML('deriva.example.org', 'my_catalog')
size = ml.get_cache_size()
print(f"Cache size: {size['total_mb']:.1f} MB ({size['file_count']} files)")</p>
</blockquote>
</blockquote>
</blockquote>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/deriva_ml/core/base.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1055</span>
<span class="normal">1056</span>
<span class="normal">1057</span>
<span class="normal">1058</span>
<span class="normal">1059</span>
<span class="normal">1060</span>
<span class="normal">1061</span>
<span class="normal">1062</span>
<span class="normal">1063</span>
<span class="normal">1064</span>
<span class="normal">1065</span>
<span class="normal">1066</span>
<span class="normal">1067</span>
<span class="normal">1068</span>
<span class="normal">1069</span>
<span class="normal">1070</span>
<span class="normal">1071</span>
<span class="normal">1072</span>
<span class="normal">1073</span>
<span class="normal">1074</span>
<span class="normal">1075</span>
<span class="normal">1076</span>
<span class="normal">1077</span>
<span class="normal">1078</span>
<span class="normal">1079</span>
<span class="normal">1080</span>
<span class="normal">1081</span>
<span class="normal">1082</span>
<span class="normal">1083</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_cache_size</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">float</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the current size of the cache directory.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict with keys:</span>
<span class="sd">            - &#39;total_bytes&#39;: Total size in bytes</span>
<span class="sd">            - &#39;total_mb&#39;: Total size in megabytes</span>
<span class="sd">            - &#39;file_count&#39;: Number of files</span>
<span class="sd">            - &#39;dir_count&#39;: Number of directories</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; ml = DerivaML(&#39;deriva.example.org&#39;, &#39;my_catalog&#39;)</span>
<span class="sd">        &gt;&gt;&gt; size = ml.get_cache_size()</span>
<span class="sd">        &gt;&gt;&gt; print(f&quot;Cache size: {size[&#39;total_mb&#39;]:.1f} MB ({size[&#39;file_count&#39;]} files)&quot;)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">stats</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;total_bytes&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;total_mb&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;file_count&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;dir_count&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">}</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">cache_dir</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
        <span class="k">return</span> <span class="n">stats</span>

    <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cache_dir</span><span class="o">.</span><span class="n">rglob</span><span class="p">(</span><span class="s1">&#39;*&#39;</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">entry</span><span class="o">.</span><span class="n">is_file</span><span class="p">():</span>
            <span class="n">stats</span><span class="p">[</span><span class="s1">&#39;total_bytes&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">entry</span><span class="o">.</span><span class="n">stat</span><span class="p">()</span><span class="o">.</span><span class="n">st_size</span>
            <span class="n">stats</span><span class="p">[</span><span class="s1">&#39;file_count&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">elif</span> <span class="n">entry</span><span class="o">.</span><span class="n">is_dir</span><span class="p">():</span>
            <span class="n">stats</span><span class="p">[</span><span class="s1">&#39;dir_count&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="n">stats</span><span class="p">[</span><span class="s1">&#39;total_mb&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">stats</span><span class="p">[</span><span class="s1">&#39;total_bytes&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1024</span> <span class="o">*</span> <span class="mi">1024</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">stats</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="deriva_ml.core.DerivaML.get_column_annotations" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">get_column_annotations</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_column_annotations</span><span class="p">(</span>
    <span class="n">table</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Table</span><span class="p">,</span> <span class="n">column_name</span><span class="p">:</span> <span class="nb">str</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Get all display-related annotations for a column.</p>
<p>Returns the current values of display and column-display annotations
for the specified column.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>table</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <span title="deriva_ml.core.mixins.annotation.Table">Table</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Table name or Table object containing the column.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>column_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the column.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary with keys: table, column, display, column_display.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Missing annotations are None.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>annotations = ml.get_column_annotations("Image", "Filename")
print(annotations["display"])</p>
</blockquote>
</blockquote>
</blockquote>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/deriva_ml/core/mixins/annotation.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="n">ConfigDict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="k">def</span><span class="w"> </span><span class="nf">get_column_annotations</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Table</span><span class="p">,</span> <span class="n">column_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get all display-related annotations for a column.</span>

<span class="sd">    Returns the current values of display and column-display annotations</span>
<span class="sd">    for the specified column.</span>

<span class="sd">    Args:</span>
<span class="sd">        table: Table name or Table object containing the column.</span>
<span class="sd">        column_name: Name of the column.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dictionary with keys: table, column, display, column_display.</span>
<span class="sd">        Missing annotations are None.</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; annotations = ml.get_column_annotations(&quot;Image&quot;, &quot;Filename&quot;)</span>
<span class="sd">        &gt;&gt;&gt; print(annotations[&quot;display&quot;])</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">table_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">name_to_table</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>
    <span class="n">column</span> <span class="o">=</span> <span class="n">table_obj</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">column_name</span><span class="p">]</span>
    <span class="k">return</span> <span class="p">{</span>
        <span class="s2">&quot;table&quot;</span><span class="p">:</span> <span class="n">table_obj</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
        <span class="s2">&quot;column&quot;</span><span class="p">:</span> <span class="n">column</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
        <span class="s2">&quot;display&quot;</span><span class="p">:</span> <span class="n">column</span><span class="o">.</span><span class="n">annotations</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">DISPLAY_TAG</span><span class="p">),</span>
        <span class="s2">&quot;column_display&quot;</span><span class="p">:</span> <span class="n">column</span><span class="o">.</span><span class="n">annotations</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">COLUMN_DISPLAY_TAG</span><span class="p">),</span>
    <span class="p">}</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="deriva_ml.core.DerivaML.get_handlebars_template_variables" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">get_handlebars_template_variables</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_handlebars_template_variables</span><span class="p">(</span>
    <span class="n">table</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Table</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Get all available template variables for a table.</p>
<p>Returns the columns, foreign keys, and special variables that can be
used in Handlebars templates (row_markdown_pattern, markdown_pattern, etc.)
for the specified table.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>table</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <span title="deriva_ml.core.mixins.annotation.Table">Table</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Table name or Table object.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary with columns, foreign_keys, special_variables, and helper_examples.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>vars = ml.get_handlebars_template_variables("Image")
for col in vars["columns"]:
...     print(f"{col['name']}: {col['template']}")</p>
</blockquote>
</blockquote>
</blockquote>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/deriva_ml/core/mixins/annotation.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">832</span>
<span class="normal">833</span>
<span class="normal">834</span>
<span class="normal">835</span>
<span class="normal">836</span>
<span class="normal">837</span>
<span class="normal">838</span>
<span class="normal">839</span>
<span class="normal">840</span>
<span class="normal">841</span>
<span class="normal">842</span>
<span class="normal">843</span>
<span class="normal">844</span>
<span class="normal">845</span>
<span class="normal">846</span>
<span class="normal">847</span>
<span class="normal">848</span>
<span class="normal">849</span>
<span class="normal">850</span>
<span class="normal">851</span>
<span class="normal">852</span>
<span class="normal">853</span>
<span class="normal">854</span>
<span class="normal">855</span>
<span class="normal">856</span>
<span class="normal">857</span>
<span class="normal">858</span>
<span class="normal">859</span>
<span class="normal">860</span>
<span class="normal">861</span>
<span class="normal">862</span>
<span class="normal">863</span>
<span class="normal">864</span>
<span class="normal">865</span>
<span class="normal">866</span>
<span class="normal">867</span>
<span class="normal">868</span>
<span class="normal">869</span>
<span class="normal">870</span>
<span class="normal">871</span>
<span class="normal">872</span>
<span class="normal">873</span>
<span class="normal">874</span>
<span class="normal">875</span>
<span class="normal">876</span>
<span class="normal">877</span>
<span class="normal">878</span>
<span class="normal">879</span>
<span class="normal">880</span>
<span class="normal">881</span>
<span class="normal">882</span>
<span class="normal">883</span>
<span class="normal">884</span>
<span class="normal">885</span>
<span class="normal">886</span>
<span class="normal">887</span>
<span class="normal">888</span>
<span class="normal">889</span>
<span class="normal">890</span>
<span class="normal">891</span>
<span class="normal">892</span>
<span class="normal">893</span>
<span class="normal">894</span>
<span class="normal">895</span>
<span class="normal">896</span>
<span class="normal">897</span>
<span class="normal">898</span>
<span class="normal">899</span>
<span class="normal">900</span>
<span class="normal">901</span>
<span class="normal">902</span>
<span class="normal">903</span>
<span class="normal">904</span>
<span class="normal">905</span>
<span class="normal">906</span>
<span class="normal">907</span>
<span class="normal">908</span>
<span class="normal">909</span>
<span class="normal">910</span>
<span class="normal">911</span>
<span class="normal">912</span>
<span class="normal">913</span>
<span class="normal">914</span>
<span class="normal">915</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="n">ConfigDict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="k">def</span><span class="w"> </span><span class="nf">get_handlebars_template_variables</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Table</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get all available template variables for a table.</span>

<span class="sd">    Returns the columns, foreign keys, and special variables that can be</span>
<span class="sd">    used in Handlebars templates (row_markdown_pattern, markdown_pattern, etc.)</span>
<span class="sd">    for the specified table.</span>

<span class="sd">    Args:</span>
<span class="sd">        table: Table name or Table object.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dictionary with columns, foreign_keys, special_variables, and helper_examples.</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; vars = ml.get_handlebars_template_variables(&quot;Image&quot;)</span>
<span class="sd">        &gt;&gt;&gt; for col in vars[&quot;columns&quot;]:</span>
<span class="sd">        ...     print(f&quot;{col[&#39;name&#39;]}: {col[&#39;template&#39;]}&quot;)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">table_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">name_to_table</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>

    <span class="c1"># Get columns</span>
    <span class="n">columns</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">table_obj</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="n">columns</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">col</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">col</span><span class="o">.</span><span class="n">type</span><span class="o">.</span><span class="n">typename</span><span class="p">),</span>
            <span class="s2">&quot;template&quot;</span><span class="p">:</span> <span class="s2">&quot;{{{&quot;</span> <span class="o">+</span> <span class="n">col</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;}}}&quot;</span><span class="p">,</span>
            <span class="s2">&quot;row_template&quot;</span><span class="p">:</span> <span class="s2">&quot;{{{_row.&quot;</span> <span class="o">+</span> <span class="n">col</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;}}}&quot;</span><span class="p">,</span>
        <span class="p">})</span>

    <span class="c1"># Get foreign keys (outbound)</span>
    <span class="n">foreign_keys</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">fkey</span> <span class="ow">in</span> <span class="n">table_obj</span><span class="o">.</span><span class="n">foreign_keys</span><span class="p">:</span>
        <span class="n">schema_name</span> <span class="o">=</span> <span class="n">fkey</span><span class="o">.</span><span class="n">constraint_schema</span><span class="o">.</span><span class="n">name</span>
        <span class="n">constraint_name</span> <span class="o">=</span> <span class="n">fkey</span><span class="o">.</span><span class="n">constraint_name</span>
        <span class="n">fk_path</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;$fkeys.</span><span class="si">{</span><span class="n">schema_name</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">constraint_name</span><span class="si">}</span><span class="s2">&quot;</span>

        <span class="c1"># Get columns from referenced table</span>
        <span class="n">ref_columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">fkey</span><span class="o">.</span><span class="n">pk_table</span><span class="o">.</span><span class="n">columns</span><span class="p">]</span>

        <span class="n">foreign_keys</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
            <span class="s2">&quot;constraint&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">schema_name</span><span class="p">,</span> <span class="n">constraint_name</span><span class="p">],</span>
            <span class="s2">&quot;from_columns&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">col</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">fkey</span><span class="o">.</span><span class="n">columns</span><span class="p">],</span>
            <span class="s2">&quot;to_table&quot;</span><span class="p">:</span> <span class="n">fkey</span><span class="o">.</span><span class="n">pk_table</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
            <span class="s2">&quot;to_columns&quot;</span><span class="p">:</span> <span class="n">ref_columns</span><span class="p">,</span>
            <span class="s2">&quot;values_template&quot;</span><span class="p">:</span> <span class="s2">&quot;{{{&quot;</span> <span class="o">+</span> <span class="n">fk_path</span> <span class="o">+</span> <span class="s2">&quot;.values.COLUMN}}}&quot;</span><span class="p">,</span>
            <span class="s2">&quot;row_name_template&quot;</span><span class="p">:</span> <span class="s2">&quot;{{{&quot;</span> <span class="o">+</span> <span class="n">fk_path</span> <span class="o">+</span> <span class="s2">&quot;.rowName}}}&quot;</span><span class="p">,</span>
            <span class="s2">&quot;example_column_templates&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="s2">&quot;{{{&quot;</span> <span class="o">+</span> <span class="n">fk_path</span> <span class="o">+</span> <span class="s2">&quot;.values.&quot;</span> <span class="o">+</span> <span class="n">c</span> <span class="o">+</span> <span class="s2">&quot;}}}&quot;</span>
                <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">ref_columns</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span>  <span class="c1"># Show first 3 as examples</span>
            <span class="p">]</span>
        <span class="p">})</span>

    <span class="k">return</span> <span class="p">{</span>
        <span class="s2">&quot;table&quot;</span><span class="p">:</span> <span class="n">table_obj</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
        <span class="s2">&quot;columns&quot;</span><span class="p">:</span> <span class="n">columns</span><span class="p">,</span>
        <span class="s2">&quot;foreign_keys&quot;</span><span class="p">:</span> <span class="n">foreign_keys</span><span class="p">,</span>
        <span class="s2">&quot;special_variables&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;_value&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Current column value (in column_display)&quot;</span><span class="p">,</span>
                <span class="s2">&quot;template&quot;</span><span class="p">:</span> <span class="s2">&quot;{{</span><span class="si">{_value}</span><span class="s2">}}&quot;</span>
            <span class="p">},</span>
            <span class="s2">&quot;_row&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Object with all row columns&quot;</span><span class="p">,</span>
                <span class="s2">&quot;template&quot;</span><span class="p">:</span> <span class="s2">&quot;{{</span><span class="si">{_row.column_name}</span><span class="s2">}}&quot;</span>
            <span class="p">},</span>
            <span class="s2">&quot;$catalog.id&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Catalog ID&quot;</span><span class="p">,</span>
                <span class="s2">&quot;template&quot;</span><span class="p">:</span> <span class="s2">&quot;{{{$catalog.id}}}&quot;</span>
            <span class="p">},</span>
            <span class="s2">&quot;$catalog.snapshot&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Current snapshot ID&quot;</span><span class="p">,</span>
                <span class="s2">&quot;template&quot;</span><span class="p">:</span> <span class="s2">&quot;{{{$catalog.snapshot}}}&quot;</span>
            <span class="p">},</span>
        <span class="p">},</span>
        <span class="s2">&quot;helper_examples&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;conditional&quot;</span><span class="p">:</span> <span class="s2">&quot;{{#if column}}...{{else}}...{{/if}}&quot;</span><span class="p">,</span>
            <span class="s2">&quot;iteration&quot;</span><span class="p">:</span> <span class="s2">&quot;{{#each array}}{{</span><span class="si">{this}</span><span class="s2">}}{{/each}}&quot;</span><span class="p">,</span>
            <span class="s2">&quot;comparison&quot;</span><span class="p">:</span> <span class="s2">&quot;{{#ifCond val1 &#39;==&#39; val2}}...{{/ifCond}}&quot;</span><span class="p">,</span>
            <span class="s2">&quot;date_format&quot;</span><span class="p">:</span> <span class="s2">&quot;{{formatDate RCT &#39;YYYY-MM-DD&#39;}}&quot;</span><span class="p">,</span>
            <span class="s2">&quot;json_output&quot;</span><span class="p">:</span> <span class="s2">&quot;{{toJSON object}}&quot;</span>
        <span class="p">}</span>
    <span class="p">}</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="deriva_ml.core.DerivaML.get_storage_summary" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">get_storage_summary</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_storage_summary</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">any</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Get a summary of local storage usage.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="any">any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dict with keys:
- 'working_dir': Path to working directory
- 'cache_dir': Path to cache directory
- 'cache_size_mb': Cache size in MB
- 'cache_file_count': Number of files in cache
- 'execution_dir_count': Number of execution directories
- 'execution_size_mb': Total size of execution directories in MB
- 'total_size_mb': Combined size in MB</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>ml = DerivaML('deriva.example.org', 'my_catalog')
summary = ml.get_storage_summary()
print(f"Total storage: {summary['total_size_mb']:.1f} MB")
print(f"  Cache: {summary['cache_size_mb']:.1f} MB")
print(f"  Executions: {summary['execution_size_mb']:.1f} MB")</p>
</blockquote>
</blockquote>
</blockquote>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/deriva_ml/core/base.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1206</span>
<span class="normal">1207</span>
<span class="normal">1208</span>
<span class="normal">1209</span>
<span class="normal">1210</span>
<span class="normal">1211</span>
<span class="normal">1212</span>
<span class="normal">1213</span>
<span class="normal">1214</span>
<span class="normal">1215</span>
<span class="normal">1216</span>
<span class="normal">1217</span>
<span class="normal">1218</span>
<span class="normal">1219</span>
<span class="normal">1220</span>
<span class="normal">1221</span>
<span class="normal">1222</span>
<span class="normal">1223</span>
<span class="normal">1224</span>
<span class="normal">1225</span>
<span class="normal">1226</span>
<span class="normal">1227</span>
<span class="normal">1228</span>
<span class="normal">1229</span>
<span class="normal">1230</span>
<span class="normal">1231</span>
<span class="normal">1232</span>
<span class="normal">1233</span>
<span class="normal">1234</span>
<span class="normal">1235</span>
<span class="normal">1236</span>
<span class="normal">1237</span>
<span class="normal">1238</span>
<span class="normal">1239</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_storage_summary</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get a summary of local storage usage.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict with keys:</span>
<span class="sd">            - &#39;working_dir&#39;: Path to working directory</span>
<span class="sd">            - &#39;cache_dir&#39;: Path to cache directory</span>
<span class="sd">            - &#39;cache_size_mb&#39;: Cache size in MB</span>
<span class="sd">            - &#39;cache_file_count&#39;: Number of files in cache</span>
<span class="sd">            - &#39;execution_dir_count&#39;: Number of execution directories</span>
<span class="sd">            - &#39;execution_size_mb&#39;: Total size of execution directories in MB</span>
<span class="sd">            - &#39;total_size_mb&#39;: Combined size in MB</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; ml = DerivaML(&#39;deriva.example.org&#39;, &#39;my_catalog&#39;)</span>
<span class="sd">        &gt;&gt;&gt; summary = ml.get_storage_summary()</span>
<span class="sd">        &gt;&gt;&gt; print(f&quot;Total storage: {summary[&#39;total_size_mb&#39;]:.1f} MB&quot;)</span>
<span class="sd">        &gt;&gt;&gt; print(f&quot;  Cache: {summary[&#39;cache_size_mb&#39;]:.1f} MB&quot;)</span>
<span class="sd">        &gt;&gt;&gt; print(f&quot;  Executions: {summary[&#39;execution_size_mb&#39;]:.1f} MB&quot;)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">cache_stats</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_cache_size</span><span class="p">()</span>
    <span class="n">exec_dirs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">list_execution_dirs</span><span class="p">()</span>

    <span class="n">exec_size_mb</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;size_mb&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">exec_dirs</span><span class="p">)</span>

    <span class="k">return</span> <span class="p">{</span>
        <span class="s1">&#39;working_dir&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">working_dir</span><span class="p">),</span>
        <span class="s1">&#39;cache_dir&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cache_dir</span><span class="p">),</span>
        <span class="s1">&#39;cache_size_mb&#39;</span><span class="p">:</span> <span class="n">cache_stats</span><span class="p">[</span><span class="s1">&#39;total_mb&#39;</span><span class="p">],</span>
        <span class="s1">&#39;cache_file_count&#39;</span><span class="p">:</span> <span class="n">cache_stats</span><span class="p">[</span><span class="s1">&#39;file_count&#39;</span><span class="p">],</span>
        <span class="s1">&#39;execution_dir_count&#39;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">exec_dirs</span><span class="p">),</span>
        <span class="s1">&#39;execution_size_mb&#39;</span><span class="p">:</span> <span class="n">exec_size_mb</span><span class="p">,</span>
        <span class="s1">&#39;total_size_mb&#39;</span><span class="p">:</span> <span class="n">cache_stats</span><span class="p">[</span><span class="s1">&#39;total_mb&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">exec_size_mb</span><span class="p">,</span>
    <span class="p">}</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="deriva_ml.core.DerivaML.get_table_annotations" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">get_table_annotations</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_table_annotations</span><span class="p">(</span>
    <span class="n">table</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Table</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Get all display-related annotations for a table.</p>
<p>Returns the current values of display, visible-columns, visible-foreign-keys,
and table-display annotations for the specified table.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>table</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <span title="deriva_ml.core.mixins.annotation.Table">Table</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Table name or Table object.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary with keys: table, schema, display, visible_columns,</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>visible_foreign_keys, table_display. Missing annotations are None.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>annotations = ml.get_table_annotations("Image")
print(annotations["visible_columns"])</p>
</blockquote>
</blockquote>
</blockquote>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/deriva_ml/core/mixins/annotation.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="n">ConfigDict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="k">def</span><span class="w"> </span><span class="nf">get_table_annotations</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Table</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get all display-related annotations for a table.</span>

<span class="sd">    Returns the current values of display, visible-columns, visible-foreign-keys,</span>
<span class="sd">    and table-display annotations for the specified table.</span>

<span class="sd">    Args:</span>
<span class="sd">        table: Table name or Table object.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dictionary with keys: table, schema, display, visible_columns,</span>
<span class="sd">        visible_foreign_keys, table_display. Missing annotations are None.</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; annotations = ml.get_table_annotations(&quot;Image&quot;)</span>
<span class="sd">        &gt;&gt;&gt; print(annotations[&quot;visible_columns&quot;])</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">table_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">name_to_table</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">{</span>
        <span class="s2">&quot;table&quot;</span><span class="p">:</span> <span class="n">table_obj</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
        <span class="s2">&quot;schema&quot;</span><span class="p">:</span> <span class="n">table_obj</span><span class="o">.</span><span class="n">schema</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
        <span class="s2">&quot;display&quot;</span><span class="p">:</span> <span class="n">table_obj</span><span class="o">.</span><span class="n">annotations</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">DISPLAY_TAG</span><span class="p">),</span>
        <span class="s2">&quot;visible_columns&quot;</span><span class="p">:</span> <span class="n">table_obj</span><span class="o">.</span><span class="n">annotations</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">VISIBLE_COLUMNS_TAG</span><span class="p">),</span>
        <span class="s2">&quot;visible_foreign_keys&quot;</span><span class="p">:</span> <span class="n">table_obj</span><span class="o">.</span><span class="n">annotations</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">VISIBLE_FOREIGN_KEYS_TAG</span><span class="p">),</span>
        <span class="s2">&quot;table_display&quot;</span><span class="p">:</span> <span class="n">table_obj</span><span class="o">.</span><span class="n">annotations</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">TABLE_DISPLAY_TAG</span><span class="p">),</span>
    <span class="p">}</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="deriva_ml.core.DerivaML.get_table_as_dataframe" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">get_table_as_dataframe</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_table_as_dataframe</span><span class="p">(</span>
    <span class="n">table</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Get table contents as a pandas DataFrame.</p>
<p>Retrieves all contents of a table from the catalog.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>table</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the table to retrieve.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>DataFrame containing all table contents.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/deriva_ml/core/mixins/path_builder.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_table_as_dataframe</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get table contents as a pandas DataFrame.</span>

<span class="sd">    Retrieves all contents of a table from the catalog.</span>

<span class="sd">    Args:</span>
<span class="sd">        table: Name of the table to retrieve.</span>

<span class="sd">    Returns:</span>
<span class="sd">        DataFrame containing all table contents.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_table_as_dict</span><span class="p">(</span><span class="n">table</span><span class="p">)))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="deriva_ml.core.DerivaML.get_table_as_dict" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">get_table_as_dict</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_table_as_dict</span><span class="p">(</span>
    <span class="n">table</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Get table contents as dictionaries.</p>
<p>Retrieves all contents of a table from the catalog.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>table</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the table to retrieve.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Iterable">Iterable</span>[<span title="dict">dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Iterable yielding dictionaries for each row.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/deriva_ml/core/mixins/path_builder.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_table_as_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get table contents as dictionaries.</span>

<span class="sd">    Retrieves all contents of a table from the catalog.</span>

<span class="sd">    Args:</span>
<span class="sd">        table: Name of the table to retrieve.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Iterable yielding dictionaries for each row.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">table_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">name_to_table</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>
    <span class="n">pb</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pathBuilder</span><span class="p">()</span>
    <span class="k">yield from</span> <span class="n">pb</span><span class="o">.</span><span class="n">schemas</span><span class="p">[</span><span class="n">table_obj</span><span class="o">.</span><span class="n">schema</span><span class="o">.</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">tables</span><span class="p">[</span><span class="n">table_obj</span><span class="o">.</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">entities</span><span class="p">()</span><span class="o">.</span><span class="n">fetch</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="deriva_ml.core.DerivaML.globus_login" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">globus_login</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">globus_login</span><span class="p">(</span><span class="n">host</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Authenticates with Globus for accessing Deriva services.</p>
<p>Performs authentication using Globus Auth to access Deriva services. If already logged in, notifies the user.
Uses non-interactive authentication flow without a browser or local server.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>host</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The hostname of the Deriva server to authenticate with (e.g., 'deriva.example.org').</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>DerivaML.globus_login('deriva.example.org')
'Login Successful'</p>
</blockquote>
</blockquote>
</blockquote>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/deriva_ml/core/base.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">globus_login</span><span class="p">(</span><span class="n">host</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Authenticates with Globus for accessing Deriva services.</span>

<span class="sd">    Performs authentication using Globus Auth to access Deriva services. If already logged in, notifies the user.</span>
<span class="sd">    Uses non-interactive authentication flow without a browser or local server.</span>

<span class="sd">    Args:</span>
<span class="sd">        host: The hostname of the Deriva server to authenticate with (e.g., &#39;deriva.example.org&#39;).</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; DerivaML.globus_login(&#39;deriva.example.org&#39;)</span>
<span class="sd">        &#39;Login Successful&#39;</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">gnl</span> <span class="o">=</span> <span class="n">GlobusNativeLogin</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="n">host</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">gnl</span><span class="o">.</span><span class="n">is_logged_in</span><span class="p">([</span><span class="n">host</span><span class="p">]):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;You are already logged in.&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">gnl</span><span class="o">.</span><span class="n">login</span><span class="p">(</span>
            <span class="p">[</span><span class="n">host</span><span class="p">],</span>
            <span class="n">no_local_server</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">no_browser</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">refresh_tokens</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">update_bdbag_keychain</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Login Successful&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="deriva_ml.core.DerivaML.instantiate" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">instantiate</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">instantiate</span><span class="p">(</span>
    <span class="n">config</span><span class="p">:</span> <span class="n">DerivaMLConfig</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Create a DerivaML instance from a configuration object.</p>
<p>This method is the preferred way to instantiate DerivaML when using hydra-zen
for configuration management. It accepts a DerivaMLConfig (Pydantic model) and
unpacks it to create the instance.</p>
<p>This pattern allows hydra-zen's <code>instantiate()</code> to work with DerivaML:</p>


<details class="example-with-hydra-zen" open>
  <summary>Example with hydra-zen</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>from hydra_zen import builds, instantiate
from deriva_ml import DerivaML
from deriva_ml.core.config import DerivaMLConfig</p>
<h4 id="deriva_ml.core.DerivaML.instantiate--create-a-structured-config-using-hydra-zen">Create a structured config using hydra-zen</h4>
<p>DerivaMLConf = builds(DerivaMLConfig, populate_full_signature=True)</p>
<h4 id="deriva_ml.core.DerivaML.instantiate--configure-for-your-environment">Configure for your environment</h4>
<p>conf = DerivaMLConf(
...     hostname='deriva.example.org',
...     catalog_id='42',
...     domain_schema='my_domain',
... )</p>
<h4 id="deriva_ml.core.DerivaML.instantiate--instantiate-the-config-to-get-a-derivamlconfig-object">Instantiate the config to get a DerivaMLConfig object</h4>
<p>config = instantiate(conf)</p>
<h4 id="deriva_ml.core.DerivaML.instantiate--create-the-derivaml-instance">Create the DerivaML instance</h4>
<p>ml = DerivaML.instantiate(config)</p>
</blockquote>
</blockquote>
</blockquote>
</details>

<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>config</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="DerivaMLConfig (deriva_ml.core.config.DerivaMLConfig)" href="#deriva_ml.core.DerivaMLConfig">DerivaMLConfig</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A DerivaMLConfig object containing all configuration parameters.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing_extensions.Self">Self</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A new DerivaML instance configured according to the config object.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Note</summary>
  <p>The DerivaMLConfig class integrates with Hydra's configuration system
and registers custom resolvers for computing working directories.
See <code>deriva_ml.core.config</code> for details on configuration options.</p>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/deriva_ml/core/base.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">instantiate</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">DerivaMLConfig</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a DerivaML instance from a configuration object.</span>

<span class="sd">    This method is the preferred way to instantiate DerivaML when using hydra-zen</span>
<span class="sd">    for configuration management. It accepts a DerivaMLConfig (Pydantic model) and</span>
<span class="sd">    unpacks it to create the instance.</span>

<span class="sd">    This pattern allows hydra-zen&#39;s `instantiate()` to work with DerivaML:</span>

<span class="sd">    Example with hydra-zen:</span>
<span class="sd">        &gt;&gt;&gt; from hydra_zen import builds, instantiate</span>
<span class="sd">        &gt;&gt;&gt; from deriva_ml import DerivaML</span>
<span class="sd">        &gt;&gt;&gt; from deriva_ml.core.config import DerivaMLConfig</span>
<span class="sd">        &gt;&gt;&gt;</span>
<span class="sd">        &gt;&gt;&gt; # Create a structured config using hydra-zen</span>
<span class="sd">        &gt;&gt;&gt; DerivaMLConf = builds(DerivaMLConfig, populate_full_signature=True)</span>
<span class="sd">        &gt;&gt;&gt;</span>
<span class="sd">        &gt;&gt;&gt; # Configure for your environment</span>
<span class="sd">        &gt;&gt;&gt; conf = DerivaMLConf(</span>
<span class="sd">        ...     hostname=&#39;deriva.example.org&#39;,</span>
<span class="sd">        ...     catalog_id=&#39;42&#39;,</span>
<span class="sd">        ...     domain_schema=&#39;my_domain&#39;,</span>
<span class="sd">        ... )</span>
<span class="sd">        &gt;&gt;&gt;</span>
<span class="sd">        &gt;&gt;&gt; # Instantiate the config to get a DerivaMLConfig object</span>
<span class="sd">        &gt;&gt;&gt; config = instantiate(conf)</span>
<span class="sd">        &gt;&gt;&gt;</span>
<span class="sd">        &gt;&gt;&gt; # Create the DerivaML instance</span>
<span class="sd">        &gt;&gt;&gt; ml = DerivaML.instantiate(config)</span>

<span class="sd">    Args:</span>
<span class="sd">        config: A DerivaMLConfig object containing all configuration parameters.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A new DerivaML instance configured according to the config object.</span>

<span class="sd">    Note:</span>
<span class="sd">        The DerivaMLConfig class integrates with Hydra&#39;s configuration system</span>
<span class="sd">        and registers custom resolvers for computing working directories.</span>
<span class="sd">        See `deriva_ml.core.config` for details on configuration options.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="o">**</span><span class="n">config</span><span class="o">.</span><span class="n">model_dump</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="deriva_ml.core.DerivaML.list_asset_executions" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">list_asset_executions</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">list_asset_executions</span><span class="p">(</span>
    <span class="n">asset_rid</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">asset_role</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="s2">&quot;ExecutionRecord&quot;</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>List all executions associated with an asset.</p>
<p>Given an asset RID, returns a list of executions that created or used
the asset, along with the role (Input/Output) in each execution.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>asset_rid</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The RID of the asset to look up.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>asset_role</code>
            </td>
            <td>
                  <code><span title="str">str</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional filter for asset role ('Input' or 'Output').
If None, returns all associations.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[&#39;ExecutionRecord&#39;]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>list[ExecutionRecord]: List of ExecutionRecord objects for the
executions associated with this asset.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="DerivaMLException (deriva_ml.core.exceptions.DerivaMLException)" href="../exceptions/#deriva_ml.core.exceptions.DerivaMLException">DerivaMLException</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the asset RID is not found or not an asset.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<h4 id="deriva_ml.core.DerivaML.list_asset_executions--find-all-executions-that-created-this-asset">Find all executions that created this asset</h4>
<p>executions = ml.list_asset_executions("1-abc123", asset_role="Output")
for exe in executions:
...     print(f"Created by execution {exe.execution_rid}")</p>
<h4 id="deriva_ml.core.DerivaML.list_asset_executions--find-all-executions-that-used-this-asset-as-input">Find all executions that used this asset as input</h4>
<p>executions = ml.list_asset_executions("1-abc123", asset_role="Input")</p>
</blockquote>
</blockquote>
</blockquote>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/deriva_ml/core/mixins/asset.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">list_asset_executions</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">asset_rid</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">asset_role</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="s2">&quot;ExecutionRecord&quot;</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;List all executions associated with an asset.</span>

<span class="sd">    Given an asset RID, returns a list of executions that created or used</span>
<span class="sd">    the asset, along with the role (Input/Output) in each execution.</span>

<span class="sd">    Args:</span>
<span class="sd">        asset_rid: The RID of the asset to look up.</span>
<span class="sd">        asset_role: Optional filter for asset role (&#39;Input&#39; or &#39;Output&#39;).</span>
<span class="sd">            If None, returns all associations.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list[ExecutionRecord]: List of ExecutionRecord objects for the</span>
<span class="sd">            executions associated with this asset.</span>

<span class="sd">    Raises:</span>
<span class="sd">        DerivaMLException: If the asset RID is not found or not an asset.</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; # Find all executions that created this asset</span>
<span class="sd">        &gt;&gt;&gt; executions = ml.list_asset_executions(&quot;1-abc123&quot;, asset_role=&quot;Output&quot;)</span>
<span class="sd">        &gt;&gt;&gt; for exe in executions:</span>
<span class="sd">        ...     print(f&quot;Created by execution {exe.execution_rid}&quot;)</span>

<span class="sd">        &gt;&gt;&gt; # Find all executions that used this asset as input</span>
<span class="sd">        &gt;&gt;&gt; executions = ml.list_asset_executions(&quot;1-abc123&quot;, asset_role=&quot;Input&quot;)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Resolve the RID to find which asset table it belongs to</span>
    <span class="n">rid_info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">resolve_rid</span><span class="p">(</span><span class="n">asset_rid</span><span class="p">)</span>  <span class="c1"># type: ignore[attr-defined]</span>
    <span class="n">asset_table</span> <span class="o">=</span> <span class="n">rid_info</span><span class="o">.</span><span class="n">table</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">is_asset</span><span class="p">(</span><span class="n">asset_table</span><span class="p">):</span>
        <span class="k">raise</span> <span class="n">DerivaMLException</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;RID </span><span class="si">{</span><span class="n">asset_rid</span><span class="si">}</span><span class="s2"> is not an asset (table: </span><span class="si">{</span><span class="n">asset_table</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>

    <span class="c1"># Find the association table between this asset table and Execution</span>
    <span class="n">asset_exe_table</span><span class="p">,</span> <span class="n">asset_fk</span><span class="p">,</span> <span class="n">execution_fk</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">find_association</span><span class="p">(</span><span class="n">asset_table</span><span class="p">,</span> <span class="s2">&quot;Execution&quot;</span><span class="p">)</span>

    <span class="c1"># Build the query</span>
    <span class="n">pb</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pathBuilder</span><span class="p">()</span>
    <span class="n">asset_exe_path</span> <span class="o">=</span> <span class="n">pb</span><span class="o">.</span><span class="n">schemas</span><span class="p">[</span><span class="n">asset_exe_table</span><span class="o">.</span><span class="n">schema</span><span class="o">.</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">tables</span><span class="p">[</span><span class="n">asset_exe_table</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>

    <span class="c1"># Filter by asset RID</span>
    <span class="n">query</span> <span class="o">=</span> <span class="n">asset_exe_path</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">asset_exe_path</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">asset_fk</span><span class="p">]</span> <span class="o">==</span> <span class="n">asset_rid</span><span class="p">)</span>

    <span class="c1"># Optionally filter by asset role</span>
    <span class="k">if</span> <span class="n">asset_role</span><span class="p">:</span>
        <span class="n">query</span> <span class="o">=</span> <span class="n">query</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">asset_exe_path</span><span class="o">.</span><span class="n">Asset_Role</span> <span class="o">==</span> <span class="n">asset_role</span><span class="p">)</span>

    <span class="c1"># Convert to ExecutionRecord objects</span>
    <span class="n">records</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">query</span><span class="o">.</span><span class="n">entities</span><span class="p">()</span><span class="o">.</span><span class="n">fetch</span><span class="p">())</span>
    <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">lookup_execution</span><span class="p">(</span><span class="n">record</span><span class="p">[</span><span class="s2">&quot;Execution&quot;</span><span class="p">])</span> <span class="k">for</span> <span class="n">record</span> <span class="ow">in</span> <span class="n">records</span><span class="p">]</span>  <span class="c1"># type: ignore[attr-defined]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="deriva_ml.core.DerivaML.list_asset_tables" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">list_asset_tables</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">list_asset_tables</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Table</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>List all asset tables in the catalog.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="deriva_ml.core.mixins.asset.Table">Table</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of Table objects that are asset tables.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>for table in ml.list_asset_tables():
...     print(f"Asset table: {table.name}")</p>
</blockquote>
</blockquote>
</blockquote>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/deriva_ml/core/mixins/asset.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">list_asset_tables</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Table</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;List all asset tables in the catalog.</span>

<span class="sd">    Returns:</span>
<span class="sd">        List of Table objects that are asset tables.</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; for table in ml.list_asset_tables():</span>
<span class="sd">        ...     print(f&quot;Asset table: {table.name}&quot;)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">tables</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># Include asset tables from all domain schemas</span>
    <span class="k">for</span> <span class="n">domain_schema</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">domain_schemas</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">domain_schema</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">schemas</span><span class="p">:</span>
            <span class="n">tables</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span>
                <span class="n">t</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">schemas</span><span class="p">[</span><span class="n">domain_schema</span><span class="p">]</span><span class="o">.</span><span class="n">tables</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">is_asset</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
            <span class="p">])</span>
    <span class="c1"># Also include ML schema asset tables (like Execution_Asset)</span>
    <span class="n">tables</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span>
        <span class="n">t</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">schemas</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ml_schema</span><span class="p">]</span><span class="o">.</span><span class="n">tables</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">is_asset</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
    <span class="p">])</span>
    <span class="k">return</span> <span class="n">tables</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="deriva_ml.core.DerivaML.list_assets" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">list_assets</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">list_assets</span><span class="p">(</span>
    <span class="n">asset_table</span><span class="p">:</span> <span class="n">Table</span> <span class="o">|</span> <span class="nb">str</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="s2">&quot;Asset&quot;</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Lists contents of an asset table.</p>
<p>Returns a list of Asset objects for the specified asset table.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>asset_table</code>
            </td>
            <td>
                  <code><span title="deriva_ml.core.mixins.asset.Table">Table</span> | <span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Table or name of the asset table to list assets for.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[&#39;Asset&#39;]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>list[Asset]: List of Asset objects for the assets in the table.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="DerivaMLException (deriva_ml.core.exceptions.DerivaMLException)" href="../exceptions/#deriva_ml.core.exceptions.DerivaMLException">DerivaMLException</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the table is not an asset table or doesn't exist.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>assets = ml.list_assets("Image")
for asset in assets:
...     print(f"{asset.asset_rid}: {asset.filename}")</p>
</blockquote>
</blockquote>
</blockquote>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/deriva_ml/core/mixins/asset.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">list_assets</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">asset_table</span><span class="p">:</span> <span class="n">Table</span> <span class="o">|</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="s2">&quot;Asset&quot;</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Lists contents of an asset table.</span>

<span class="sd">    Returns a list of Asset objects for the specified asset table.</span>

<span class="sd">    Args:</span>
<span class="sd">        asset_table: Table or name of the asset table to list assets for.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list[Asset]: List of Asset objects for the assets in the table.</span>

<span class="sd">    Raises:</span>
<span class="sd">        DerivaMLException: If the table is not an asset table or doesn&#39;t exist.</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; assets = ml.list_assets(&quot;Image&quot;)</span>
<span class="sd">        &gt;&gt;&gt; for asset in assets:</span>
<span class="sd">        ...     print(f&quot;{asset.asset_rid}: {asset.filename}&quot;)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">deriva_ml.asset.asset</span><span class="w"> </span><span class="kn">import</span> <span class="n">Asset</span>

    <span class="c1"># Validate and get asset table reference</span>
    <span class="n">asset_table_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">name_to_table</span><span class="p">(</span><span class="n">asset_table</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">is_asset</span><span class="p">(</span><span class="n">asset_table_obj</span><span class="p">):</span>
        <span class="k">raise</span> <span class="n">DerivaMLException</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Table </span><span class="si">{</span><span class="n">asset_table_obj</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> is not an asset&quot;</span><span class="p">)</span>

    <span class="c1"># Get path builders for asset and type tables</span>
    <span class="n">pb</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pathBuilder</span><span class="p">()</span>
    <span class="n">asset_path</span> <span class="o">=</span> <span class="n">pb</span><span class="o">.</span><span class="n">schemas</span><span class="p">[</span><span class="n">asset_table_obj</span><span class="o">.</span><span class="n">schema</span><span class="o">.</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">tables</span><span class="p">[</span><span class="n">asset_table_obj</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
    <span class="p">(</span>
        <span class="n">asset_type_table</span><span class="p">,</span>
        <span class="n">_</span><span class="p">,</span>
        <span class="n">_</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">find_association</span><span class="p">(</span><span class="n">asset_table_obj</span><span class="p">,</span> <span class="n">MLVocab</span><span class="o">.</span><span class="n">asset_type</span><span class="p">)</span>
    <span class="n">type_path</span> <span class="o">=</span> <span class="n">pb</span><span class="o">.</span><span class="n">schemas</span><span class="p">[</span><span class="n">asset_type_table</span><span class="o">.</span><span class="n">schema</span><span class="o">.</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">tables</span><span class="p">[</span><span class="n">asset_type_table</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>

    <span class="c1"># Build a list of Asset objects</span>
    <span class="n">assets</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">asset_record</span> <span class="ow">in</span> <span class="n">asset_path</span><span class="o">.</span><span class="n">entities</span><span class="p">()</span><span class="o">.</span><span class="n">fetch</span><span class="p">():</span>
        <span class="c1"># Get associated asset types for each asset</span>
        <span class="n">asset_types</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">type_path</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">type_path</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">asset_table_obj</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">==</span> <span class="n">asset_record</span><span class="p">[</span><span class="s2">&quot;RID&quot;</span><span class="p">])</span>
            <span class="o">.</span><span class="n">attributes</span><span class="p">(</span><span class="n">type_path</span><span class="o">.</span><span class="n">Asset_Type</span><span class="p">)</span>
            <span class="o">.</span><span class="n">fetch</span><span class="p">()</span>
        <span class="p">)</span>
        <span class="n">asset_type_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">asset_type</span><span class="p">[</span><span class="n">MLVocab</span><span class="o">.</span><span class="n">asset_type</span><span class="o">.</span><span class="n">value</span><span class="p">]</span> <span class="k">for</span> <span class="n">asset_type</span> <span class="ow">in</span> <span class="n">asset_types</span><span class="p">]</span>

        <span class="n">assets</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Asset</span><span class="p">(</span>
            <span class="n">catalog</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span>  <span class="c1"># type: ignore[arg-type]</span>
            <span class="n">asset_rid</span><span class="o">=</span><span class="n">asset_record</span><span class="p">[</span><span class="s2">&quot;RID&quot;</span><span class="p">],</span>
            <span class="n">asset_table</span><span class="o">=</span><span class="n">asset_table_obj</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
            <span class="n">filename</span><span class="o">=</span><span class="n">asset_record</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Filename&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span>
            <span class="n">url</span><span class="o">=</span><span class="n">asset_record</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;URL&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span>
            <span class="n">length</span><span class="o">=</span><span class="n">asset_record</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Length&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
            <span class="n">md5</span><span class="o">=</span><span class="n">asset_record</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;MD5&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span>
            <span class="n">description</span><span class="o">=</span><span class="n">asset_record</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Description&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span>
            <span class="n">asset_types</span><span class="o">=</span><span class="n">asset_type_list</span><span class="p">,</span>
        <span class="p">))</span>
    <span class="k">return</span> <span class="n">assets</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="deriva_ml.core.DerivaML.list_dataset_element_types" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">list_dataset_element_types</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">list_dataset_element_types</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="p">(</span>
    <span class="n">Iterable</span><span class="p">[</span><span class="n">Table</span><span class="p">]</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>List the types of entities that can be added to a dataset.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Iterable">Iterable</span>[<span title="deriva_ml.core.mixins.dataset.Table">Table</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An iterable of Table objects that can be included as an element of a dataset.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/deriva_ml/core/mixins/dataset.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">list_dataset_element_types</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">Table</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;List the types of entities that can be added to a dataset.</span>

<span class="sd">    Returns:</span>
<span class="sd">        An iterable of Table objects that can be included as an element of a dataset.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">is_domain_or_dataset_table</span><span class="p">(</span><span class="n">table</span><span class="p">:</span> <span class="n">Table</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">is_domain_schema</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">schema</span><span class="o">.</span><span class="n">name</span><span class="p">)</span> <span class="ow">or</span> <span class="n">table</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dataset_table</span><span class="o">.</span><span class="n">name</span>

    <span class="k">return</span> <span class="p">[</span><span class="n">t</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dataset_table</span><span class="o">.</span><span class="n">find_associations</span><span class="p">()</span> <span class="k">if</span> <span class="n">is_domain_or_dataset_table</span><span class="p">(</span><span class="n">t</span> <span class="o">:=</span> <span class="n">a</span><span class="o">.</span><span class="n">other_fkeys</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span><span class="o">.</span><span class="n">pk_table</span><span class="p">)]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="deriva_ml.core.DerivaML.list_execution_dirs" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">list_execution_dirs</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">list_execution_dirs</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span>
    <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">any</span><span class="p">]</span>
<span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>List execution working directories.</p>
<p>Returns information about each execution directory in the working directory,
useful for identifying orphaned or incomplete execution outputs.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="dict">dict</span>[<span title="str">str</span>, <span title="any">any</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of dicts, each containing:
- 'execution_rid': The execution RID (directory name)
- 'path': Full path to the directory
- 'size_bytes': Total size in bytes
- 'size_mb': Total size in megabytes
- 'modified': Last modification time (datetime)
- 'file_count': Number of files</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>ml = DerivaML('deriva.example.org', 'my_catalog')
dirs = ml.list_execution_dirs()
for d in dirs:
...     print(f"{d['execution_rid']}: {d['size_mb']:.1f} MB")</p>
</blockquote>
</blockquote>
</blockquote>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/deriva_ml/core/base.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1085</span>
<span class="normal">1086</span>
<span class="normal">1087</span>
<span class="normal">1088</span>
<span class="normal">1089</span>
<span class="normal">1090</span>
<span class="normal">1091</span>
<span class="normal">1092</span>
<span class="normal">1093</span>
<span class="normal">1094</span>
<span class="normal">1095</span>
<span class="normal">1096</span>
<span class="normal">1097</span>
<span class="normal">1098</span>
<span class="normal">1099</span>
<span class="normal">1100</span>
<span class="normal">1101</span>
<span class="normal">1102</span>
<span class="normal">1103</span>
<span class="normal">1104</span>
<span class="normal">1105</span>
<span class="normal">1106</span>
<span class="normal">1107</span>
<span class="normal">1108</span>
<span class="normal">1109</span>
<span class="normal">1110</span>
<span class="normal">1111</span>
<span class="normal">1112</span>
<span class="normal">1113</span>
<span class="normal">1114</span>
<span class="normal">1115</span>
<span class="normal">1116</span>
<span class="normal">1117</span>
<span class="normal">1118</span>
<span class="normal">1119</span>
<span class="normal">1120</span>
<span class="normal">1121</span>
<span class="normal">1122</span>
<span class="normal">1123</span>
<span class="normal">1124</span>
<span class="normal">1125</span>
<span class="normal">1126</span>
<span class="normal">1127</span>
<span class="normal">1128</span>
<span class="normal">1129</span>
<span class="normal">1130</span>
<span class="normal">1131</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">list_execution_dirs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">any</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;List execution working directories.</span>

<span class="sd">    Returns information about each execution directory in the working directory,</span>
<span class="sd">    useful for identifying orphaned or incomplete execution outputs.</span>

<span class="sd">    Returns:</span>
<span class="sd">        List of dicts, each containing:</span>
<span class="sd">            - &#39;execution_rid&#39;: The execution RID (directory name)</span>
<span class="sd">            - &#39;path&#39;: Full path to the directory</span>
<span class="sd">            - &#39;size_bytes&#39;: Total size in bytes</span>
<span class="sd">            - &#39;size_mb&#39;: Total size in megabytes</span>
<span class="sd">            - &#39;modified&#39;: Last modification time (datetime)</span>
<span class="sd">            - &#39;file_count&#39;: Number of files</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; ml = DerivaML(&#39;deriva.example.org&#39;, &#39;my_catalog&#39;)</span>
<span class="sd">        &gt;&gt;&gt; dirs = ml.list_execution_dirs()</span>
<span class="sd">        &gt;&gt;&gt; for d in dirs:</span>
<span class="sd">        ...     print(f&quot;{d[&#39;execution_rid&#39;]}: {d[&#39;size_mb&#39;]:.1f} MB&quot;)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span>

    <span class="kn">from</span><span class="w"> </span><span class="nn">deriva_ml.dataset.upload</span><span class="w"> </span><span class="kn">import</span> <span class="n">upload_root</span>

    <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">exec_root</span> <span class="o">=</span> <span class="n">upload_root</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">working_dir</span><span class="p">)</span> <span class="o">/</span> <span class="s2">&quot;execution&quot;</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">exec_root</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
        <span class="k">return</span> <span class="n">results</span>

    <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">exec_root</span><span class="o">.</span><span class="n">iterdir</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">entry</span><span class="o">.</span><span class="n">is_dir</span><span class="p">():</span>
            <span class="n">size_bytes</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">stat</span><span class="p">()</span><span class="o">.</span><span class="n">st_size</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">entry</span><span class="o">.</span><span class="n">rglob</span><span class="p">(</span><span class="s1">&#39;*&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">is_file</span><span class="p">())</span>
            <span class="n">file_count</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="mi">1</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">entry</span><span class="o">.</span><span class="n">rglob</span><span class="p">(</span><span class="s1">&#39;*&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">is_file</span><span class="p">())</span>
            <span class="n">mtime</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">fromtimestamp</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">stat</span><span class="p">()</span><span class="o">.</span><span class="n">st_mtime</span><span class="p">)</span>

            <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
                <span class="s1">&#39;execution_rid&#39;</span><span class="p">:</span> <span class="n">entry</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                <span class="s1">&#39;path&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">entry</span><span class="p">),</span>
                <span class="s1">&#39;size_bytes&#39;</span><span class="p">:</span> <span class="n">size_bytes</span><span class="p">,</span>
                <span class="s1">&#39;size_mb&#39;</span><span class="p">:</span> <span class="n">size_bytes</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1024</span> <span class="o">*</span> <span class="mi">1024</span><span class="p">),</span>
                <span class="s1">&#39;modified&#39;</span><span class="p">:</span> <span class="n">mtime</span><span class="p">,</span>
                <span class="s1">&#39;file_count&#39;</span><span class="p">:</span> <span class="n">file_count</span><span class="p">,</span>
            <span class="p">})</span>

    <span class="k">return</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="s1">&#39;modified&#39;</span><span class="p">],</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="deriva_ml.core.DerivaML.list_feature_values" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">list_feature_values</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">list_feature_values</span><span class="p">(</span>
    <span class="n">table</span><span class="p">:</span> <span class="n">Table</span> <span class="o">|</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">feature_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">FeatureRecord</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Retrieves all values for a feature as typed FeatureRecord instances.</p>
<p>Returns an iterator of dynamically-generated FeatureRecord objects for each
feature value. Each record is an instance of a Pydantic model specific to
this feature, with typed attributes for all columns including the Execution
that created the feature value.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>table</code>
            </td>
            <td>
                  <code><span title="deriva_ml.core.mixins.feature.Table">Table</span> | <span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The table containing the feature, either as name or Table object.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>feature_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the feature to retrieve values for.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Iterable">Iterable</span>[<a class="autorefs autorefs-internal" title="FeatureRecord (deriva_ml.feature.FeatureRecord)" href="../feature/#deriva_ml.feature.FeatureRecord">FeatureRecord</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Iterable[FeatureRecord]: An iterator of FeatureRecord instances.
Each instance has:
- Execution: RID of the execution that created this feature value
- Feature_Name: Name of the feature
- All feature-specific columns as typed attributes
- model_dump() method to convert back to a dictionary</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="DerivaMLException (deriva_ml.core.exceptions.DerivaMLException)" href="../exceptions/#deriva_ml.core.exceptions.DerivaMLException">DerivaMLException</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the feature doesn't exist or cannot be accessed.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<h4 id="deriva_ml.core.DerivaML.list_feature_values--get-typed-feature-records">Get typed feature records</h4>
<p>for record in ml.list_feature_values("Image", "Quality"):
...     print(f"Image {record.Image}: {record.ImageQuality}")
...     print(f"Created by execution: {record.Execution}")</p>
<h4 id="deriva_ml.core.DerivaML.list_feature_values--convert-records-to-dictionaries">Convert records to dictionaries</h4>
<p>records = list(ml.list_feature_values("Image", "Quality"))
dicts = [r.model_dump() for r in records]</p>
</blockquote>
</blockquote>
</blockquote>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/deriva_ml/core/mixins/feature.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="n">ConfigDict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="k">def</span><span class="w"> </span><span class="nf">list_feature_values</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">:</span> <span class="n">Table</span> <span class="o">|</span> <span class="nb">str</span><span class="p">,</span> <span class="n">feature_name</span><span class="p">:</span> <span class="nb">str</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">FeatureRecord</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Retrieves all values for a feature as typed FeatureRecord instances.</span>

<span class="sd">    Returns an iterator of dynamically-generated FeatureRecord objects for each</span>
<span class="sd">    feature value. Each record is an instance of a Pydantic model specific to</span>
<span class="sd">    this feature, with typed attributes for all columns including the Execution</span>
<span class="sd">    that created the feature value.</span>

<span class="sd">    Args:</span>
<span class="sd">        table: The table containing the feature, either as name or Table object.</span>
<span class="sd">        feature_name: Name of the feature to retrieve values for.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Iterable[FeatureRecord]: An iterator of FeatureRecord instances.</span>
<span class="sd">            Each instance has:</span>
<span class="sd">            - Execution: RID of the execution that created this feature value</span>
<span class="sd">            - Feature_Name: Name of the feature</span>
<span class="sd">            - All feature-specific columns as typed attributes</span>
<span class="sd">            - model_dump() method to convert back to a dictionary</span>

<span class="sd">    Raises:</span>
<span class="sd">        DerivaMLException: If the feature doesn&#39;t exist or cannot be accessed.</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; # Get typed feature records</span>
<span class="sd">        &gt;&gt;&gt; for record in ml.list_feature_values(&quot;Image&quot;, &quot;Quality&quot;):</span>
<span class="sd">        ...     print(f&quot;Image {record.Image}: {record.ImageQuality}&quot;)</span>
<span class="sd">        ...     print(f&quot;Created by execution: {record.Execution}&quot;)</span>

<span class="sd">        &gt;&gt;&gt; # Convert records to dictionaries</span>
<span class="sd">        &gt;&gt;&gt; records = list(ml.list_feature_values(&quot;Image&quot;, &quot;Quality&quot;))</span>
<span class="sd">        &gt;&gt;&gt; dicts = [r.model_dump() for r in records]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Get table and feature</span>
    <span class="n">table</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">name_to_table</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>
    <span class="n">feature</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lookup_feature</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">feature_name</span><span class="p">)</span>

    <span class="c1"># Get the dynamically-generated FeatureRecord subclass for this feature</span>
    <span class="n">record_class</span> <span class="o">=</span> <span class="n">feature</span><span class="o">.</span><span class="n">feature_record_class</span><span class="p">()</span>

    <span class="c1"># Build and execute query for feature values</span>
    <span class="n">pb</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pathBuilder</span><span class="p">()</span>
    <span class="n">raw_values</span> <span class="o">=</span> <span class="n">pb</span><span class="o">.</span><span class="n">schemas</span><span class="p">[</span><span class="n">feature</span><span class="o">.</span><span class="n">feature_table</span><span class="o">.</span><span class="n">schema</span><span class="o">.</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">tables</span><span class="p">[</span><span class="n">feature</span><span class="o">.</span><span class="n">feature_table</span><span class="o">.</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">entities</span><span class="p">()</span><span class="o">.</span><span class="n">fetch</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">raw_value</span> <span class="ow">in</span> <span class="n">raw_values</span><span class="p">:</span>
        <span class="c1"># Create a record instance from the raw dictionary</span>
        <span class="c1"># Filter to only include fields that the record class expects</span>
        <span class="n">field_names</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">record_class</span><span class="o">.</span><span class="n">model_fields</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="n">filtered_data</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">raw_value</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">field_names</span><span class="p">}</span>
        <span class="k">yield</span> <span class="n">record_class</span><span class="p">(</span><span class="o">**</span><span class="n">filtered_data</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="deriva_ml.core.DerivaML.list_files" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">list_files</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">list_files</span><span class="p">(</span>
    <span class="n">file_types</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Lists files in the catalog with their metadata.</p>
<p>Returns a list of files with their metadata including URL, MD5 hash, length, description,
and associated file types. Files can be optionally filtered by type.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>file_types</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Filter results to only include these file types.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="dict">dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>list[dict[str, Any]]: List of file records, each containing:
- RID: Resource identifier
- URL: File location
- MD5: File hash
- Length: File size
- Description: File description
- File_Types: List of associated file types</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <p>List all files:
    &gt;&gt;&gt; files = ml.list_files()
    &gt;&gt;&gt; for f in files:
    ...     print(f"{f['RID']}: {f['URL']}")</p>
<p>Filter by file type:
    &gt;&gt;&gt; image_files = ml.list_files(["image", "png"])</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/deriva_ml/core/mixins/file.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">list_files</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_types</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Lists files in the catalog with their metadata.</span>

<span class="sd">    Returns a list of files with their metadata including URL, MD5 hash, length, description,</span>
<span class="sd">    and associated file types. Files can be optionally filtered by type.</span>

<span class="sd">    Args:</span>
<span class="sd">        file_types: Filter results to only include these file types.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list[dict[str, Any]]: List of file records, each containing:</span>
<span class="sd">            - RID: Resource identifier</span>
<span class="sd">            - URL: File location</span>
<span class="sd">            - MD5: File hash</span>
<span class="sd">            - Length: File size</span>
<span class="sd">            - Description: File description</span>
<span class="sd">            - File_Types: List of associated file types</span>

<span class="sd">    Examples:</span>
<span class="sd">        List all files:</span>
<span class="sd">            &gt;&gt;&gt; files = ml.list_files()</span>
<span class="sd">            &gt;&gt;&gt; for f in files:</span>
<span class="sd">            ...     print(f&quot;{f[&#39;RID&#39;]}: {f[&#39;URL&#39;]}&quot;)</span>

<span class="sd">        Filter by file type:</span>
<span class="sd">            &gt;&gt;&gt; image_files = ml.list_files([&quot;image&quot;, &quot;png&quot;])</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">asset_type_atable</span><span class="p">,</span> <span class="n">file_fk</span><span class="p">,</span> <span class="n">asset_type_fk</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">find_association</span><span class="p">(</span><span class="s2">&quot;File&quot;</span><span class="p">,</span> <span class="s2">&quot;Asset_Type&quot;</span><span class="p">)</span>
    <span class="n">ml_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pathBuilder</span><span class="p">()</span><span class="o">.</span><span class="n">schemas</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ml_schema</span><span class="p">]</span>
    <span class="n">file</span> <span class="o">=</span> <span class="n">ml_path</span><span class="o">.</span><span class="n">File</span>
    <span class="n">asset_type</span> <span class="o">=</span> <span class="n">ml_path</span><span class="o">.</span><span class="n">tables</span><span class="p">[</span><span class="n">asset_type_atable</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>

    <span class="n">path</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">path</span>
    <span class="n">path</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">link</span><span class="p">(</span><span class="n">asset_type</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="s2">&quot;AT&quot;</span><span class="p">),</span> <span class="n">on</span><span class="o">=</span><span class="n">file</span><span class="o">.</span><span class="n">RID</span> <span class="o">==</span> <span class="n">asset_type</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">file_fk</span><span class="p">],</span> <span class="n">join_type</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">file_types</span><span class="p">:</span>
        <span class="n">path</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">asset_type</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">asset_type_fk</span><span class="p">]</span> <span class="o">==</span> <span class="n">datapath</span><span class="o">.</span><span class="n">Any</span><span class="p">(</span><span class="o">*</span><span class="n">file_types</span><span class="p">))</span>
    <span class="n">path</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">attributes</span><span class="p">(</span>
        <span class="n">path</span><span class="o">.</span><span class="n">File</span><span class="o">.</span><span class="n">RID</span><span class="p">,</span>
        <span class="n">path</span><span class="o">.</span><span class="n">File</span><span class="o">.</span><span class="n">URL</span><span class="p">,</span>
        <span class="n">path</span><span class="o">.</span><span class="n">File</span><span class="o">.</span><span class="n">MD5</span><span class="p">,</span>
        <span class="n">path</span><span class="o">.</span><span class="n">File</span><span class="o">.</span><span class="n">Length</span><span class="p">,</span>
        <span class="n">path</span><span class="o">.</span><span class="n">File</span><span class="o">.</span><span class="n">Description</span><span class="p">,</span>
        <span class="n">path</span><span class="o">.</span><span class="n">AT</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">asset_type_fk</span><span class="p">],</span>
    <span class="p">)</span>

    <span class="n">file_map</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">path</span><span class="o">.</span><span class="n">fetch</span><span class="p">():</span>
        <span class="n">entry</span> <span class="o">=</span> <span class="n">file_map</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="s2">&quot;RID&quot;</span><span class="p">],</span> <span class="p">{</span><span class="o">**</span><span class="n">f</span><span class="p">,</span> <span class="s2">&quot;File_Types&quot;</span><span class="p">:</span> <span class="p">[]})</span>
        <span class="k">if</span> <span class="n">ft</span> <span class="o">:=</span> <span class="n">f</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Asset_Type&quot;</span><span class="p">):</span>  <span class="c1"># assign-and-test in one go</span>
            <span class="n">entry</span><span class="p">[</span><span class="s2">&quot;File_Types&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ft</span><span class="p">)</span>

    <span class="c1"># Now get rid of the File_Type key and return the result</span>
    <span class="k">return</span> <span class="p">[(</span><span class="n">f</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;Asset_Type&quot;</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">file_map</span><span class="o">.</span><span class="n">values</span><span class="p">()]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="deriva_ml.core.DerivaML.list_foreign_keys" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">list_foreign_keys</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">list_foreign_keys</span><span class="p">(</span>
    <span class="n">table</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Table</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>List all foreign keys related to a table.</p>
<p>Returns both outbound foreign keys (from this table to others) and
inbound foreign keys (from other tables to this one). Useful for
determining valid constraint names for visible-columns and
visible-foreign-keys annotations.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>table</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <span title="deriva_ml.core.mixins.annotation.Table">Table</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Table name or Table object.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary with:</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <ul>
<li>table: Table name</li>
</ul>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <ul>
<li>outbound: List of outbound foreign keys</li>
</ul>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <ul>
<li>inbound: List of inbound foreign keys</li>
</ul>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Each foreign key contains constraint_name, from_table, from_columns,</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>to_table, to_columns.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>fkeys = ml.list_foreign_keys("Image")
for fk in fkeys["outbound"]:
...     print(f"{fk['constraint_name']} -&gt; {fk['to_table']}")</p>
</blockquote>
</blockquote>
</blockquote>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/deriva_ml/core/mixins/annotation.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="n">ConfigDict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="k">def</span><span class="w"> </span><span class="nf">list_foreign_keys</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Table</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;List all foreign keys related to a table.</span>

<span class="sd">    Returns both outbound foreign keys (from this table to others) and</span>
<span class="sd">    inbound foreign keys (from other tables to this one). Useful for</span>
<span class="sd">    determining valid constraint names for visible-columns and</span>
<span class="sd">    visible-foreign-keys annotations.</span>

<span class="sd">    Args:</span>
<span class="sd">        table: Table name or Table object.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dictionary with:</span>
<span class="sd">        - table: Table name</span>
<span class="sd">        - outbound: List of outbound foreign keys</span>
<span class="sd">        - inbound: List of inbound foreign keys</span>
<span class="sd">        Each foreign key contains constraint_name, from_table, from_columns,</span>
<span class="sd">        to_table, to_columns.</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; fkeys = ml.list_foreign_keys(&quot;Image&quot;)</span>
<span class="sd">        &gt;&gt;&gt; for fk in fkeys[&quot;outbound&quot;]:</span>
<span class="sd">        ...     print(f&quot;{fk[&#39;constraint_name&#39;]} -&gt; {fk[&#39;to_table&#39;]}&quot;)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">table_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">name_to_table</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>

    <span class="n">outbound</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">fkey</span> <span class="ow">in</span> <span class="n">table_obj</span><span class="o">.</span><span class="n">foreign_keys</span><span class="p">:</span>
        <span class="n">outbound</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
            <span class="s2">&quot;constraint_name&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">fkey</span><span class="o">.</span><span class="n">constraint_schema</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">fkey</span><span class="o">.</span><span class="n">constraint_name</span><span class="p">],</span>
            <span class="s2">&quot;from_table&quot;</span><span class="p">:</span> <span class="n">table_obj</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
            <span class="s2">&quot;from_columns&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">col</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">fkey</span><span class="o">.</span><span class="n">columns</span><span class="p">],</span>
            <span class="s2">&quot;to_table&quot;</span><span class="p">:</span> <span class="n">fkey</span><span class="o">.</span><span class="n">pk_table</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
            <span class="s2">&quot;to_columns&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">col</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">fkey</span><span class="o">.</span><span class="n">referenced_columns</span><span class="p">],</span>
        <span class="p">})</span>

    <span class="n">inbound</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">fkey</span> <span class="ow">in</span> <span class="n">table_obj</span><span class="o">.</span><span class="n">referenced_by</span><span class="p">:</span>
        <span class="n">inbound</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
            <span class="s2">&quot;constraint_name&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">fkey</span><span class="o">.</span><span class="n">constraint_schema</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">fkey</span><span class="o">.</span><span class="n">constraint_name</span><span class="p">],</span>
            <span class="s2">&quot;from_table&quot;</span><span class="p">:</span> <span class="n">fkey</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
            <span class="s2">&quot;from_columns&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">col</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">fkey</span><span class="o">.</span><span class="n">columns</span><span class="p">],</span>
            <span class="s2">&quot;to_table&quot;</span><span class="p">:</span> <span class="n">table_obj</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
            <span class="s2">&quot;to_columns&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">col</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">fkey</span><span class="o">.</span><span class="n">referenced_columns</span><span class="p">],</span>
        <span class="p">})</span>

    <span class="k">return</span> <span class="p">{</span>
        <span class="s2">&quot;table&quot;</span><span class="p">:</span> <span class="n">table_obj</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
        <span class="s2">&quot;outbound&quot;</span><span class="p">:</span> <span class="n">outbound</span><span class="p">,</span>
        <span class="s2">&quot;inbound&quot;</span><span class="p">:</span> <span class="n">inbound</span><span class="p">,</span>
    <span class="p">}</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="deriva_ml.core.DerivaML.list_vocabulary_terms" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">list_vocabulary_terms</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">list_vocabulary_terms</span><span class="p">(</span>
    <span class="n">table</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Table</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">VocabularyTerm</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Lists all terms in a vocabulary table.</p>
<p>Retrieves all terms, their descriptions, and synonyms from a controlled vocabulary table.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>table</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <span title="deriva_ml.core.mixins.vocabulary.Table">Table</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Vocabulary table to list terms from (name or Table object).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<a class="autorefs autorefs-internal" title="VocabularyTerm (deriva_ml.core.definitions.VocabularyTerm)" href="../deriva_definitions/#deriva_ml.core.definitions.VocabularyTerm">VocabularyTerm</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>list[VocabularyTerm]: List of vocabulary terms with their metadata.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="DerivaMLException (deriva_ml.core.exceptions.DerivaMLException)" href="../exceptions/#deriva_ml.core.exceptions.DerivaMLException">DerivaMLException</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If table doesn't exist or is not a vocabulary table.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">terms</span> <span class="o">=</span> <span class="n">ml</span><span class="o">.</span><span class="n">list_vocabulary_terms</span><span class="p">(</span><span class="s2">&quot;tissue_types&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">term</span> <span class="ow">in</span> <span class="n">terms</span><span class="p">:</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">term</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">term</span><span class="o">.</span><span class="n">description</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="k">if</span> <span class="n">term</span><span class="o">.</span><span class="n">synonyms</span><span class="p">:</span>
<span class="gp">... </span>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Synonyms: </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">term</span><span class="o">.</span><span class="n">synonyms</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/deriva_ml/core/mixins/vocabulary.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">list_vocabulary_terms</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Table</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">VocabularyTerm</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Lists all terms in a vocabulary table.</span>

<span class="sd">    Retrieves all terms, their descriptions, and synonyms from a controlled vocabulary table.</span>

<span class="sd">    Args:</span>
<span class="sd">        table: Vocabulary table to list terms from (name or Table object).</span>

<span class="sd">    Returns:</span>
<span class="sd">        list[VocabularyTerm]: List of vocabulary terms with their metadata.</span>

<span class="sd">    Raises:</span>
<span class="sd">        DerivaMLException: If table doesn&#39;t exist or is not a vocabulary table.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; terms = ml.list_vocabulary_terms(&quot;tissue_types&quot;)</span>
<span class="sd">        &gt;&gt;&gt; for term in terms:</span>
<span class="sd">        ...     print(f&quot;{term.name}: {term.description}&quot;)</span>
<span class="sd">        ...     if term.synonyms:</span>
<span class="sd">        ...         print(f&quot;  Synonyms: {&#39;, &#39;.join(term.synonyms)}&quot;)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Get path builder and table reference</span>
    <span class="n">pb</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pathBuilder</span><span class="p">()</span>
    <span class="n">table</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">name_to_table</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">value</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">MLVocab</span><span class="p">)</span> <span class="k">else</span> <span class="n">table</span><span class="p">)</span>

    <span class="c1"># Validate table is a vocabulary table</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">is_vocabulary</span><span class="p">(</span><span class="n">table</span><span class="p">)):</span>
        <span class="k">raise</span> <span class="n">DerivaMLException</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The table </span><span class="si">{</span><span class="n">table</span><span class="si">}</span><span class="s2"> is not a controlled vocabulary&quot;</span><span class="p">)</span>

    <span class="c1"># Fetch and convert all terms to VocabularyTerm objects</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">VocabularyTerm</span><span class="p">(</span><span class="o">**</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">pb</span><span class="o">.</span><span class="n">schemas</span><span class="p">[</span><span class="n">table</span><span class="o">.</span><span class="n">schema</span><span class="o">.</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">tables</span><span class="p">[</span><span class="n">table</span><span class="o">.</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">entities</span><span class="p">()</span><span class="o">.</span><span class="n">fetch</span><span class="p">()]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="deriva_ml.core.DerivaML.lookup_asset" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">lookup_asset</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">lookup_asset</span><span class="p">(</span><span class="n">asset_rid</span><span class="p">:</span> <span class="n">RID</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Asset&#39;</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Look up an asset by its RID.</p>
<p>Returns an Asset object for the specified RID. The asset can be from
any asset table in the catalog.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>asset_rid</code>
            </td>
            <td>
                  <code><span title="deriva_ml.core.definitions.RID">RID</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The RID of the asset to look up.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>&#39;Asset&#39;</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Asset object for the specified RID.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="DerivaMLException (deriva_ml.core.exceptions.DerivaMLException)" href="../exceptions/#deriva_ml.core.exceptions.DerivaMLException">DerivaMLException</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the RID is not found or is not an asset.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>asset = ml.lookup_asset("3JSE")
print(f"File: {asset.filename}, Table: {asset.asset_table}")</p>
</blockquote>
</blockquote>
</blockquote>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/deriva_ml/core/mixins/asset.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">lookup_asset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">asset_rid</span><span class="p">:</span> <span class="n">RID</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Asset&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Look up an asset by its RID.</span>

<span class="sd">    Returns an Asset object for the specified RID. The asset can be from</span>
<span class="sd">    any asset table in the catalog.</span>

<span class="sd">    Args:</span>
<span class="sd">        asset_rid: The RID of the asset to look up.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Asset object for the specified RID.</span>

<span class="sd">    Raises:</span>
<span class="sd">        DerivaMLException: If the RID is not found or is not an asset.</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; asset = ml.lookup_asset(&quot;3JSE&quot;)</span>
<span class="sd">        &gt;&gt;&gt; print(f&quot;File: {asset.filename}, Table: {asset.asset_table}&quot;)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">deriva_ml.asset.asset</span><span class="w"> </span><span class="kn">import</span> <span class="n">Asset</span>

    <span class="c1"># Resolve the RID to find which table it belongs to</span>
    <span class="n">rid_info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">resolve_rid</span><span class="p">(</span><span class="n">asset_rid</span><span class="p">)</span>  <span class="c1"># type: ignore[attr-defined]</span>
    <span class="n">asset_table</span> <span class="o">=</span> <span class="n">rid_info</span><span class="o">.</span><span class="n">table</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">is_asset</span><span class="p">(</span><span class="n">asset_table</span><span class="p">):</span>
        <span class="k">raise</span> <span class="n">DerivaMLException</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;RID </span><span class="si">{</span><span class="n">asset_rid</span><span class="si">}</span><span class="s2"> is not an asset (table: </span><span class="si">{</span><span class="n">asset_table</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>

    <span class="c1"># Query the asset table for this record</span>
    <span class="n">pb</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pathBuilder</span><span class="p">()</span>
    <span class="n">asset_path</span> <span class="o">=</span> <span class="n">pb</span><span class="o">.</span><span class="n">schemas</span><span class="p">[</span><span class="n">asset_table</span><span class="o">.</span><span class="n">schema</span><span class="o">.</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">tables</span><span class="p">[</span><span class="n">asset_table</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>

    <span class="n">records</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">asset_path</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">asset_path</span><span class="o">.</span><span class="n">RID</span> <span class="o">==</span> <span class="n">asset_rid</span><span class="p">)</span><span class="o">.</span><span class="n">entities</span><span class="p">()</span><span class="o">.</span><span class="n">fetch</span><span class="p">())</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">records</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">DerivaMLException</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Asset </span><span class="si">{</span><span class="n">asset_rid</span><span class="si">}</span><span class="s2"> not found in table </span><span class="si">{</span><span class="n">asset_table</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">record</span> <span class="o">=</span> <span class="n">records</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="c1"># Get asset types</span>
    <span class="n">asset_types</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">type_assoc_table</span><span class="p">,</span> <span class="n">asset_fk</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">find_association</span><span class="p">(</span><span class="n">asset_table</span><span class="p">,</span> <span class="s2">&quot;Asset_Type&quot;</span><span class="p">)</span>
        <span class="n">type_path</span> <span class="o">=</span> <span class="n">pb</span><span class="o">.</span><span class="n">schemas</span><span class="p">[</span><span class="n">type_assoc_table</span><span class="o">.</span><span class="n">schema</span><span class="o">.</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">tables</span><span class="p">[</span><span class="n">type_assoc_table</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
        <span class="n">types</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span>
            <span class="n">type_path</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">type_path</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">asset_fk</span><span class="p">]</span> <span class="o">==</span> <span class="n">asset_rid</span><span class="p">)</span>
            <span class="o">.</span><span class="n">attributes</span><span class="p">(</span><span class="n">type_path</span><span class="o">.</span><span class="n">Asset_Type</span><span class="p">)</span>
            <span class="o">.</span><span class="n">fetch</span><span class="p">()</span>
        <span class="p">)</span>
        <span class="n">asset_types</span> <span class="o">=</span> <span class="p">[</span><span class="n">t</span><span class="p">[</span><span class="s2">&quot;Asset_Type&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">types</span><span class="p">]</span>
    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
        <span class="k">pass</span>  <span class="c1"># No type association for this asset table</span>

    <span class="k">return</span> <span class="n">Asset</span><span class="p">(</span>
        <span class="n">catalog</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span>  <span class="c1"># type: ignore[arg-type]</span>
        <span class="n">asset_rid</span><span class="o">=</span><span class="n">asset_rid</span><span class="p">,</span>
        <span class="n">asset_table</span><span class="o">=</span><span class="n">asset_table</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
        <span class="n">filename</span><span class="o">=</span><span class="n">record</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Filename&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span>
        <span class="n">url</span><span class="o">=</span><span class="n">record</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;URL&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span>
        <span class="n">length</span><span class="o">=</span><span class="n">record</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Length&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
        <span class="n">md5</span><span class="o">=</span><span class="n">record</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;MD5&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span>
        <span class="n">description</span><span class="o">=</span><span class="n">record</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Description&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span>
        <span class="n">asset_types</span><span class="o">=</span><span class="n">asset_types</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="deriva_ml.core.DerivaML.lookup_dataset" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">lookup_dataset</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">lookup_dataset</span><span class="p">(</span>
    <span class="n">dataset</span><span class="p">:</span> <span class="n">RID</span> <span class="o">|</span> <span class="n">DatasetSpec</span><span class="p">,</span>
    <span class="n">deleted</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Dataset&quot;</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Look up a dataset by RID or DatasetSpec.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>dataset</code>
            </td>
            <td>
                  <code><span title="deriva_ml.core.definitions.RID">RID</span> | <a class="autorefs autorefs-internal" title="DatasetSpec (deriva_ml.dataset.aux_classes.DatasetSpec)" href="../dataset_aux_classes/#deriva_ml.dataset.aux_classes.DatasetSpec">DatasetSpec</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dataset RID or DatasetSpec to look up.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>deleted</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, include datasets that have been marked as deleted.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>Dataset</code></td>            <td>
                  <code>&#39;Dataset&#39;</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The dataset object for the specified RID.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="DerivaMLException (deriva_ml.core.exceptions.DerivaMLException)" href="../exceptions/#deriva_ml.core.exceptions.DerivaMLException">DerivaMLException</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the dataset is not found.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>dataset = ml.lookup_dataset("4HM")
print(f"Version: {dataset.current_version}")</p>
</blockquote>
</blockquote>
</blockquote>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/deriva_ml/core/mixins/dataset.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">lookup_dataset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset</span><span class="p">:</span> <span class="n">RID</span> <span class="o">|</span> <span class="n">DatasetSpec</span><span class="p">,</span> <span class="n">deleted</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Dataset&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Look up a dataset by RID or DatasetSpec.</span>

<span class="sd">    Args:</span>
<span class="sd">        dataset: Dataset RID or DatasetSpec to look up.</span>
<span class="sd">        deleted: If True, include datasets that have been marked as deleted.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dataset: The dataset object for the specified RID.</span>

<span class="sd">    Raises:</span>
<span class="sd">        DerivaMLException: If the dataset is not found.</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; dataset = ml.lookup_dataset(&quot;4HM&quot;)</span>
<span class="sd">        &gt;&gt;&gt; print(f&quot;Version: {dataset.current_version}&quot;)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">DatasetSpec</span><span class="p">):</span>
        <span class="n">dataset_rid</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">rid</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">dataset_rid</span> <span class="o">=</span> <span class="n">dataset</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">ds</span> <span class="k">for</span> <span class="n">ds</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_datasets</span><span class="p">(</span><span class="n">deleted</span><span class="o">=</span><span class="n">deleted</span><span class="p">)</span> <span class="k">if</span> <span class="n">ds</span><span class="o">.</span><span class="n">dataset_rid</span> <span class="o">==</span> <span class="n">dataset_rid</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">DerivaMLException</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Dataset </span><span class="si">{</span><span class="n">dataset_rid</span><span class="si">}</span><span class="s2"> not found.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="deriva_ml.core.DerivaML.lookup_execution" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">lookup_execution</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">lookup_execution</span><span class="p">(</span>
    <span class="n">execution_rid</span><span class="p">:</span> <span class="n">RID</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;ExecutionRecord&quot;</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Look up an execution by RID and return an ExecutionRecord.</p>
<p>Creates an ExecutionRecord object for querying and modifying execution
metadata. The ExecutionRecord provides access to the catalog record
state and allows updating mutable properties like status and description.</p>
<p>For running computations with datasets and assets, use <code>restore_execution()</code>
or <code>create_execution()</code> which return full Execution objects.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>execution_rid</code>
            </td>
            <td>
                  <code><span title="deriva_ml.core.definitions.RID">RID</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Resource Identifier (RID) of the execution.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>ExecutionRecord</code></td>            <td>
                  <code>&#39;ExecutionRecord&#39;</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An execution record object bound to the catalog.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="DerivaMLException (deriva_ml.core.exceptions.DerivaMLException)" href="../exceptions/#deriva_ml.core.exceptions.DerivaMLException">DerivaMLException</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If execution_rid is not valid or doesn't refer
to an Execution record.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <p>Look up an execution and query its state::</p>
<pre><code>&gt;&gt;&gt; record = ml.lookup_execution("1-abc123")
&gt;&gt;&gt; print(f"Status: {record.status}")
&gt;&gt;&gt; print(f"Description: {record.description}")
</code></pre>
<p>Update mutable properties::</p>
<pre><code>&gt;&gt;&gt; record.status = Status.completed
&gt;&gt;&gt; record.description = "Analysis finished"
</code></pre>
<p>Query relationships::</p>
<pre><code>&gt;&gt;&gt; children = list(record.list_nested_executions())
&gt;&gt;&gt; parents = list(record.list_parent_executions())
</code></pre>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/deriva_ml/core/mixins/execution.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">lookup_execution</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">execution_rid</span><span class="p">:</span> <span class="n">RID</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;ExecutionRecord&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Look up an execution by RID and return an ExecutionRecord.</span>

<span class="sd">    Creates an ExecutionRecord object for querying and modifying execution</span>
<span class="sd">    metadata. The ExecutionRecord provides access to the catalog record</span>
<span class="sd">    state and allows updating mutable properties like status and description.</span>

<span class="sd">    For running computations with datasets and assets, use ``restore_execution()``</span>
<span class="sd">    or ``create_execution()`` which return full Execution objects.</span>

<span class="sd">    Args:</span>
<span class="sd">        execution_rid: Resource Identifier (RID) of the execution.</span>

<span class="sd">    Returns:</span>
<span class="sd">        ExecutionRecord: An execution record object bound to the catalog.</span>

<span class="sd">    Raises:</span>
<span class="sd">        DerivaMLException: If execution_rid is not valid or doesn&#39;t refer</span>
<span class="sd">            to an Execution record.</span>

<span class="sd">    Example:</span>
<span class="sd">        Look up an execution and query its state::</span>

<span class="sd">            &gt;&gt;&gt; record = ml.lookup_execution(&quot;1-abc123&quot;)</span>
<span class="sd">            &gt;&gt;&gt; print(f&quot;Status: {record.status}&quot;)</span>
<span class="sd">            &gt;&gt;&gt; print(f&quot;Description: {record.description}&quot;)</span>

<span class="sd">        Update mutable properties::</span>

<span class="sd">            &gt;&gt;&gt; record.status = Status.completed</span>
<span class="sd">            &gt;&gt;&gt; record.description = &quot;Analysis finished&quot;</span>

<span class="sd">        Query relationships::</span>

<span class="sd">            &gt;&gt;&gt; children = list(record.list_nested_executions())</span>
<span class="sd">            &gt;&gt;&gt; parents = list(record.list_parent_executions())</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Import here to avoid circular dependency</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">deriva_ml.execution.execution_record</span><span class="w"> </span><span class="kn">import</span> <span class="n">ExecutionRecord</span>

    <span class="c1"># Get execution record from catalog and verify it&#39;s an Execution</span>
    <span class="n">resolved</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">resolve_rid</span><span class="p">(</span><span class="n">execution_rid</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">resolved</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">name</span> <span class="o">!=</span> <span class="s2">&quot;Execution&quot;</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">DerivaMLException</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;RID &#39;</span><span class="si">{</span><span class="n">execution_rid</span><span class="si">}</span><span class="s2">&#39; refers to a </span><span class="si">{</span><span class="n">resolved</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">, not an Execution&quot;</span>
        <span class="p">)</span>

    <span class="n">execution_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">retrieve_rid</span><span class="p">(</span><span class="n">execution_rid</span><span class="p">)</span>

    <span class="c1"># Parse timestamps if present</span>
    <span class="n">start_time</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">stop_time</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="n">execution_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Start&quot;</span><span class="p">):</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">start_time</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">fromisoformat</span><span class="p">(</span><span class="n">execution_data</span><span class="p">[</span><span class="s2">&quot;Start&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;Z&quot;</span><span class="p">,</span> <span class="s2">&quot;+00:00&quot;</span><span class="p">))</span>
        <span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="ne">AttributeError</span><span class="p">):</span>
            <span class="k">pass</span>
    <span class="k">if</span> <span class="n">execution_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Stop&quot;</span><span class="p">):</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">stop_time</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">fromisoformat</span><span class="p">(</span><span class="n">execution_data</span><span class="p">[</span><span class="s2">&quot;Stop&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;Z&quot;</span><span class="p">,</span> <span class="s2">&quot;+00:00&quot;</span><span class="p">))</span>
        <span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="ne">AttributeError</span><span class="p">):</span>
            <span class="k">pass</span>

    <span class="c1"># Look up the workflow if present</span>
    <span class="n">workflow_rid</span> <span class="o">=</span> <span class="n">execution_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Workflow&quot;</span><span class="p">)</span>
    <span class="n">workflow</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lookup_workflow</span><span class="p">(</span><span class="n">workflow_rid</span><span class="p">)</span> <span class="k">if</span> <span class="n">workflow_rid</span> <span class="k">else</span> <span class="kc">None</span>

    <span class="c1"># Create ExecutionRecord bound to this catalog</span>
    <span class="n">record</span> <span class="o">=</span> <span class="n">ExecutionRecord</span><span class="p">(</span>
        <span class="n">execution_rid</span><span class="o">=</span><span class="n">execution_rid</span><span class="p">,</span>
        <span class="n">workflow</span><span class="o">=</span><span class="n">workflow</span><span class="p">,</span>
        <span class="n">status</span><span class="o">=</span><span class="n">Status</span><span class="p">(</span><span class="n">execution_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Status&quot;</span><span class="p">,</span> <span class="s2">&quot;Created&quot;</span><span class="p">)),</span>
        <span class="n">description</span><span class="o">=</span><span class="n">execution_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Description&quot;</span><span class="p">),</span>
        <span class="n">start_time</span><span class="o">=</span><span class="n">start_time</span><span class="p">,</span>
        <span class="n">stop_time</span><span class="o">=</span><span class="n">stop_time</span><span class="p">,</span>
        <span class="n">duration</span><span class="o">=</span><span class="n">execution_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Duration&quot;</span><span class="p">),</span>
        <span class="n">_ml_instance</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span>
        <span class="n">_logger</span><span class="o">=</span><span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;_logger&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">record</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="deriva_ml.core.DerivaML.lookup_experiment" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">lookup_experiment</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">lookup_experiment</span><span class="p">(</span>
    <span class="n">execution_rid</span><span class="p">:</span> <span class="n">RID</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Experiment&quot;</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Look up an experiment by execution RID.</p>
<p>Creates an Experiment object for analyzing completed executions.
Provides convenient access to execution metadata, configuration choices,
model parameters, inputs, and outputs.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>execution_rid</code>
            </td>
            <td>
                  <code><span title="deriva_ml.core.definitions.RID">RID</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Resource Identifier (RID) of the execution.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>Experiment</code></td>            <td>
                  <code>&#39;Experiment&#39;</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An experiment object for the given execution RID.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>exp = ml.lookup_experiment("47BE")
print(exp.name)  # e.g., "cifar10_quick"
print(exp.config_choices)  # Hydra config names used
print(exp.model_config)  # Model hyperparameters</p>
</blockquote>
</blockquote>
</blockquote>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/deriva_ml/core/mixins/execution.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">lookup_experiment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">execution_rid</span><span class="p">:</span> <span class="n">RID</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Experiment&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Look up an experiment by execution RID.</span>

<span class="sd">    Creates an Experiment object for analyzing completed executions.</span>
<span class="sd">    Provides convenient access to execution metadata, configuration choices,</span>
<span class="sd">    model parameters, inputs, and outputs.</span>

<span class="sd">    Args:</span>
<span class="sd">        execution_rid: Resource Identifier (RID) of the execution.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Experiment: An experiment object for the given execution RID.</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; exp = ml.lookup_experiment(&quot;47BE&quot;)</span>
<span class="sd">        &gt;&gt;&gt; print(exp.name)  # e.g., &quot;cifar10_quick&quot;</span>
<span class="sd">        &gt;&gt;&gt; print(exp.config_choices)  # Hydra config names used</span>
<span class="sd">        &gt;&gt;&gt; print(exp.model_config)  # Model hyperparameters</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">deriva_ml.experiment</span><span class="w"> </span><span class="kn">import</span> <span class="n">Experiment</span>

    <span class="k">return</span> <span class="n">Experiment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">execution_rid</span><span class="p">)</span>  <span class="c1"># type: ignore[arg-type]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="deriva_ml.core.DerivaML.lookup_feature" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">lookup_feature</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">lookup_feature</span><span class="p">(</span>
    <span class="n">table</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Table</span><span class="p">,</span>
    <span class="n">feature_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Feature</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Retrieves a Feature object.</p>
<p>Looks up and returns a Feature object that provides an interface to work with an existing feature
definition in the catalog.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>table</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <span title="deriva_ml.core.mixins.feature.Table">Table</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The table containing the feature, either as name or Table object.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>feature_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the feature to look up.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>Feature</code></td>            <td>
                  <code><a class="autorefs autorefs-internal" title="Feature (deriva_ml.feature.Feature)" href="../feature/#deriva_ml.feature.Feature">Feature</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An object representing the feature and its implementation.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="DerivaMLException (deriva_ml.core.exceptions.DerivaMLException)" href="../exceptions/#deriva_ml.core.exceptions.DerivaMLException">DerivaMLException</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the feature doesn't exist in the specified table.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>feature = ml.lookup_feature("samples", "expression_level")
print(feature.feature_name)
'expression_level'</p>
</blockquote>
</blockquote>
</blockquote>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/deriva_ml/core/mixins/feature.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">lookup_feature</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Table</span><span class="p">,</span> <span class="n">feature_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Feature</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Retrieves a Feature object.</span>

<span class="sd">    Looks up and returns a Feature object that provides an interface to work with an existing feature</span>
<span class="sd">    definition in the catalog.</span>

<span class="sd">    Args:</span>
<span class="sd">        table: The table containing the feature, either as name or Table object.</span>
<span class="sd">        feature_name: Name of the feature to look up.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Feature: An object representing the feature and its implementation.</span>

<span class="sd">    Raises:</span>
<span class="sd">        DerivaMLException: If the feature doesn&#39;t exist in the specified table.</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; feature = ml.lookup_feature(&quot;samples&quot;, &quot;expression_level&quot;)</span>
<span class="sd">        &gt;&gt;&gt; print(feature.feature_name)</span>
<span class="sd">        &#39;expression_level&#39;</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">lookup_feature</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">feature_name</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="deriva_ml.core.DerivaML.lookup_term" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">lookup_term</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">lookup_term</span><span class="p">(</span>
    <span class="n">table</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Table</span><span class="p">,</span> <span class="n">term_name</span><span class="p">:</span> <span class="nb">str</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">VocabularyTermHandle</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Finds a term in a vocabulary table.</p>
<p>Searches for a term in the specified vocabulary table, matching either the primary name
or any of its synonyms. Results are cached for performance - subsequent lookups in the
same vocabulary table are served from cache.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>table</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <span title="deriva_ml.core.mixins.vocabulary.Table">Table</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Vocabulary table to search in (name or Table object).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>term_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name or synonym of the term to find.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>VocabularyTermHandle</code></td>            <td>
                  <code><a class="autorefs autorefs-internal" title="VocabularyTermHandle (deriva_ml.core.definitions.VocabularyTermHandle)" href="../deriva_definitions/#deriva_ml.core.definitions.VocabularyTermHandle">VocabularyTermHandle</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The matching vocabulary term, with methods to modify it.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="DerivaMLVocabularyException">DerivaMLVocabularyException</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the table is not a vocabulary table, or term is not found.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <p>Look up by primary name:
    &gt;&gt;&gt; term = ml.lookup_term("tissue_types", "epithelial")
    &gt;&gt;&gt; print(term.description)</p>
<p>Look up by synonym:
    &gt;&gt;&gt; term = ml.lookup_term("tissue_types", "epithelium")</p>
<p>Modify the term:
    &gt;&gt;&gt; term = ml.lookup_term("tissue_types", "epithelial")
    &gt;&gt;&gt; term.description = "Updated description"
    &gt;&gt;&gt; term.synonyms = ("epithelium", "epithelial_tissue")</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/deriva_ml/core/mixins/vocabulary.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="n">ConfigDict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="k">def</span><span class="w"> </span><span class="nf">lookup_term</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Table</span><span class="p">,</span> <span class="n">term_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">VocabularyTermHandle</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Finds a term in a vocabulary table.</span>

<span class="sd">    Searches for a term in the specified vocabulary table, matching either the primary name</span>
<span class="sd">    or any of its synonyms. Results are cached for performance - subsequent lookups in the</span>
<span class="sd">    same vocabulary table are served from cache.</span>

<span class="sd">    Args:</span>
<span class="sd">        table: Vocabulary table to search in (name or Table object).</span>
<span class="sd">        term_name: Name or synonym of the term to find.</span>

<span class="sd">    Returns:</span>
<span class="sd">        VocabularyTermHandle: The matching vocabulary term, with methods to modify it.</span>

<span class="sd">    Raises:</span>
<span class="sd">        DerivaMLVocabularyException: If the table is not a vocabulary table, or term is not found.</span>

<span class="sd">    Examples:</span>
<span class="sd">        Look up by primary name:</span>
<span class="sd">            &gt;&gt;&gt; term = ml.lookup_term(&quot;tissue_types&quot;, &quot;epithelial&quot;)</span>
<span class="sd">            &gt;&gt;&gt; print(term.description)</span>

<span class="sd">        Look up by synonym:</span>
<span class="sd">            &gt;&gt;&gt; term = ml.lookup_term(&quot;tissue_types&quot;, &quot;epithelium&quot;)</span>

<span class="sd">        Modify the term:</span>
<span class="sd">            &gt;&gt;&gt; term = ml.lookup_term(&quot;tissue_types&quot;, &quot;epithelial&quot;)</span>
<span class="sd">            &gt;&gt;&gt; term.description = &quot;Updated description&quot;</span>
<span class="sd">            &gt;&gt;&gt; term.synonyms = (&quot;epithelium&quot;, &quot;epithelial_tissue&quot;)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Get and validate vocabulary table reference</span>
    <span class="n">vocab_table</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">name_to_table</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">is_vocabulary</span><span class="p">(</span><span class="n">vocab_table</span><span class="p">):</span>
        <span class="k">raise</span> <span class="n">DerivaMLException</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The table </span><span class="si">{</span><span class="n">table</span><span class="si">}</span><span class="s2"> is not a controlled vocabulary&quot;</span><span class="p">)</span>

    <span class="c1"># Get schema and table names</span>
    <span class="n">schema_name</span><span class="p">,</span> <span class="n">table_name</span> <span class="o">=</span> <span class="n">vocab_table</span><span class="o">.</span><span class="n">schema</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">vocab_table</span><span class="o">.</span><span class="n">name</span>
    <span class="n">cache_key</span> <span class="o">=</span> <span class="p">(</span><span class="n">schema_name</span><span class="p">,</span> <span class="n">table_name</span><span class="p">)</span>

    <span class="c1"># Check cache first</span>
    <span class="n">cache</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_vocab_cache</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">cache_key</span> <span class="ow">in</span> <span class="n">cache</span><span class="p">:</span>
        <span class="n">term_lookup</span> <span class="o">=</span> <span class="n">cache</span><span class="p">[</span><span class="n">cache_key</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">term_name</span> <span class="ow">in</span> <span class="n">term_lookup</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">term_lookup</span><span class="p">[</span><span class="n">term_name</span><span class="p">]</span>
        <span class="c1"># Term not in cache - might be newly added, try server-side lookup</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Vocabulary not cached yet - try server-side lookup first for single term</span>
        <span class="n">term</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_server_lookup_term</span><span class="p">(</span><span class="n">schema_name</span><span class="p">,</span> <span class="n">table_name</span><span class="p">,</span> <span class="n">term_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">term</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># Found it - populate the full cache for future lookups</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_populate_vocab_cache</span><span class="p">(</span><span class="n">schema_name</span><span class="p">,</span> <span class="n">table_name</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_vocab_cache</span><span class="p">()[</span><span class="n">cache_key</span><span class="p">][</span><span class="n">term_name</span><span class="p">]</span>
        <span class="c1"># Not found by name - need to check synonyms, populate cache</span>
        <span class="n">term_lookup</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_populate_vocab_cache</span><span class="p">(</span><span class="n">schema_name</span><span class="p">,</span> <span class="n">table_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">term_name</span> <span class="ow">in</span> <span class="n">term_lookup</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">term_lookup</span><span class="p">[</span><span class="n">term_name</span><span class="p">]</span>
        <span class="k">raise</span> <span class="n">DerivaMLInvalidTerm</span><span class="p">(</span><span class="n">table_name</span><span class="p">,</span> <span class="n">term_name</span><span class="p">)</span>

    <span class="c1"># Term not in cache - try server-side lookup (might be newly added)</span>
    <span class="n">term</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_server_lookup_term</span><span class="p">(</span><span class="n">schema_name</span><span class="p">,</span> <span class="n">table_name</span><span class="p">,</span> <span class="n">term_name</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">term</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># Refresh cache to get the VocabularyTermHandle</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_populate_vocab_cache</span><span class="p">(</span><span class="n">schema_name</span><span class="p">,</span> <span class="n">table_name</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_vocab_cache</span><span class="p">()[</span><span class="n">cache_key</span><span class="p">][</span><span class="n">term_name</span><span class="p">]</span>

    <span class="c1"># Still not found - refresh cache and try one more time</span>
    <span class="n">term_lookup</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_populate_vocab_cache</span><span class="p">(</span><span class="n">schema_name</span><span class="p">,</span> <span class="n">table_name</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">term_name</span> <span class="ow">in</span> <span class="n">term_lookup</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">term_lookup</span><span class="p">[</span><span class="n">term_name</span><span class="p">]</span>

    <span class="c1"># Term not found</span>
    <span class="k">raise</span> <span class="n">DerivaMLInvalidTerm</span><span class="p">(</span><span class="n">table_name</span><span class="p">,</span> <span class="n">term_name</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="deriva_ml.core.DerivaML.lookup_workflow" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">lookup_workflow</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">lookup_workflow</span><span class="p">(</span><span class="n">rid</span><span class="p">:</span> <span class="n">RID</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Workflow</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Look up a workflow by its Resource Identifier (RID).</p>
<p>Retrieves a workflow from the catalog by its RID and returns a Workflow
object bound to the catalog. The returned Workflow can be modified (e.g.,
updating its description) and changes will be reflected in the catalog.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>rid</code>
            </td>
            <td>
                  <code><span title="deriva_ml.core.definitions.RID">RID</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Resource Identifier of the workflow to look up.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>Workflow</code></td>            <td>
                  <code><a class="autorefs autorefs-internal" title="Workflow (deriva_ml.execution.workflow.Workflow)" href="../workflow/#deriva_ml.execution.workflow.Workflow">Workflow</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The workflow object bound to this catalog, allowing
properties like <code>description</code> to be updated.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="DerivaMLException (deriva_ml.core.exceptions.DerivaMLException)" href="../exceptions/#deriva_ml.core.exceptions.DerivaMLException">DerivaMLException</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the RID does not correspond to a workflow
in the catalog.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <p>Look up a workflow and read its properties::</p>
<pre><code>&gt;&gt;&gt; workflow = ml.lookup_workflow("2-ABC1")
&gt;&gt;&gt; print(f"Name: {workflow.name}")
&gt;&gt;&gt; print(f"Description: {workflow.description}")
&gt;&gt;&gt; print(f"Type: {workflow.workflow_type}")
</code></pre>
<p>Update a workflow's description (persisted to catalog)::</p>
<pre><code>&gt;&gt;&gt; workflow = ml.lookup_workflow("2-ABC1")
&gt;&gt;&gt; workflow.description = "Updated analysis pipeline for RNA sequences"
&gt;&gt;&gt; # The change is immediately written to the catalog
</code></pre>
<p>Attempting to update on a read-only catalog raises an error::</p>
<pre><code>&gt;&gt;&gt; snapshot = ml.catalog_snapshot("2023-01-15T10:30:00")
&gt;&gt;&gt; workflow = snapshot.lookup_workflow("2-ABC1")
&gt;&gt;&gt; workflow.description = "New description"
DerivaMLException: Cannot update workflow description on a read-only
    catalog snapshot. Use a writable catalog connection instead.
</code></pre>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/deriva_ml/core/mixins/workflow.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">lookup_workflow</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rid</span><span class="p">:</span> <span class="n">RID</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Workflow</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Look up a workflow by its Resource Identifier (RID).</span>

<span class="sd">    Retrieves a workflow from the catalog by its RID and returns a Workflow</span>
<span class="sd">    object bound to the catalog. The returned Workflow can be modified (e.g.,</span>
<span class="sd">    updating its description) and changes will be reflected in the catalog.</span>

<span class="sd">    Args:</span>
<span class="sd">        rid: Resource Identifier of the workflow to look up.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Workflow: The workflow object bound to this catalog, allowing</span>
<span class="sd">            properties like ``description`` to be updated.</span>

<span class="sd">    Raises:</span>
<span class="sd">        DerivaMLException: If the RID does not correspond to a workflow</span>
<span class="sd">            in the catalog.</span>

<span class="sd">    Examples:</span>
<span class="sd">        Look up a workflow and read its properties::</span>

<span class="sd">            &gt;&gt;&gt; workflow = ml.lookup_workflow(&quot;2-ABC1&quot;)</span>
<span class="sd">            &gt;&gt;&gt; print(f&quot;Name: {workflow.name}&quot;)</span>
<span class="sd">            &gt;&gt;&gt; print(f&quot;Description: {workflow.description}&quot;)</span>
<span class="sd">            &gt;&gt;&gt; print(f&quot;Type: {workflow.workflow_type}&quot;)</span>

<span class="sd">        Update a workflow&#39;s description (persisted to catalog)::</span>

<span class="sd">            &gt;&gt;&gt; workflow = ml.lookup_workflow(&quot;2-ABC1&quot;)</span>
<span class="sd">            &gt;&gt;&gt; workflow.description = &quot;Updated analysis pipeline for RNA sequences&quot;</span>
<span class="sd">            &gt;&gt;&gt; # The change is immediately written to the catalog</span>

<span class="sd">        Attempting to update on a read-only catalog raises an error::</span>

<span class="sd">            &gt;&gt;&gt; snapshot = ml.catalog_snapshot(&quot;2023-01-15T10:30:00&quot;)</span>
<span class="sd">            &gt;&gt;&gt; workflow = snapshot.lookup_workflow(&quot;2-ABC1&quot;)</span>
<span class="sd">            &gt;&gt;&gt; workflow.description = &quot;New description&quot;</span>
<span class="sd">            DerivaMLException: Cannot update workflow description on a read-only</span>
<span class="sd">                catalog snapshot. Use a writable catalog connection instead.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Get the workflow table path</span>
    <span class="n">workflow_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pathBuilder</span><span class="p">()</span><span class="o">.</span><span class="n">schemas</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ml_schema</span><span class="p">]</span><span class="o">.</span><span class="n">Workflow</span>

    <span class="c1"># Filter by RID</span>
    <span class="n">records</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">workflow_path</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">workflow_path</span><span class="o">.</span><span class="n">RID</span> <span class="o">==</span> <span class="n">rid</span><span class="p">)</span><span class="o">.</span><span class="n">entities</span><span class="p">()</span><span class="o">.</span><span class="n">fetch</span><span class="p">())</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">records</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">DerivaMLException</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Workflow with RID &#39;</span><span class="si">{</span><span class="n">rid</span><span class="si">}</span><span class="s2">&#39; not found in the catalog&quot;</span><span class="p">)</span>

    <span class="n">w</span> <span class="o">=</span> <span class="n">records</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">workflow</span> <span class="o">=</span> <span class="n">Workflow</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="n">w</span><span class="p">[</span><span class="s2">&quot;Name&quot;</span><span class="p">],</span>
        <span class="n">url</span><span class="o">=</span><span class="n">w</span><span class="p">[</span><span class="s2">&quot;URL&quot;</span><span class="p">],</span>
        <span class="n">workflow_type</span><span class="o">=</span><span class="n">w</span><span class="p">[</span><span class="s2">&quot;Workflow_Type&quot;</span><span class="p">],</span>
        <span class="n">version</span><span class="o">=</span><span class="n">w</span><span class="p">[</span><span class="s2">&quot;Version&quot;</span><span class="p">],</span>
        <span class="n">description</span><span class="o">=</span><span class="n">w</span><span class="p">[</span><span class="s2">&quot;Description&quot;</span><span class="p">],</span>
        <span class="n">rid</span><span class="o">=</span><span class="n">w</span><span class="p">[</span><span class="s2">&quot;RID&quot;</span><span class="p">],</span>
        <span class="n">checksum</span><span class="o">=</span><span class="n">w</span><span class="p">[</span><span class="s2">&quot;Checksum&quot;</span><span class="p">],</span>
    <span class="p">)</span>
    <span class="c1"># Bind the workflow to this catalog instance for write-back support</span>
    <span class="n">workflow</span><span class="o">.</span><span class="n">_ml_instance</span> <span class="o">=</span> <span class="bp">self</span>  <span class="c1"># type: ignore[assignment]</span>
    <span class="k">return</span> <span class="n">workflow</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="deriva_ml.core.DerivaML.lookup_workflow_by_url" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">lookup_workflow_by_url</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">lookup_workflow_by_url</span><span class="p">(</span>
    <span class="n">url_or_checksum</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Workflow</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Look up a workflow by URL or checksum and return the full Workflow object.</p>
<p>Searches for a workflow in the catalog that matches the given URL or
checksum and returns a Workflow object bound to the catalog. This allows
you to both identify a workflow by its source code location and modify
its properties (e.g., description).</p>
<p>The URL should be a GitHub URL pointing to the specific version of the
workflow source code. The format typically includes the commit hash::</p>
<pre><code>https://github.com/org/repo/blob/&lt;commit_hash&gt;/path/to/workflow.py
</code></pre>
<p>Alternatively, you can search by the Git object hash (checksum) of the
workflow file.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>url_or_checksum</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>GitHub URL with commit hash, or Git object hash
(checksum) of the workflow file.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>Workflow</code></td>            <td>
                  <code><a class="autorefs autorefs-internal" title="Workflow (deriva_ml.execution.workflow.Workflow)" href="../workflow/#deriva_ml.execution.workflow.Workflow">Workflow</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The workflow object bound to this catalog, allowing
properties like <code>description</code> to be updated.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="DerivaMLException (deriva_ml.core.exceptions.DerivaMLException)" href="../exceptions/#deriva_ml.core.exceptions.DerivaMLException">DerivaMLException</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If no workflow with the given URL or checksum
is found in the catalog.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <p>Look up a workflow by its GitHub URL::</p>
<pre><code>&gt;&gt;&gt; url = "https://github.com/org/repo/blob/abc123/analysis.py"
&gt;&gt;&gt; workflow = ml.lookup_workflow_by_url(url)
&gt;&gt;&gt; print(f"Found: {workflow.name}")
&gt;&gt;&gt; print(f"Version: {workflow.version}")
</code></pre>
<p>Look up by Git object hash (checksum)::</p>
<pre><code>&gt;&gt;&gt; workflow = ml.lookup_workflow_by_url("abc123def456789...")
&gt;&gt;&gt; print(f"Name: {workflow.name}")
&gt;&gt;&gt; print(f"URL: {workflow.url}")
</code></pre>
<p>Update the workflow's description after lookup::</p>
<pre><code>&gt;&gt;&gt; workflow = ml.lookup_workflow_by_url(url)
&gt;&gt;&gt; workflow.description = "Updated analysis pipeline"
&gt;&gt;&gt; # The change is persisted to the catalog
</code></pre>
<p>Typical GitHub URL formats supported::</p>
<pre><code># Full blob URL with commit hash
https://github.com/org/repo/blob/abc123def/src/workflow.py

# The URL is matched exactly, so ensure it matches what was
# recorded when the workflow was registered
</code></pre>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/deriva_ml/core/mixins/workflow.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">lookup_workflow_by_url</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">url_or_checksum</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Workflow</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Look up a workflow by URL or checksum and return the full Workflow object.</span>

<span class="sd">    Searches for a workflow in the catalog that matches the given URL or</span>
<span class="sd">    checksum and returns a Workflow object bound to the catalog. This allows</span>
<span class="sd">    you to both identify a workflow by its source code location and modify</span>
<span class="sd">    its properties (e.g., description).</span>

<span class="sd">    The URL should be a GitHub URL pointing to the specific version of the</span>
<span class="sd">    workflow source code. The format typically includes the commit hash::</span>

<span class="sd">        https://github.com/org/repo/blob/&lt;commit_hash&gt;/path/to/workflow.py</span>

<span class="sd">    Alternatively, you can search by the Git object hash (checksum) of the</span>
<span class="sd">    workflow file.</span>

<span class="sd">    Args:</span>
<span class="sd">        url_or_checksum: GitHub URL with commit hash, or Git object hash</span>
<span class="sd">            (checksum) of the workflow file.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Workflow: The workflow object bound to this catalog, allowing</span>
<span class="sd">            properties like ``description`` to be updated.</span>

<span class="sd">    Raises:</span>
<span class="sd">        DerivaMLException: If no workflow with the given URL or checksum</span>
<span class="sd">            is found in the catalog.</span>

<span class="sd">    Examples:</span>
<span class="sd">        Look up a workflow by its GitHub URL::</span>

<span class="sd">            &gt;&gt;&gt; url = &quot;https://github.com/org/repo/blob/abc123/analysis.py&quot;</span>
<span class="sd">            &gt;&gt;&gt; workflow = ml.lookup_workflow_by_url(url)</span>
<span class="sd">            &gt;&gt;&gt; print(f&quot;Found: {workflow.name}&quot;)</span>
<span class="sd">            &gt;&gt;&gt; print(f&quot;Version: {workflow.version}&quot;)</span>

<span class="sd">        Look up by Git object hash (checksum)::</span>

<span class="sd">            &gt;&gt;&gt; workflow = ml.lookup_workflow_by_url(&quot;abc123def456789...&quot;)</span>
<span class="sd">            &gt;&gt;&gt; print(f&quot;Name: {workflow.name}&quot;)</span>
<span class="sd">            &gt;&gt;&gt; print(f&quot;URL: {workflow.url}&quot;)</span>

<span class="sd">        Update the workflow&#39;s description after lookup::</span>

<span class="sd">            &gt;&gt;&gt; workflow = ml.lookup_workflow_by_url(url)</span>
<span class="sd">            &gt;&gt;&gt; workflow.description = &quot;Updated analysis pipeline&quot;</span>
<span class="sd">            &gt;&gt;&gt; # The change is persisted to the catalog</span>

<span class="sd">        Typical GitHub URL formats supported::</span>

<span class="sd">            # Full blob URL with commit hash</span>
<span class="sd">            https://github.com/org/repo/blob/abc123def/src/workflow.py</span>

<span class="sd">            # The URL is matched exactly, so ensure it matches what was</span>
<span class="sd">            # recorded when the workflow was registered</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Find the RID first</span>
    <span class="n">rid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_find_workflow_rid_by_url</span><span class="p">(</span><span class="n">url_or_checksum</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">rid</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">DerivaMLException</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Workflow with URL or checksum &#39;</span><span class="si">{</span><span class="n">url_or_checksum</span><span class="si">}</span><span class="s2">&#39; not found in the catalog&quot;</span>
        <span class="p">)</span>

    <span class="c1"># Use lookup_workflow to get the full object with catalog binding</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">lookup_workflow</span><span class="p">(</span><span class="n">rid</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="deriva_ml.core.DerivaML.pathBuilder" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">pathBuilder</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">pathBuilder</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">SchemaWrapper</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Returns catalog path builder for queries.</p>
<p>The path builder provides a fluent interface for constructing complex queries against the catalog.
This is a core component used by many other methods to interact with the catalog.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="deriva_ml.core.mixins.path_builder.SchemaWrapper">SchemaWrapper</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>datapath._CatalogWrapper: A new instance of the catalog path builder.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>path = ml.pathBuilder.schemas['my_schema'].tables['my_table']
results = path.entities().fetch()</p>
</blockquote>
</blockquote>
</blockquote>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/deriva_ml/core/mixins/path_builder.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">pathBuilder</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SchemaWrapper</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns catalog path builder for queries.</span>

<span class="sd">    The path builder provides a fluent interface for constructing complex queries against the catalog.</span>
<span class="sd">    This is a core component used by many other methods to interact with the catalog.</span>

<span class="sd">    Returns:</span>
<span class="sd">        datapath._CatalogWrapper: A new instance of the catalog path builder.</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; path = ml.pathBuilder.schemas[&#39;my_schema&#39;].tables[&#39;my_table&#39;]</span>
<span class="sd">        &gt;&gt;&gt; results = path.entities().fetch()</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">catalog</span><span class="o">.</span><span class="n">getPathBuilder</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="deriva_ml.core.DerivaML.remove_visible_column" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">remove_visible_column</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">remove_visible_column</span><span class="p">(</span>
    <span class="n">table</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Table</span><span class="p">,</span>
    <span class="n">context</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">column</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Any</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Remove a column from the visible-columns list for a specific context.</p>
<p>Convenience method for removing columns without replacing the entire
visible-columns annotation. Changes are staged until apply_annotations()
is called.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>table</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <span title="deriva_ml.core.mixins.annotation.Table">Table</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Table name or Table object.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>context</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The context to modify (e.g., "compact", "detailed").</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>column</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <span title="list">list</span>[<span title="str">str</span>] | <span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Column to remove. Can be:
- String: column name to find and remove
- List: foreign key reference [schema, constraint] to find and remove
- Integer: index position to remove (0-indexed)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The updated column list for the context.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="DerivaMLException (deriva_ml.core.exceptions.DerivaMLException)" href="../exceptions/#deriva_ml.core.exceptions.DerivaMLException">DerivaMLException</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If annotation or context doesn't exist, or column not found.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>ml.remove_visible_column("Image", "compact", "Description")
ml.remove_visible_column("Image", "compact", 0)  # Remove first column
ml.apply_annotations()</p>
</blockquote>
</blockquote>
</blockquote>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/deriva_ml/core/mixins/annotation.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="n">ConfigDict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="k">def</span><span class="w"> </span><span class="nf">remove_visible_column</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">table</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Table</span><span class="p">,</span>
    <span class="n">context</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">column</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Remove a column from the visible-columns list for a specific context.</span>

<span class="sd">    Convenience method for removing columns without replacing the entire</span>
<span class="sd">    visible-columns annotation. Changes are staged until apply_annotations()</span>
<span class="sd">    is called.</span>

<span class="sd">    Args:</span>
<span class="sd">        table: Table name or Table object.</span>
<span class="sd">        context: The context to modify (e.g., &quot;compact&quot;, &quot;detailed&quot;).</span>
<span class="sd">        column: Column to remove. Can be:</span>
<span class="sd">            - String: column name to find and remove</span>
<span class="sd">            - List: foreign key reference [schema, constraint] to find and remove</span>
<span class="sd">            - Integer: index position to remove (0-indexed)</span>

<span class="sd">    Returns:</span>
<span class="sd">        The updated column list for the context.</span>

<span class="sd">    Raises:</span>
<span class="sd">        DerivaMLException: If annotation or context doesn&#39;t exist, or column not found.</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; ml.remove_visible_column(&quot;Image&quot;, &quot;compact&quot;, &quot;Description&quot;)</span>
<span class="sd">        &gt;&gt;&gt; ml.remove_visible_column(&quot;Image&quot;, &quot;compact&quot;, 0)  # Remove first column</span>
<span class="sd">        &gt;&gt;&gt; ml.apply_annotations()</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">table_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">name_to_table</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>

    <span class="c1"># Get visible_columns annotation</span>
    <span class="n">visible_cols</span> <span class="o">=</span> <span class="n">table_obj</span><span class="o">.</span><span class="n">annotations</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">VISIBLE_COLUMNS_TAG</span><span class="p">,</span> <span class="p">{})</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">visible_cols</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">DerivaMLException</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Table &#39;</span><span class="si">{</span><span class="n">table_obj</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; has no visible-columns annotation.&quot;</span><span class="p">)</span>

    <span class="c1"># Get the context list</span>
    <span class="n">context_list</span> <span class="o">=</span> <span class="n">visible_cols</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">context</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">context_list</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">DerivaMLException</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Context &#39;</span><span class="si">{</span><span class="n">context</span><span class="si">}</span><span class="s2">&#39; not found in visible-columns annotation.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">context_list</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">raise</span> <span class="n">DerivaMLException</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Context &#39;</span><span class="si">{</span><span class="n">context</span><span class="si">}</span><span class="s2">&#39; references another context &#39;</span><span class="si">{</span><span class="n">context_list</span><span class="si">}</span><span class="s2">&#39;. &quot;</span>
            <span class="s2">&quot;Set it explicitly first with set_visible_columns().&quot;</span>
        <span class="p">)</span>

    <span class="c1"># Make a copy</span>
    <span class="n">context_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">context_list</span><span class="p">)</span>
    <span class="n">removed</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="c1"># Remove by index or by value</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">column</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
        <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">column</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">context_list</span><span class="p">):</span>
            <span class="n">removed</span> <span class="o">=</span> <span class="n">context_list</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">column</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DerivaMLException</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Index </span><span class="si">{</span><span class="n">column</span><span class="si">}</span><span class="s2"> out of range (list has </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">context_list</span><span class="p">)</span><span class="si">}</span><span class="s2"> items).&quot;</span>
            <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Find and remove the column</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">context_list</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">item</span> <span class="o">==</span> <span class="n">column</span><span class="p">:</span>
                <span class="n">removed</span> <span class="o">=</span> <span class="n">context_list</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
                <span class="k">break</span>
            <span class="c1"># Also check if it&#39;s a pseudo-column with matching source</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">column</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">item</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;source&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="n">column</span><span class="p">:</span>
                    <span class="n">removed</span> <span class="o">=</span> <span class="n">context_list</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
                    <span class="k">break</span>

        <span class="k">if</span> <span class="n">removed</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DerivaMLException</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Column </span><span class="si">{</span><span class="n">column</span><span class="si">!r}</span><span class="s2"> not found in context &#39;</span><span class="si">{</span><span class="n">context</span><span class="si">}</span><span class="s2">&#39;.&quot;</span><span class="p">)</span>

    <span class="c1"># Update the annotation</span>
    <span class="n">visible_cols</span><span class="p">[</span><span class="n">context</span><span class="p">]</span> <span class="o">=</span> <span class="n">context_list</span>
    <span class="n">table_obj</span><span class="o">.</span><span class="n">annotations</span><span class="p">[</span><span class="n">VISIBLE_COLUMNS_TAG</span><span class="p">]</span> <span class="o">=</span> <span class="n">visible_cols</span>

    <span class="k">return</span> <span class="n">context_list</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="deriva_ml.core.DerivaML.remove_visible_foreign_key" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">remove_visible_foreign_key</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">remove_visible_foreign_key</span><span class="p">(</span>
    <span class="n">table</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Table</span><span class="p">,</span>
    <span class="n">context</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">foreign_key</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Any</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Remove a foreign key from the visible-foreign-keys list for a specific context.</p>
<p>Convenience method for removing related tables without replacing the entire
visible-foreign-keys annotation. Changes are staged until apply_annotations()
is called.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>table</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <span title="deriva_ml.core.mixins.annotation.Table">Table</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Table name or Table object.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>context</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The context to modify (e.g., "detailed", "*").</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>foreign_key</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>] | <span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Foreign key to remove. Can be:
- List: foreign key reference [schema, constraint] to find and remove
- Integer: index position to remove (0-indexed)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The updated foreign key list for the context.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="DerivaMLException (deriva_ml.core.exceptions.DerivaMLException)" href="../exceptions/#deriva_ml.core.exceptions.DerivaMLException">DerivaMLException</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If annotation or context doesn't exist, or foreign key not found.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>ml.remove_visible_foreign_key("Subject", "detailed", ["domain", "Image_Subject_fkey"])
ml.remove_visible_foreign_key("Subject", "detailed", 0)  # Remove first
ml.apply_annotations()</p>
</blockquote>
</blockquote>
</blockquote>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/deriva_ml/core/mixins/annotation.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="n">ConfigDict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="k">def</span><span class="w"> </span><span class="nf">remove_visible_foreign_key</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">table</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Table</span><span class="p">,</span>
    <span class="n">context</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">foreign_key</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Remove a foreign key from the visible-foreign-keys list for a specific context.</span>

<span class="sd">    Convenience method for removing related tables without replacing the entire</span>
<span class="sd">    visible-foreign-keys annotation. Changes are staged until apply_annotations()</span>
<span class="sd">    is called.</span>

<span class="sd">    Args:</span>
<span class="sd">        table: Table name or Table object.</span>
<span class="sd">        context: The context to modify (e.g., &quot;detailed&quot;, &quot;*&quot;).</span>
<span class="sd">        foreign_key: Foreign key to remove. Can be:</span>
<span class="sd">            - List: foreign key reference [schema, constraint] to find and remove</span>
<span class="sd">            - Integer: index position to remove (0-indexed)</span>

<span class="sd">    Returns:</span>
<span class="sd">        The updated foreign key list for the context.</span>

<span class="sd">    Raises:</span>
<span class="sd">        DerivaMLException: If annotation or context doesn&#39;t exist, or foreign key not found.</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; ml.remove_visible_foreign_key(&quot;Subject&quot;, &quot;detailed&quot;, [&quot;domain&quot;, &quot;Image_Subject_fkey&quot;])</span>
<span class="sd">        &gt;&gt;&gt; ml.remove_visible_foreign_key(&quot;Subject&quot;, &quot;detailed&quot;, 0)  # Remove first</span>
<span class="sd">        &gt;&gt;&gt; ml.apply_annotations()</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">table_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">name_to_table</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>

    <span class="c1"># Get visible_foreign_keys annotation</span>
    <span class="n">visible_fkeys</span> <span class="o">=</span> <span class="n">table_obj</span><span class="o">.</span><span class="n">annotations</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">VISIBLE_FOREIGN_KEYS_TAG</span><span class="p">,</span> <span class="p">{})</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">visible_fkeys</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">DerivaMLException</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Table &#39;</span><span class="si">{</span><span class="n">table_obj</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; has no visible-foreign-keys annotation.&quot;</span>
        <span class="p">)</span>

    <span class="c1"># Get the context list</span>
    <span class="n">context_list</span> <span class="o">=</span> <span class="n">visible_fkeys</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">context</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">context_list</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">DerivaMLException</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Context &#39;</span><span class="si">{</span><span class="n">context</span><span class="si">}</span><span class="s2">&#39; not found in visible-foreign-keys annotation.&quot;</span>
        <span class="p">)</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">context_list</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">raise</span> <span class="n">DerivaMLException</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Context &#39;</span><span class="si">{</span><span class="n">context</span><span class="si">}</span><span class="s2">&#39; references another context &#39;</span><span class="si">{</span><span class="n">context_list</span><span class="si">}</span><span class="s2">&#39;. &quot;</span>
            <span class="s2">&quot;Set it explicitly first with set_visible_foreign_keys().&quot;</span>
        <span class="p">)</span>

    <span class="c1"># Make a copy</span>
    <span class="n">context_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">context_list</span><span class="p">)</span>
    <span class="n">removed</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="c1"># Remove by index or by value</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">foreign_key</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
        <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">foreign_key</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">context_list</span><span class="p">):</span>
            <span class="n">removed</span> <span class="o">=</span> <span class="n">context_list</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">foreign_key</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DerivaMLException</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Index </span><span class="si">{</span><span class="n">foreign_key</span><span class="si">}</span><span class="s2"> out of range (list has </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">context_list</span><span class="p">)</span><span class="si">}</span><span class="s2"> items).&quot;</span>
            <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Find and remove the foreign key</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">context_list</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">item</span> <span class="o">==</span> <span class="n">foreign_key</span><span class="p">:</span>
                <span class="n">removed</span> <span class="o">=</span> <span class="n">context_list</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
                <span class="k">break</span>

        <span class="k">if</span> <span class="n">removed</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DerivaMLException</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Foreign key </span><span class="si">{</span><span class="n">foreign_key</span><span class="si">!r}</span><span class="s2"> not found in context &#39;</span><span class="si">{</span><span class="n">context</span><span class="si">}</span><span class="s2">&#39;.&quot;</span>
            <span class="p">)</span>

    <span class="c1"># Update the annotation</span>
    <span class="n">visible_fkeys</span><span class="p">[</span><span class="n">context</span><span class="p">]</span> <span class="o">=</span> <span class="n">context_list</span>
    <span class="n">table_obj</span><span class="o">.</span><span class="n">annotations</span><span class="p">[</span><span class="n">VISIBLE_FOREIGN_KEYS_TAG</span><span class="p">]</span> <span class="o">=</span> <span class="n">visible_fkeys</span>

    <span class="k">return</span> <span class="n">context_list</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="deriva_ml.core.DerivaML.reorder_visible_columns" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">reorder_visible_columns</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">reorder_visible_columns</span><span class="p">(</span>
    <span class="n">table</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Table</span><span class="p">,</span>
    <span class="n">context</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">new_order</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span>
    <span class="o">|</span> <span class="nb">list</span><span class="p">[</span>
        <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span>
    <span class="p">],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Any</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Reorder columns in the visible-columns list for a specific context.</p>
<p>Convenience method for reordering columns without manually reconstructing
the list. Changes are staged until apply_annotations() is called.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>table</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <span title="deriva_ml.core.mixins.annotation.Table">Table</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Table name or Table object.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>context</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The context to modify (e.g., "compact", "detailed").</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>new_order</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="int">int</span>] | <span title="list">list</span>[<span title="str">str</span> | <span title="list">list</span>[<span title="str">str</span>] | <span title="dict">dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The new order specification. Can be:
- List of indices: [2, 0, 1, 3] reorders by current positions
- List of column specs: ["Name", "RID", ...] specifies exact order</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The reordered column list.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="DerivaMLException (deriva_ml.core.exceptions.DerivaMLException)" href="../exceptions/#deriva_ml.core.exceptions.DerivaMLException">DerivaMLException</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If annotation or context doesn't exist, or invalid order.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>ml.reorder_visible_columns("Image", "compact", [2, 0, 1, 3, 4])
ml.reorder_visible_columns("Image", "compact", ["Filename", "Subject", "RID"])
ml.apply_annotations()</p>
</blockquote>
</blockquote>
</blockquote>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/deriva_ml/core/mixins/annotation.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="n">ConfigDict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="k">def</span><span class="w"> </span><span class="nf">reorder_visible_columns</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">table</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Table</span><span class="p">,</span>
    <span class="n">context</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">new_order</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Reorder columns in the visible-columns list for a specific context.</span>

<span class="sd">    Convenience method for reordering columns without manually reconstructing</span>
<span class="sd">    the list. Changes are staged until apply_annotations() is called.</span>

<span class="sd">    Args:</span>
<span class="sd">        table: Table name or Table object.</span>
<span class="sd">        context: The context to modify (e.g., &quot;compact&quot;, &quot;detailed&quot;).</span>
<span class="sd">        new_order: The new order specification. Can be:</span>
<span class="sd">            - List of indices: [2, 0, 1, 3] reorders by current positions</span>
<span class="sd">            - List of column specs: [&quot;Name&quot;, &quot;RID&quot;, ...] specifies exact order</span>

<span class="sd">    Returns:</span>
<span class="sd">        The reordered column list.</span>

<span class="sd">    Raises:</span>
<span class="sd">        DerivaMLException: If annotation or context doesn&#39;t exist, or invalid order.</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; ml.reorder_visible_columns(&quot;Image&quot;, &quot;compact&quot;, [2, 0, 1, 3, 4])</span>
<span class="sd">        &gt;&gt;&gt; ml.reorder_visible_columns(&quot;Image&quot;, &quot;compact&quot;, [&quot;Filename&quot;, &quot;Subject&quot;, &quot;RID&quot;])</span>
<span class="sd">        &gt;&gt;&gt; ml.apply_annotations()</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">table_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">name_to_table</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>

    <span class="c1"># Get visible_columns annotation</span>
    <span class="n">visible_cols</span> <span class="o">=</span> <span class="n">table_obj</span><span class="o">.</span><span class="n">annotations</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">VISIBLE_COLUMNS_TAG</span><span class="p">,</span> <span class="p">{})</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">visible_cols</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">DerivaMLException</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Table &#39;</span><span class="si">{</span><span class="n">table_obj</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; has no visible-columns annotation.&quot;</span><span class="p">)</span>

    <span class="c1"># Get the context list</span>
    <span class="n">context_list</span> <span class="o">=</span> <span class="n">visible_cols</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">context</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">context_list</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">DerivaMLException</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Context &#39;</span><span class="si">{</span><span class="n">context</span><span class="si">}</span><span class="s2">&#39; not found in visible-columns annotation.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">context_list</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">raise</span> <span class="n">DerivaMLException</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Context &#39;</span><span class="si">{</span><span class="n">context</span><span class="si">}</span><span class="s2">&#39; references another context &#39;</span><span class="si">{</span><span class="n">context_list</span><span class="si">}</span><span class="s2">&#39;. &quot;</span>
            <span class="s2">&quot;Set it explicitly first with set_visible_columns().&quot;</span>
        <span class="p">)</span>

    <span class="n">original_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">context_list</span><span class="p">)</span>

    <span class="c1"># Determine if new_order is indices or column specs</span>
    <span class="k">if</span> <span class="n">new_order</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">new_order</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">int</span><span class="p">):</span>
        <span class="c1"># Reorder by indices</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_order</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">original_list</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">DerivaMLException</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Index list length (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">new_order</span><span class="p">)</span><span class="si">}</span><span class="s2">) must match &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;current list length (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">original_list</span><span class="p">)</span><span class="si">}</span><span class="s2">).&quot;</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="nb">set</span><span class="p">(</span><span class="n">new_order</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">set</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">original_list</span><span class="p">))):</span>
            <span class="k">raise</span> <span class="n">DerivaMLException</span><span class="p">(</span><span class="s2">&quot;Index list must contain each index exactly once.&quot;</span><span class="p">)</span>
        <span class="n">new_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">original_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">new_order</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># new_order is the exact new column list</span>
        <span class="n">new_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">new_order</span><span class="p">)</span>

    <span class="c1"># Update the annotation</span>
    <span class="n">visible_cols</span><span class="p">[</span><span class="n">context</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_list</span>
    <span class="n">table_obj</span><span class="o">.</span><span class="n">annotations</span><span class="p">[</span><span class="n">VISIBLE_COLUMNS_TAG</span><span class="p">]</span> <span class="o">=</span> <span class="n">visible_cols</span>

    <span class="k">return</span> <span class="n">new_list</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="deriva_ml.core.DerivaML.reorder_visible_foreign_keys" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">reorder_visible_foreign_keys</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">reorder_visible_foreign_keys</span><span class="p">(</span>
    <span class="n">table</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Table</span><span class="p">,</span>
    <span class="n">context</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">new_order</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span>
    <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Any</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Reorder foreign keys in the visible-foreign-keys list for a specific context.</p>
<p>Convenience method for reordering related tables without manually
reconstructing the list. Changes are staged until apply_annotations()
is called.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>table</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <span title="deriva_ml.core.mixins.annotation.Table">Table</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Table name or Table object.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>context</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The context to modify (e.g., "detailed", "*").</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>new_order</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="int">int</span>] | <span title="list">list</span>[<span title="list">list</span>[<span title="str">str</span>] | <span title="dict">dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The new order specification. Can be:
- List of indices: [2, 0, 1] reorders by current positions
- List of foreign key refs: [["schema", "fkey1"], ...] specifies exact order</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="list">list</span>[<span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The reordered foreign key list.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="DerivaMLException (deriva_ml.core.exceptions.DerivaMLException)" href="../exceptions/#deriva_ml.core.exceptions.DerivaMLException">DerivaMLException</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If annotation or context doesn't exist, or invalid order.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>ml.reorder_visible_foreign_keys("Subject", "detailed", [2, 0, 1])
ml.apply_annotations()</p>
</blockquote>
</blockquote>
</blockquote>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/deriva_ml/core/mixins/annotation.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span>
<span class="normal">807</span>
<span class="normal">808</span>
<span class="normal">809</span>
<span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span>
<span class="normal">818</span>
<span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="n">ConfigDict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="k">def</span><span class="w"> </span><span class="nf">reorder_visible_foreign_keys</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">table</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Table</span><span class="p">,</span>
    <span class="n">context</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">new_order</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Reorder foreign keys in the visible-foreign-keys list for a specific context.</span>

<span class="sd">    Convenience method for reordering related tables without manually</span>
<span class="sd">    reconstructing the list. Changes are staged until apply_annotations()</span>
<span class="sd">    is called.</span>

<span class="sd">    Args:</span>
<span class="sd">        table: Table name or Table object.</span>
<span class="sd">        context: The context to modify (e.g., &quot;detailed&quot;, &quot;*&quot;).</span>
<span class="sd">        new_order: The new order specification. Can be:</span>
<span class="sd">            - List of indices: [2, 0, 1] reorders by current positions</span>
<span class="sd">            - List of foreign key refs: [[&quot;schema&quot;, &quot;fkey1&quot;], ...] specifies exact order</span>

<span class="sd">    Returns:</span>
<span class="sd">        The reordered foreign key list.</span>

<span class="sd">    Raises:</span>
<span class="sd">        DerivaMLException: If annotation or context doesn&#39;t exist, or invalid order.</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; ml.reorder_visible_foreign_keys(&quot;Subject&quot;, &quot;detailed&quot;, [2, 0, 1])</span>
<span class="sd">        &gt;&gt;&gt; ml.apply_annotations()</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">table_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">name_to_table</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>

    <span class="c1"># Get visible_foreign_keys annotation</span>
    <span class="n">visible_fkeys</span> <span class="o">=</span> <span class="n">table_obj</span><span class="o">.</span><span class="n">annotations</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">VISIBLE_FOREIGN_KEYS_TAG</span><span class="p">,</span> <span class="p">{})</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">visible_fkeys</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">DerivaMLException</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Table &#39;</span><span class="si">{</span><span class="n">table_obj</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; has no visible-foreign-keys annotation.&quot;</span>
        <span class="p">)</span>

    <span class="c1"># Get the context list</span>
    <span class="n">context_list</span> <span class="o">=</span> <span class="n">visible_fkeys</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">context</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">context_list</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">DerivaMLException</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Context &#39;</span><span class="si">{</span><span class="n">context</span><span class="si">}</span><span class="s2">&#39; not found in visible-foreign-keys annotation.&quot;</span>
        <span class="p">)</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">context_list</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">raise</span> <span class="n">DerivaMLException</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Context &#39;</span><span class="si">{</span><span class="n">context</span><span class="si">}</span><span class="s2">&#39; references another context &#39;</span><span class="si">{</span><span class="n">context_list</span><span class="si">}</span><span class="s2">&#39;. &quot;</span>
            <span class="s2">&quot;Set it explicitly first with set_visible_foreign_keys().&quot;</span>
        <span class="p">)</span>

    <span class="n">original_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">context_list</span><span class="p">)</span>

    <span class="c1"># Determine if new_order is indices or foreign key specs</span>
    <span class="k">if</span> <span class="n">new_order</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">new_order</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">int</span><span class="p">):</span>
        <span class="c1"># Reorder by indices</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_order</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">original_list</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">DerivaMLException</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Index list length (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">new_order</span><span class="p">)</span><span class="si">}</span><span class="s2">) must match &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;current list length (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">original_list</span><span class="p">)</span><span class="si">}</span><span class="s2">).&quot;</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="nb">set</span><span class="p">(</span><span class="n">new_order</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">set</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">original_list</span><span class="p">))):</span>
            <span class="k">raise</span> <span class="n">DerivaMLException</span><span class="p">(</span><span class="s2">&quot;Index list must contain each index exactly once.&quot;</span><span class="p">)</span>
        <span class="n">new_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">original_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">new_order</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># new_order is the exact new foreign key list</span>
        <span class="n">new_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">new_order</span><span class="p">)</span>

    <span class="c1"># Update the annotation</span>
    <span class="n">visible_fkeys</span><span class="p">[</span><span class="n">context</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_list</span>
    <span class="n">table_obj</span><span class="o">.</span><span class="n">annotations</span><span class="p">[</span><span class="n">VISIBLE_FOREIGN_KEYS_TAG</span><span class="p">]</span> <span class="o">=</span> <span class="n">visible_fkeys</span>

    <span class="k">return</span> <span class="n">new_list</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="deriva_ml.core.DerivaML.resolve_rid" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">resolve_rid</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">resolve_rid</span><span class="p">(</span>
    <span class="n">rid</span><span class="p">:</span> <span class="n">RID</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ResolveRidResult</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Resolves RID to catalog location.</p>
<p>Looks up a RID and returns information about where it exists in the catalog, including schema,
table, and column metadata.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>rid</code>
            </td>
            <td>
                  <code><span title="deriva_ml.core.definitions.RID">RID</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Resource Identifier to resolve.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>ResolveRidResult</code></td>            <td>
                  <code><span title="deriva_ml.core.mixins.rid_resolution.ResolveRidResult">ResolveRidResult</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Named tuple containing:
- schema: Schema name
- table: Table name
- columns: Column definitions
- datapath: Path builder for accessing the entity</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="DerivaMLException (deriva_ml.core.exceptions.DerivaMLException)" href="../exceptions/#deriva_ml.core.exceptions.DerivaMLException">DerivaMLException</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If RID doesn't exist in catalog.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ml</span><span class="o">.</span><span class="n">resolve_rid</span><span class="p">(</span><span class="s2">&quot;1-abc123&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Found in </span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">schema</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">table</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">datapath</span><span class="o">.</span><span class="n">entities</span><span class="p">()</span><span class="o">.</span><span class="n">fetch</span><span class="p">()</span>
</code></pre></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/deriva_ml/core/mixins/rid_resolution.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">resolve_rid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rid</span><span class="p">:</span> <span class="n">RID</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ResolveRidResult</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Resolves RID to catalog location.</span>

<span class="sd">    Looks up a RID and returns information about where it exists in the catalog, including schema,</span>
<span class="sd">    table, and column metadata.</span>

<span class="sd">    Args:</span>
<span class="sd">        rid: Resource Identifier to resolve.</span>

<span class="sd">    Returns:</span>
<span class="sd">        ResolveRidResult: Named tuple containing:</span>
<span class="sd">            - schema: Schema name</span>
<span class="sd">            - table: Table name</span>
<span class="sd">            - columns: Column definitions</span>
<span class="sd">            - datapath: Path builder for accessing the entity</span>

<span class="sd">    Raises:</span>
<span class="sd">        DerivaMLException: If RID doesn&#39;t exist in catalog.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; result = ml.resolve_rid(&quot;1-abc123&quot;)</span>
<span class="sd">        &gt;&gt;&gt; print(f&quot;Found in {result.schema}.{result.table}&quot;)</span>
<span class="sd">        &gt;&gt;&gt; data = result.datapath.entities().fetch()</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Attempt to resolve RID using catalog model</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">catalog</span><span class="o">.</span><span class="n">resolve_rid</span><span class="p">(</span><span class="n">rid</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">model</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">KeyError</span> <span class="k">as</span> <span class="n">_e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">DerivaMLException</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid RID </span><span class="si">{</span><span class="n">rid</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="deriva_ml.core.DerivaML.resolve_rids" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">resolve_rids</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">resolve_rids</span><span class="p">(</span>
    <span class="n">rids</span><span class="p">:</span> <span class="nb">set</span><span class="p">[</span><span class="n">RID</span><span class="p">]</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="n">RID</span><span class="p">],</span>
    <span class="n">candidate_tables</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Table</span><span class="p">]</span>
    <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="n">RID</span><span class="p">,</span> <span class="n">BatchRidResult</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Batch resolve multiple RIDs efficiently.</p>
<p>Resolves multiple RIDs in batched queries, significantly faster than
calling resolve_rid() for each RID individually. Instead of N network
calls for N RIDs, this makes one query per candidate table.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>rids</code>
            </td>
            <td>
                  <code><span title="set">set</span>[<span title="deriva_ml.core.definitions.RID">RID</span>] | <span title="list">list</span>[<span title="deriva_ml.core.definitions.RID">RID</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Set or list of RIDs to resolve.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>candidate_tables</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="deriva_ml.core.mixins.rid_resolution.Table">Table</span>] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional list of Table objects to search in.
If not provided, searches all tables in domain and ML schemas.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span>[<span title="deriva_ml.core.definitions.RID">RID</span>, <span title="deriva_ml.core.mixins.rid_resolution.BatchRidResult">BatchRidResult</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dict[RID, BatchRidResult]: Mapping from each resolved RID to its
BatchRidResult containing table information.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="DerivaMLException (deriva_ml.core.exceptions.DerivaMLException)" href="../exceptions/#deriva_ml.core.exceptions.DerivaMLException">DerivaMLException</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If any RID cannot be resolved.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>results = ml.resolve_rids(["1-ABC", "2-DEF", "3-GHI"])
for rid, info in results.items():
...     print(f"{rid} is in table {info.table_name}")</p>
</blockquote>
</blockquote>
</blockquote>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/deriva_ml/core/mixins/rid_resolution.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">resolve_rids</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">rids</span><span class="p">:</span> <span class="nb">set</span><span class="p">[</span><span class="n">RID</span><span class="p">]</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="n">RID</span><span class="p">],</span>
    <span class="n">candidate_tables</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Table</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="n">RID</span><span class="p">,</span> <span class="n">BatchRidResult</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Batch resolve multiple RIDs efficiently.</span>

<span class="sd">    Resolves multiple RIDs in batched queries, significantly faster than</span>
<span class="sd">    calling resolve_rid() for each RID individually. Instead of N network</span>
<span class="sd">    calls for N RIDs, this makes one query per candidate table.</span>

<span class="sd">    Args:</span>
<span class="sd">        rids: Set or list of RIDs to resolve.</span>
<span class="sd">        candidate_tables: Optional list of Table objects to search in.</span>
<span class="sd">            If not provided, searches all tables in domain and ML schemas.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict[RID, BatchRidResult]: Mapping from each resolved RID to its</span>
<span class="sd">            BatchRidResult containing table information.</span>

<span class="sd">    Raises:</span>
<span class="sd">        DerivaMLException: If any RID cannot be resolved.</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; results = ml.resolve_rids([&quot;1-ABC&quot;, &quot;2-DEF&quot;, &quot;3-GHI&quot;])</span>
<span class="sd">        &gt;&gt;&gt; for rid, info in results.items():</span>
<span class="sd">        ...     print(f&quot;{rid} is in table {info.table_name}&quot;)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">rids</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">rids</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">rids</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">{}</span>

    <span class="n">results</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="n">RID</span><span class="p">,</span> <span class="n">BatchRidResult</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">remaining_rids</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">rids</span><span class="p">)</span>

    <span class="c1"># Determine which tables to search</span>
    <span class="k">if</span> <span class="n">candidate_tables</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># Search all tables in domain and ML schemas</span>
        <span class="n">candidate_tables</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">schema_name</span> <span class="ow">in</span> <span class="p">[</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">domain_schemas</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">ml_schema</span><span class="p">]:</span>
            <span class="n">schema</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">schemas</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">schema_name</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">schema</span><span class="p">:</span>
                <span class="n">candidate_tables</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">schema</span><span class="o">.</span><span class="n">tables</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>

    <span class="n">pb</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pathBuilder</span><span class="p">()</span>

    <span class="c1"># Query each candidate table for matching RIDs</span>
    <span class="k">for</span> <span class="n">table</span> <span class="ow">in</span> <span class="n">candidate_tables</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">remaining_rids</span><span class="p">:</span>
            <span class="k">break</span>

        <span class="n">schema_name</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">schema</span><span class="o">.</span><span class="n">name</span>
        <span class="n">table_name</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">name</span>

        <span class="c1"># Build a query with RID filter for all remaining RIDs</span>
        <span class="n">table_path</span> <span class="o">=</span> <span class="n">pb</span><span class="o">.</span><span class="n">schemas</span><span class="p">[</span><span class="n">schema_name</span><span class="p">]</span><span class="o">.</span><span class="n">tables</span><span class="p">[</span><span class="n">table_name</span><span class="p">]</span>

        <span class="c1"># Use ERMrest&#39;s Any quantifier for IN-style query</span>
        <span class="c1"># Query only for RID column to minimize data transfer</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Filter: RID = any(rid1, rid2, ...) - ERMrest&#39;s way of doing IN clause</span>
            <span class="n">found_entities</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span>
                <span class="n">table_path</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">table_path</span><span class="o">.</span><span class="n">RID</span> <span class="o">==</span> <span class="n">AnyQuantifier</span><span class="p">(</span><span class="o">*</span><span class="n">remaining_rids</span><span class="p">))</span>
                <span class="o">.</span><span class="n">attributes</span><span class="p">(</span><span class="n">table_path</span><span class="o">.</span><span class="n">RID</span><span class="p">)</span>
                <span class="o">.</span><span class="n">fetch</span><span class="p">()</span>
            <span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="c1"># Table might not support this query, skip it</span>
            <span class="k">continue</span>

        <span class="c1"># Process found RIDs</span>
        <span class="k">for</span> <span class="n">entity</span> <span class="ow">in</span> <span class="n">found_entities</span><span class="p">:</span>
            <span class="n">rid</span> <span class="o">=</span> <span class="n">entity</span><span class="p">[</span><span class="s2">&quot;RID&quot;</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">rid</span> <span class="ow">in</span> <span class="n">remaining_rids</span><span class="p">:</span>
                <span class="n">results</span><span class="p">[</span><span class="n">rid</span><span class="p">]</span> <span class="o">=</span> <span class="n">BatchRidResult</span><span class="p">(</span>
                    <span class="n">rid</span><span class="o">=</span><span class="n">rid</span><span class="p">,</span>
                    <span class="n">table</span><span class="o">=</span><span class="n">table</span><span class="p">,</span>
                    <span class="n">table_name</span><span class="o">=</span><span class="n">table_name</span><span class="p">,</span>
                    <span class="n">schema_name</span><span class="o">=</span><span class="n">schema_name</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="n">remaining_rids</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">rid</span><span class="p">)</span>

    <span class="c1"># Check if any RIDs were not found</span>
    <span class="k">if</span> <span class="n">remaining_rids</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">DerivaMLException</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid RIDs: </span><span class="si">{</span><span class="n">remaining_rids</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">results</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="deriva_ml.core.DerivaML.restore_execution" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">restore_execution</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">restore_execution</span><span class="p">(</span>
    <span class="n">execution_rid</span><span class="p">:</span> <span class="n">RID</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Execution&quot;</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Restores a previous execution.</p>
<p>Given an execution RID, retrieves the execution configuration and restores the local compute environment.
This routine has a number of side effects.</p>
<ol>
<li>
<p>The datasets specified in the configuration are downloaded and placed in the cache-dir. If a version is
not specified in the configuration, then a new minor version number is created for the dataset and downloaded.</p>
</li>
<li>
<p>If any execution assets are provided in the configuration, they are downloaded and placed
in the working directory.</p>
</li>
</ol>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>execution_rid</code>
            </td>
            <td>
                  <code><span title="deriva_ml.core.definitions.RID">RID</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Resource Identifier (RID) of the execution to restore.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>Execution</code></td>            <td>
                  <code>&#39;Execution&#39;</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An execution object representing the restored execution environment.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="DerivaMLException (deriva_ml.core.exceptions.DerivaMLException)" href="../exceptions/#deriva_ml.core.exceptions.DerivaMLException">DerivaMLException</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If execution_rid is not valid or execution cannot be restored.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>execution = ml.restore_execution("1-abc123")</p>
</blockquote>
</blockquote>
</blockquote>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/deriva_ml/core/mixins/execution.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">restore_execution</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">execution_rid</span><span class="p">:</span> <span class="n">RID</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Execution&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Restores a previous execution.</span>

<span class="sd">    Given an execution RID, retrieves the execution configuration and restores the local compute environment.</span>
<span class="sd">    This routine has a number of side effects.</span>

<span class="sd">    1. The datasets specified in the configuration are downloaded and placed in the cache-dir. If a version is</span>
<span class="sd">    not specified in the configuration, then a new minor version number is created for the dataset and downloaded.</span>

<span class="sd">    2. If any execution assets are provided in the configuration, they are downloaded and placed</span>
<span class="sd">    in the working directory.</span>

<span class="sd">    Args:</span>
<span class="sd">        execution_rid: Resource Identifier (RID) of the execution to restore.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Execution: An execution object representing the restored execution environment.</span>

<span class="sd">    Raises:</span>
<span class="sd">        DerivaMLException: If execution_rid is not valid or execution cannot be restored.</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; execution = ml.restore_execution(&quot;1-abc123&quot;)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Import here to avoid circular dependency</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">deriva_ml.execution.execution</span><span class="w"> </span><span class="kn">import</span> <span class="n">Execution</span>

    <span class="c1"># If no RID provided, try to find single execution in working directory</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">execution_rid</span><span class="p">:</span>
        <span class="n">e_rids</span> <span class="o">=</span> <span class="n">execution_rids</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">working_dir</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">e_rids</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DerivaMLException</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Multiple execution RIDs were found </span><span class="si">{</span><span class="n">e_rids</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
        <span class="n">execution_rid</span> <span class="o">=</span> <span class="n">e_rids</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="c1"># Try to load configuration from a file</span>
    <span class="n">cfile</span> <span class="o">=</span> <span class="n">asset_file_path</span><span class="p">(</span>
        <span class="n">prefix</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">working_dir</span><span class="p">,</span>
        <span class="n">exec_rid</span><span class="o">=</span><span class="n">execution_rid</span><span class="p">,</span>
        <span class="n">file_name</span><span class="o">=</span><span class="s2">&quot;configuration.json&quot;</span><span class="p">,</span>
        <span class="n">asset_table</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">name_to_table</span><span class="p">(</span><span class="s2">&quot;Execution_Metadata&quot;</span><span class="p">),</span>
        <span class="n">metadata</span><span class="o">=</span><span class="p">{},</span>
    <span class="p">)</span>

    <span class="c1"># Load configuration from a file or create from an execution record</span>
    <span class="k">if</span> <span class="n">cfile</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
        <span class="n">configuration</span> <span class="o">=</span> <span class="n">ExecutionConfiguration</span><span class="o">.</span><span class="n">load_configuration</span><span class="p">(</span><span class="n">cfile</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">execution</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">retrieve_rid</span><span class="p">(</span><span class="n">execution_rid</span><span class="p">)</span>
        <span class="c1"># Look up the workflow object from the RID</span>
        <span class="n">workflow_rid</span> <span class="o">=</span> <span class="n">execution</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Workflow&quot;</span><span class="p">)</span>
        <span class="n">workflow</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lookup_workflow</span><span class="p">(</span><span class="n">workflow_rid</span><span class="p">)</span> <span class="k">if</span> <span class="n">workflow_rid</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="n">configuration</span> <span class="o">=</span> <span class="n">ExecutionConfiguration</span><span class="p">(</span>
            <span class="n">workflow</span><span class="o">=</span><span class="n">workflow</span><span class="p">,</span>
            <span class="n">description</span><span class="o">=</span><span class="n">execution</span><span class="p">[</span><span class="s2">&quot;Description&quot;</span><span class="p">],</span>
        <span class="p">)</span>

    <span class="c1"># Create and return an execution instance</span>
    <span class="k">return</span> <span class="n">Execution</span><span class="p">(</span><span class="n">configuration</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">reload</span><span class="o">=</span><span class="n">execution_rid</span><span class="p">)</span>  <span class="c1"># type: ignore[arg-type]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="deriva_ml.core.DerivaML.retrieve_rid" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">retrieve_rid</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">retrieve_rid</span><span class="p">(</span>
    <span class="n">rid</span><span class="p">:</span> <span class="n">RID</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Retrieves complete record for RID.</p>
<p>Fetches all column values for the entity identified by the RID.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>rid</code>
            </td>
            <td>
                  <code><span title="deriva_ml.core.definitions.RID">RID</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Resource Identifier of the record to retrieve.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dict[str, Any]: Dictionary containing all column values for the entity.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="DerivaMLException (deriva_ml.core.exceptions.DerivaMLException)" href="../exceptions/#deriva_ml.core.exceptions.DerivaMLException">DerivaMLException</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the RID doesn't exist in the catalog.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>record = ml.retrieve_rid("1-abc123")
print(f"Name: {record['name']}, Created: {record['creation_date']}")</p>
</blockquote>
</blockquote>
</blockquote>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/deriva_ml/core/mixins/rid_resolution.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">retrieve_rid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rid</span><span class="p">:</span> <span class="n">RID</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Retrieves complete record for RID.</span>

<span class="sd">    Fetches all column values for the entity identified by the RID.</span>

<span class="sd">    Args:</span>
<span class="sd">        rid: Resource Identifier of the record to retrieve.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict[str, Any]: Dictionary containing all column values for the entity.</span>

<span class="sd">    Raises:</span>
<span class="sd">        DerivaMLException: If the RID doesn&#39;t exist in the catalog.</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; record = ml.retrieve_rid(&quot;1-abc123&quot;)</span>
<span class="sd">        &gt;&gt;&gt; print(f&quot;Name: {record[&#39;name&#39;]}, Created: {record[&#39;creation_date&#39;]}&quot;)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Resolve RID and fetch the first (only) matching record</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">resolve_rid</span><span class="p">(</span><span class="n">rid</span><span class="p">)</span><span class="o">.</span><span class="n">datapath</span><span class="o">.</span><span class="n">entities</span><span class="p">()</span><span class="o">.</span><span class="n">fetch</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="deriva_ml.core.DerivaML.set_column_display" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">set_column_display</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">set_column_display</span><span class="p">(</span>
    <span class="n">table</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Table</span><span class="p">,</span>
    <span class="n">column_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">annotation</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Set the column-display annotation on a column.</p>
<p>Controls how a column's values are rendered, including custom
formatting and markdown patterns.
Changes are staged locally until apply_annotations() is called.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>table</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <span title="deriva_ml.core.mixins.annotation.Table">Table</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Table name or Table object containing the column.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>column_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the column.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>annotation</code>
            </td>
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The column-display annotation value. Set to None to remove.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Column identifier (table.column).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>ml.set_column_display("Measurement", "Value", {
...     "*": {"pre_format": {"format": "%.2f"}}
... })
ml.apply_annotations()</p>
</blockquote>
</blockquote>
</blockquote>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/deriva_ml/core/mixins/annotation.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="n">ConfigDict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="k">def</span><span class="w"> </span><span class="nf">set_column_display</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">table</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Table</span><span class="p">,</span>
    <span class="n">column_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">annotation</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Set the column-display annotation on a column.</span>

<span class="sd">    Controls how a column&#39;s values are rendered, including custom</span>
<span class="sd">    formatting and markdown patterns.</span>
<span class="sd">    Changes are staged locally until apply_annotations() is called.</span>

<span class="sd">    Args:</span>
<span class="sd">        table: Table name or Table object containing the column.</span>
<span class="sd">        column_name: Name of the column.</span>
<span class="sd">        annotation: The column-display annotation value. Set to None to remove.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Column identifier (table.column).</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; ml.set_column_display(&quot;Measurement&quot;, &quot;Value&quot;, {</span>
<span class="sd">        ...     &quot;*&quot;: {&quot;pre_format&quot;: {&quot;format&quot;: &quot;%.2f&quot;}}</span>
<span class="sd">        ... })</span>
<span class="sd">        &gt;&gt;&gt; ml.apply_annotations()</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">table_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">name_to_table</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>
    <span class="n">column</span> <span class="o">=</span> <span class="n">table_obj</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">column_name</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">annotation</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">column</span><span class="o">.</span><span class="n">annotations</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">COLUMN_DISPLAY_TAG</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">column</span><span class="o">.</span><span class="n">annotations</span><span class="p">[</span><span class="n">COLUMN_DISPLAY_TAG</span><span class="p">]</span> <span class="o">=</span> <span class="n">annotation</span>

    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">table_obj</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">column_name</span><span class="si">}</span><span class="s2">&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="deriva_ml.core.DerivaML.set_display_annotation" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">set_display_annotation</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">set_display_annotation</span><span class="p">(</span>
    <span class="n">table</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Table</span><span class="p">,</span>
    <span class="n">annotation</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">column_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Set the display annotation on a table or column.</p>
<p>The display annotation controls basic naming and display options.
Changes are staged locally until apply_annotations() is called.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>table</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <span title="deriva_ml.core.mixins.annotation.Table">Table</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Table name or Table object.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>annotation</code>
            </td>
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The display annotation value. Set to None to remove.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>column_name</code>
            </td>
            <td>
                  <code><span title="str">str</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If provided, sets annotation on the column; otherwise on the table.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Target identifier (table name or table.column).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>ml.set_display_annotation("Image", {"name": "Images"})
ml.set_display_annotation("Image", {"name": "File Name"}, column_name="Filename")
ml.apply_annotations()  # Commit changes</p>
</blockquote>
</blockquote>
</blockquote>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/deriva_ml/core/mixins/annotation.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="n">ConfigDict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="k">def</span><span class="w"> </span><span class="nf">set_display_annotation</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">table</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Table</span><span class="p">,</span>
    <span class="n">annotation</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">column_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Set the display annotation on a table or column.</span>

<span class="sd">    The display annotation controls basic naming and display options.</span>
<span class="sd">    Changes are staged locally until apply_annotations() is called.</span>

<span class="sd">    Args:</span>
<span class="sd">        table: Table name or Table object.</span>
<span class="sd">        annotation: The display annotation value. Set to None to remove.</span>
<span class="sd">        column_name: If provided, sets annotation on the column; otherwise on the table.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Target identifier (table name or table.column).</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; ml.set_display_annotation(&quot;Image&quot;, {&quot;name&quot;: &quot;Images&quot;})</span>
<span class="sd">        &gt;&gt;&gt; ml.set_display_annotation(&quot;Image&quot;, {&quot;name&quot;: &quot;File Name&quot;}, column_name=&quot;Filename&quot;)</span>
<span class="sd">        &gt;&gt;&gt; ml.apply_annotations()  # Commit changes</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">table_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">name_to_table</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">column_name</span><span class="p">:</span>
        <span class="n">column</span> <span class="o">=</span> <span class="n">table_obj</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">column_name</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">annotation</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">column</span><span class="o">.</span><span class="n">annotations</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">DISPLAY_TAG</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">column</span><span class="o">.</span><span class="n">annotations</span><span class="p">[</span><span class="n">DISPLAY_TAG</span><span class="p">]</span> <span class="o">=</span> <span class="n">annotation</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">table_obj</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">column_name</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">annotation</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">table_obj</span><span class="o">.</span><span class="n">annotations</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">DISPLAY_TAG</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">table_obj</span><span class="o">.</span><span class="n">annotations</span><span class="p">[</span><span class="n">DISPLAY_TAG</span><span class="p">]</span> <span class="o">=</span> <span class="n">annotation</span>
        <span class="k">return</span> <span class="n">table_obj</span><span class="o">.</span><span class="n">name</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="deriva_ml.core.DerivaML.set_table_display" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">set_table_display</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">set_table_display</span><span class="p">(</span>
    <span class="n">table</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Table</span><span class="p">,</span>
    <span class="n">annotation</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Set the table-display annotation on a table.</p>
<p>Controls table-level display options like row naming patterns,
page size, and row ordering.
Changes are staged locally until apply_annotations() is called.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>table</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <span title="deriva_ml.core.mixins.annotation.Table">Table</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Table name or Table object.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>annotation</code>
            </td>
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The table-display annotation value. Set to None to remove.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Table name.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>ml.set_table_display("Subject", {
...     "row_name": {
...         "row_markdown_pattern": "{{{Name}}} ({{{Species}}})"
...     }
... })
ml.apply_annotations()</p>
</blockquote>
</blockquote>
</blockquote>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/deriva_ml/core/mixins/annotation.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="n">ConfigDict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="k">def</span><span class="w"> </span><span class="nf">set_table_display</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">table</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Table</span><span class="p">,</span>
    <span class="n">annotation</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Set the table-display annotation on a table.</span>

<span class="sd">    Controls table-level display options like row naming patterns,</span>
<span class="sd">    page size, and row ordering.</span>
<span class="sd">    Changes are staged locally until apply_annotations() is called.</span>

<span class="sd">    Args:</span>
<span class="sd">        table: Table name or Table object.</span>
<span class="sd">        annotation: The table-display annotation value. Set to None to remove.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Table name.</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; ml.set_table_display(&quot;Subject&quot;, {</span>
<span class="sd">        ...     &quot;row_name&quot;: {</span>
<span class="sd">        ...         &quot;row_markdown_pattern&quot;: &quot;{{{Name}}} ({{{Species}}})&quot;</span>
<span class="sd">        ...     }</span>
<span class="sd">        ... })</span>
<span class="sd">        &gt;&gt;&gt; ml.apply_annotations()</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">table_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">name_to_table</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">annotation</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">table_obj</span><span class="o">.</span><span class="n">annotations</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">TABLE_DISPLAY_TAG</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">table_obj</span><span class="o">.</span><span class="n">annotations</span><span class="p">[</span><span class="n">TABLE_DISPLAY_TAG</span><span class="p">]</span> <span class="o">=</span> <span class="n">annotation</span>

    <span class="k">return</span> <span class="n">table_obj</span><span class="o">.</span><span class="n">name</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="deriva_ml.core.DerivaML.set_visible_columns" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">set_visible_columns</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">set_visible_columns</span><span class="p">(</span>
    <span class="n">table</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Table</span><span class="p">,</span>
    <span class="n">annotation</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Set the visible-columns annotation on a table.</p>
<p>Controls which columns appear in different UI contexts and their order.
Changes are staged locally until apply_annotations() is called.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>table</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <span title="deriva_ml.core.mixins.annotation.Table">Table</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Table name or Table object.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>annotation</code>
            </td>
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The visible-columns annotation value. Set to None to remove.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Table name.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>ml.set_visible_columns("Image", {
...     "compact": ["RID", "Filename", "Subject"],
...     "detailed": ["RID", "Filename", "Subject", "Description"]
... })
ml.apply_annotations()</p>
</blockquote>
</blockquote>
</blockquote>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/deriva_ml/core/mixins/annotation.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="n">ConfigDict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="k">def</span><span class="w"> </span><span class="nf">set_visible_columns</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">table</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Table</span><span class="p">,</span>
    <span class="n">annotation</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Set the visible-columns annotation on a table.</span>

<span class="sd">    Controls which columns appear in different UI contexts and their order.</span>
<span class="sd">    Changes are staged locally until apply_annotations() is called.</span>

<span class="sd">    Args:</span>
<span class="sd">        table: Table name or Table object.</span>
<span class="sd">        annotation: The visible-columns annotation value. Set to None to remove.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Table name.</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; ml.set_visible_columns(&quot;Image&quot;, {</span>
<span class="sd">        ...     &quot;compact&quot;: [&quot;RID&quot;, &quot;Filename&quot;, &quot;Subject&quot;],</span>
<span class="sd">        ...     &quot;detailed&quot;: [&quot;RID&quot;, &quot;Filename&quot;, &quot;Subject&quot;, &quot;Description&quot;]</span>
<span class="sd">        ... })</span>
<span class="sd">        &gt;&gt;&gt; ml.apply_annotations()</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">table_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">name_to_table</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">annotation</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">table_obj</span><span class="o">.</span><span class="n">annotations</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">VISIBLE_COLUMNS_TAG</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">table_obj</span><span class="o">.</span><span class="n">annotations</span><span class="p">[</span><span class="n">VISIBLE_COLUMNS_TAG</span><span class="p">]</span> <span class="o">=</span> <span class="n">annotation</span>

    <span class="k">return</span> <span class="n">table_obj</span><span class="o">.</span><span class="n">name</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="deriva_ml.core.DerivaML.set_visible_foreign_keys" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">set_visible_foreign_keys</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">set_visible_foreign_keys</span><span class="p">(</span>
    <span class="n">table</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Table</span><span class="p">,</span>
    <span class="n">annotation</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Set the visible-foreign-keys annotation on a table.</p>
<p>Controls which related tables (via inbound foreign keys) appear in
different UI contexts and their order.
Changes are staged locally until apply_annotations() is called.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>table</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <span title="deriva_ml.core.mixins.annotation.Table">Table</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Table name or Table object.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>annotation</code>
            </td>
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The visible-foreign-keys annotation value. Set to None to remove.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Table name.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>ml.set_visible_foreign_keys("Subject", {
...     "detailed": [
...         ["domain", "Image_Subject_fkey"],
...         ["domain", "Diagnosis_Subject_fkey"]
...     ]
... })
ml.apply_annotations()</p>
</blockquote>
</blockquote>
</blockquote>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/deriva_ml/core/mixins/annotation.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validate_call</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="n">ConfigDict</span><span class="p">(</span><span class="n">arbitrary_types_allowed</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="k">def</span><span class="w"> </span><span class="nf">set_visible_foreign_keys</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">table</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Table</span><span class="p">,</span>
    <span class="n">annotation</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Set the visible-foreign-keys annotation on a table.</span>

<span class="sd">    Controls which related tables (via inbound foreign keys) appear in</span>
<span class="sd">    different UI contexts and their order.</span>
<span class="sd">    Changes are staged locally until apply_annotations() is called.</span>

<span class="sd">    Args:</span>
<span class="sd">        table: Table name or Table object.</span>
<span class="sd">        annotation: The visible-foreign-keys annotation value. Set to None to remove.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Table name.</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; ml.set_visible_foreign_keys(&quot;Subject&quot;, {</span>
<span class="sd">        ...     &quot;detailed&quot;: [</span>
<span class="sd">        ...         [&quot;domain&quot;, &quot;Image_Subject_fkey&quot;],</span>
<span class="sd">        ...         [&quot;domain&quot;, &quot;Diagnosis_Subject_fkey&quot;]</span>
<span class="sd">        ...     ]</span>
<span class="sd">        ... })</span>
<span class="sd">        &gt;&gt;&gt; ml.apply_annotations()</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">table_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">name_to_table</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">annotation</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">table_obj</span><span class="o">.</span><span class="n">annotations</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">VISIBLE_FOREIGN_KEYS_TAG</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">table_obj</span><span class="o">.</span><span class="n">annotations</span><span class="p">[</span><span class="n">VISIBLE_FOREIGN_KEYS_TAG</span><span class="p">]</span> <span class="o">=</span> <span class="n">annotation</span>

    <span class="k">return</span> <span class="n">table_obj</span><span class="o">.</span><span class="n">name</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="deriva_ml.core.DerivaML.table_path" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">table_path</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">table_path</span><span class="p">(</span>
    <span class="n">table</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Table</span><span class="p">,</span>
    <span class="n">schema</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Path</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Returns a local filesystem path for table CSV files.</p>
<p>Generates a standardized path where CSV files should be placed when preparing to upload data to a table.
The path follows the project's directory structure conventions.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>table</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <span title="deriva_ml.core.mixins.path_builder.Table">Table</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the table or Table object to get the path for.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>schema</code>
            </td>
            <td>
                  <code><span title="str">str</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Schema name for the path. If None, uses the table's schema or default_schema.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>Path</code></td>            <td>
                  <code><span title="pathlib.Path">Path</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Filesystem path where the CSV file should be placed.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>path = ml.table_path("experiment_results")
df.to_csv(path) # Save data for upload</p>
</blockquote>
</blockquote>
</blockquote>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/deriva_ml/core/mixins/path_builder.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">table_path</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Table</span><span class="p">,</span> <span class="n">schema</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Path</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns a local filesystem path for table CSV files.</span>

<span class="sd">    Generates a standardized path where CSV files should be placed when preparing to upload data to a table.</span>
<span class="sd">    The path follows the project&#39;s directory structure conventions.</span>

<span class="sd">    Args:</span>
<span class="sd">        table: Name of the table or Table object to get the path for.</span>
<span class="sd">        schema: Schema name for the path. If None, uses the table&#39;s schema or default_schema.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Path: Filesystem path where the CSV file should be placed.</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; path = ml.table_path(&quot;experiment_results&quot;)</span>
<span class="sd">        &gt;&gt;&gt; df.to_csv(path) # Save data for upload</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">table_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">name_to_table</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>
    <span class="c1"># Use table&#39;s schema if available, otherwise use provided schema or default</span>
    <span class="n">schema</span> <span class="o">=</span> <span class="n">schema</span> <span class="ow">or</span> <span class="n">table_obj</span><span class="o">.</span><span class="n">schema</span><span class="o">.</span><span class="n">name</span>
    <span class="k">return</span> <span class="n">_table_path</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">working_dir</span><span class="p">,</span>
        <span class="n">schema</span><span class="o">=</span><span class="n">schema</span><span class="p">,</span>
        <span class="n">table</span><span class="o">=</span><span class="n">table_obj</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="deriva_ml.core.DerivaML.user_list" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">user_list</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">user_list</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Returns catalog user list.</p>
<p>Retrieves basic information about all users who have access to the catalog, including their
identifiers and full names.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.List">List</span>[<span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="str">str</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List[Dict[str, str]]: List of user information dictionaries, each containing:
- 'ID': User identifier
- 'Full_Name': User's full name</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
        <p>Examples:</p>
<pre><code>&gt;&gt;&gt; users = ml.user_list()
&gt;&gt;&gt; for user in users:
...     print(f"{user['Full_Name']} ({user['ID']})")
</code></pre>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/deriva_ml/core/base.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">user_list</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns catalog user list.</span>

<span class="sd">    Retrieves basic information about all users who have access to the catalog, including their</span>
<span class="sd">    identifiers and full names.</span>

<span class="sd">    Returns:</span>
<span class="sd">        List[Dict[str, str]]: List of user information dictionaries, each containing:</span>
<span class="sd">            - &#39;ID&#39;: User identifier</span>
<span class="sd">            - &#39;Full_Name&#39;: User&#39;s full name</span>

<span class="sd">    Examples:</span>

<span class="sd">        &gt;&gt;&gt; users = ml.user_list()</span>
<span class="sd">        &gt;&gt;&gt; for user in users:</span>
<span class="sd">        ...     print(f&quot;{user[&#39;Full_Name&#39;]} ({user[&#39;ID&#39;]})&quot;)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Get the user table path and fetch basic user info</span>
    <span class="n">user_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pathBuilder</span><span class="p">()</span><span class="o">.</span><span class="n">public</span><span class="o">.</span><span class="n">ERMrest_Client</span><span class="o">.</span><span class="n">path</span>
    <span class="k">return</span> <span class="p">[{</span><span class="s2">&quot;ID&quot;</span><span class="p">:</span> <span class="n">u</span><span class="p">[</span><span class="s2">&quot;ID&quot;</span><span class="p">],</span> <span class="s2">&quot;Full_Name&quot;</span><span class="p">:</span> <span class="n">u</span><span class="p">[</span><span class="s2">&quot;Full_Name&quot;</span><span class="p">]}</span> <span class="k">for</span> <span class="n">u</span> <span class="ow">in</span> <span class="n">user_path</span><span class="o">.</span><span class="n">entities</span><span class="p">()</span><span class="o">.</span><span class="n">fetch</span><span class="p">()]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="deriva_ml.core.DerivaML.validate_schema" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">validate_schema</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">validate_schema</span><span class="p">(</span>
    <span class="n">strict</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;SchemaValidationReport&quot;</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Validate that the catalog's ML schema matches the expected structure.</p>
<p>This method inspects the catalog schema and verifies that it contains all
the required tables, columns, vocabulary terms, and relationships that are
created by the ML schema initialization routines in create_schema.py.</p>
<p>The validation checks:
- All required ML tables exist (Dataset, Execution, Workflow, etc.)
- All required columns exist with correct types
- All required vocabulary tables exist (Asset_Type, Dataset_Type, etc.)
- All required vocabulary terms are initialized
- All association tables exist for relationships</p>
<p>In strict mode, the validator also reports errors for:
- Extra tables not in the expected schema
- Extra columns not in the expected table definitions</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>strict</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, extra tables and columns are reported as errors.
   If False (default), they are reported as informational items.
   Use strict=True to verify a clean ML catalog matches exactly.
   Use strict=False to validate a catalog that may have domain extensions.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>&#39;SchemaValidationReport&#39;</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>SchemaValidationReport with validation results. Key attributes:
- is_valid: True if no errors were found
- errors: List of error-level issues
- warnings: List of warning-level issues
- info: List of informational items
- to_text(): Human-readable report
- to_dict(): JSON-serializable dictionary</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>ml = DerivaML('localhost', 'my_catalog')
report = ml.validate_schema(strict=False)
if report.is_valid:
...     print("Schema is valid!")
... else:
...     print(report.to_text())</p>
<h4 id="deriva_ml.core.DerivaML.validate_schema--strict-validation-for-a-fresh-ml-catalog">Strict validation for a fresh ML catalog</h4>
<p>report = ml.validate_schema(strict=True)
print(f"Found {len(report.errors)} errors, {len(report.warnings)} warnings")</p>
<h4 id="deriva_ml.core.DerivaML.validate_schema--get-report-as-dictionary-for-jsonlogging">Get report as dictionary for JSON/logging</h4>
<p>import json
print(json.dumps(report.to_dict(), indent=2))</p>
</blockquote>
</blockquote>
</blockquote>
</details>

<details class="note" open>
  <summary>Note</summary>
  <p>This method validates the ML schema (typically 'deriva-ml'), not the
domain schema. Domain-specific tables and columns are not checked
unless they are part of the ML schema itself.</p>
</details>

<details class="see-also" open>
  <summary>See Also</summary>
  <ul>
<li>deriva_ml.schema.validation.SchemaValidationReport</li>
<li>deriva_ml.schema.validation.validate_ml_schema</li>
</ul>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/deriva_ml/core/base.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1245</span>
<span class="normal">1246</span>
<span class="normal">1247</span>
<span class="normal">1248</span>
<span class="normal">1249</span>
<span class="normal">1250</span>
<span class="normal">1251</span>
<span class="normal">1252</span>
<span class="normal">1253</span>
<span class="normal">1254</span>
<span class="normal">1255</span>
<span class="normal">1256</span>
<span class="normal">1257</span>
<span class="normal">1258</span>
<span class="normal">1259</span>
<span class="normal">1260</span>
<span class="normal">1261</span>
<span class="normal">1262</span>
<span class="normal">1263</span>
<span class="normal">1264</span>
<span class="normal">1265</span>
<span class="normal">1266</span>
<span class="normal">1267</span>
<span class="normal">1268</span>
<span class="normal">1269</span>
<span class="normal">1270</span>
<span class="normal">1271</span>
<span class="normal">1272</span>
<span class="normal">1273</span>
<span class="normal">1274</span>
<span class="normal">1275</span>
<span class="normal">1276</span>
<span class="normal">1277</span>
<span class="normal">1278</span>
<span class="normal">1279</span>
<span class="normal">1280</span>
<span class="normal">1281</span>
<span class="normal">1282</span>
<span class="normal">1283</span>
<span class="normal">1284</span>
<span class="normal">1285</span>
<span class="normal">1286</span>
<span class="normal">1287</span>
<span class="normal">1288</span>
<span class="normal">1289</span>
<span class="normal">1290</span>
<span class="normal">1291</span>
<span class="normal">1292</span>
<span class="normal">1293</span>
<span class="normal">1294</span>
<span class="normal">1295</span>
<span class="normal">1296</span>
<span class="normal">1297</span>
<span class="normal">1298</span>
<span class="normal">1299</span>
<span class="normal">1300</span>
<span class="normal">1301</span>
<span class="normal">1302</span>
<span class="normal">1303</span>
<span class="normal">1304</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">validate_schema</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">strict</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;SchemaValidationReport&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Validate that the catalog&#39;s ML schema matches the expected structure.</span>

<span class="sd">    This method inspects the catalog schema and verifies that it contains all</span>
<span class="sd">    the required tables, columns, vocabulary terms, and relationships that are</span>
<span class="sd">    created by the ML schema initialization routines in create_schema.py.</span>

<span class="sd">    The validation checks:</span>
<span class="sd">    - All required ML tables exist (Dataset, Execution, Workflow, etc.)</span>
<span class="sd">    - All required columns exist with correct types</span>
<span class="sd">    - All required vocabulary tables exist (Asset_Type, Dataset_Type, etc.)</span>
<span class="sd">    - All required vocabulary terms are initialized</span>
<span class="sd">    - All association tables exist for relationships</span>

<span class="sd">    In strict mode, the validator also reports errors for:</span>
<span class="sd">    - Extra tables not in the expected schema</span>
<span class="sd">    - Extra columns not in the expected table definitions</span>

<span class="sd">    Args:</span>
<span class="sd">        strict: If True, extra tables and columns are reported as errors.</span>
<span class="sd">               If False (default), they are reported as informational items.</span>
<span class="sd">               Use strict=True to verify a clean ML catalog matches exactly.</span>
<span class="sd">               Use strict=False to validate a catalog that may have domain extensions.</span>

<span class="sd">    Returns:</span>
<span class="sd">        SchemaValidationReport with validation results. Key attributes:</span>
<span class="sd">            - is_valid: True if no errors were found</span>
<span class="sd">            - errors: List of error-level issues</span>
<span class="sd">            - warnings: List of warning-level issues</span>
<span class="sd">            - info: List of informational items</span>
<span class="sd">            - to_text(): Human-readable report</span>
<span class="sd">            - to_dict(): JSON-serializable dictionary</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; ml = DerivaML(&#39;localhost&#39;, &#39;my_catalog&#39;)</span>
<span class="sd">        &gt;&gt;&gt; report = ml.validate_schema(strict=False)</span>
<span class="sd">        &gt;&gt;&gt; if report.is_valid:</span>
<span class="sd">        ...     print(&quot;Schema is valid!&quot;)</span>
<span class="sd">        ... else:</span>
<span class="sd">        ...     print(report.to_text())</span>

<span class="sd">        &gt;&gt;&gt; # Strict validation for a fresh ML catalog</span>
<span class="sd">        &gt;&gt;&gt; report = ml.validate_schema(strict=True)</span>
<span class="sd">        &gt;&gt;&gt; print(f&quot;Found {len(report.errors)} errors, {len(report.warnings)} warnings&quot;)</span>

<span class="sd">        &gt;&gt;&gt; # Get report as dictionary for JSON/logging</span>
<span class="sd">        &gt;&gt;&gt; import json</span>
<span class="sd">        &gt;&gt;&gt; print(json.dumps(report.to_dict(), indent=2))</span>

<span class="sd">    Note:</span>
<span class="sd">        This method validates the ML schema (typically &#39;deriva-ml&#39;), not the</span>
<span class="sd">        domain schema. Domain-specific tables and columns are not checked</span>
<span class="sd">        unless they are part of the ML schema itself.</span>

<span class="sd">    See Also:</span>
<span class="sd">        - deriva_ml.schema.validation.SchemaValidationReport</span>
<span class="sd">        - deriva_ml.schema.validation.validate_ml_schema</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">deriva_ml.schema.validation</span><span class="w"> </span><span class="kn">import</span> <span class="n">validate_ml_schema</span>
    <span class="k">return</span> <span class="n">validate_ml_schema</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="n">strict</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="deriva_ml.core.DerivaMLConfig" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">DerivaMLConfig</span>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="pydantic.BaseModel">BaseModel</span></code></p>



        <p>Configuration model for DerivaML instances.</p>
<p>This Pydantic model defines all configurable parameters for a DerivaML instance.
It can be used directly or via Hydra configuration files.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="deriva_ml.core.DerivaMLConfig.hostname">hostname</span></code></td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Hostname of the Deriva server (e.g., 'deriva.example.org').</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="deriva_ml.core.DerivaMLConfig.catalog_id">catalog_id</span></code></td>
            <td>
                  <code><span title="str">str</span> | <span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Catalog identifier, either numeric ID or catalog name.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="deriva_ml.core.DerivaMLConfig.domain_schemas">domain_schemas</span></code></td>
            <td>
                  <code><span title="str">str</span> | <span title="set">set</span>[<span title="str">str</span>] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional set of domain schema names. If None, auto-detects all
non-system schemas. Use this when working with catalogs that have multiple
user-defined schemas.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="deriva_ml.core.DerivaMLConfig.default_schema">default_schema</span></code></td>
            <td>
                  <code><span title="str">str</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The default schema for table creation operations. If None and
there is exactly one domain schema, that schema is used. If there are multiple
domain schemas, this must be specified for table creation to work without
explicit schema parameters.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="deriva_ml.core.DerivaMLConfig.project_name">project_name</span></code></td>
            <td>
                  <code><span title="str">str</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Project name for organizing outputs. Defaults to default_schema.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="deriva_ml.core.DerivaMLConfig.cache_dir">cache_dir</span></code></td>
            <td>
                  <code><span title="str">str</span> | <span title="pathlib.Path">Path</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Directory for caching downloaded datasets. Defaults to working_dir/cache.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="deriva_ml.core.DerivaMLConfig.working_dir">working_dir</span></code></td>
            <td>
                  <code><span title="str">str</span> | <span title="pathlib.Path">Path</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Base directory for computation data. Defaults to ~/deriva-ml.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="deriva_ml.core.DerivaMLConfig.hydra_runtime_output_dir">hydra_runtime_output_dir</span></code></td>
            <td>
                  <code><span title="str">str</span> | <span title="pathlib.Path">Path</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Hydra's runtime output directory (set automatically).</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="deriva_ml.core.DerivaMLConfig.ml_schema">ml_schema</span></code></td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Schema name for ML tables. Defaults to 'deriva-ml'.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="deriva_ml.core.DerivaMLConfig.logging_level">logging_level</span></code></td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Logging level for DerivaML. Defaults to WARNING.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="deriva_ml.core.DerivaMLConfig.deriva_logging_level">deriva_logging_level</span></code></td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Logging level for Deriva libraries. Defaults to WARNING.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="deriva_ml.core.DerivaMLConfig.credential">credential</span></code></td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Authentication credentials. If None, retrieved automatically.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="deriva_ml.core.DerivaMLConfig.s3_bucket">s3_bucket</span></code></td>
            <td>
                  <code><span title="str">str</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>S3 bucket URL for dataset bag storage (e.g., 's3://my-bucket').
If provided, enables MINID creation and S3 upload for dataset exports.
If None, MINID functionality is disabled regardless of use_minid setting.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="deriva_ml.core.DerivaMLConfig.use_minid">use_minid</span></code></td>
            <td>
                  <code><span title="bool">bool</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to use MINID service for dataset bags. Only effective when
s3_bucket is configured. Defaults to True when s3_bucket is set, False otherwise.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="deriva_ml.core.DerivaMLConfig.check_auth">check_auth</span></code></td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to verify authentication on connection. Defaults to True.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="deriva_ml.core.DerivaMLConfig.clean_execution_dir">clean_execution_dir</span></code></td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to automatically clean execution working directories
after successful upload. Defaults to True. Set to False to retain local copies
of execution outputs for debugging or manual inspection.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>config = DerivaMLConfig(
...     hostname='deriva.example.org',
...     catalog_id=1,
...     default_schema='my_domain',
...     logging_level=logging.INFO
... )</p>
</blockquote>
</blockquote>
</blockquote>
</details>







              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/deriva_ml/core/config.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">DerivaMLConfig</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Configuration model for DerivaML instances.</span>

<span class="sd">    This Pydantic model defines all configurable parameters for a DerivaML instance.</span>
<span class="sd">    It can be used directly or via Hydra configuration files.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        hostname: Hostname of the Deriva server (e.g., &#39;deriva.example.org&#39;).</span>
<span class="sd">        catalog_id: Catalog identifier, either numeric ID or catalog name.</span>
<span class="sd">        domain_schemas: Optional set of domain schema names. If None, auto-detects all</span>
<span class="sd">            non-system schemas. Use this when working with catalogs that have multiple</span>
<span class="sd">            user-defined schemas.</span>
<span class="sd">        default_schema: The default schema for table creation operations. If None and</span>
<span class="sd">            there is exactly one domain schema, that schema is used. If there are multiple</span>
<span class="sd">            domain schemas, this must be specified for table creation to work without</span>
<span class="sd">            explicit schema parameters.</span>
<span class="sd">        project_name: Project name for organizing outputs. Defaults to default_schema.</span>
<span class="sd">        cache_dir: Directory for caching downloaded datasets. Defaults to working_dir/cache.</span>
<span class="sd">        working_dir: Base directory for computation data. Defaults to ~/deriva-ml.</span>
<span class="sd">        hydra_runtime_output_dir: Hydra&#39;s runtime output directory (set automatically).</span>
<span class="sd">        ml_schema: Schema name for ML tables. Defaults to &#39;deriva-ml&#39;.</span>
<span class="sd">        logging_level: Logging level for DerivaML. Defaults to WARNING.</span>
<span class="sd">        deriva_logging_level: Logging level for Deriva libraries. Defaults to WARNING.</span>
<span class="sd">        credential: Authentication credentials. If None, retrieved automatically.</span>
<span class="sd">        s3_bucket: S3 bucket URL for dataset bag storage (e.g., &#39;s3://my-bucket&#39;).</span>
<span class="sd">            If provided, enables MINID creation and S3 upload for dataset exports.</span>
<span class="sd">            If None, MINID functionality is disabled regardless of use_minid setting.</span>
<span class="sd">        use_minid: Whether to use MINID service for dataset bags. Only effective when</span>
<span class="sd">            s3_bucket is configured. Defaults to True when s3_bucket is set, False otherwise.</span>
<span class="sd">        check_auth: Whether to verify authentication on connection. Defaults to True.</span>
<span class="sd">        clean_execution_dir: Whether to automatically clean execution working directories</span>
<span class="sd">            after successful upload. Defaults to True. Set to False to retain local copies</span>
<span class="sd">            of execution outputs for debugging or manual inspection.</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; config = DerivaMLConfig(</span>
<span class="sd">        ...     hostname=&#39;deriva.example.org&#39;,</span>
<span class="sd">        ...     catalog_id=1,</span>
<span class="sd">        ...     default_schema=&#39;my_domain&#39;,</span>
<span class="sd">        ...     logging_level=logging.INFO</span>
<span class="sd">        ... )</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">hostname</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">catalog_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">domain_schemas</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">set</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">default_schema</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">project_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">cache_dir</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">working_dir</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">hydra_runtime_output_dir</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">ml_schema</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">ML_SCHEMA</span>
    <span class="n">logging_level</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">WARNING</span>
    <span class="n">deriva_logging_level</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">WARNING</span>
    <span class="n">credential</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">s3_bucket</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">use_minid</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># None means &quot;auto&quot; - True if s3_bucket is set</span>
    <span class="n">check_auth</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">clean_execution_dir</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="nd">@model_validator</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="s2">&quot;after&quot;</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">init_working_dir</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;DerivaMLConfig&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize working directory and resolve use_minid after model validation.</span>

<span class="sd">        Sets up the working directory path, computing a default if not specified.</span>
<span class="sd">        Also captures Hydra&#39;s runtime output directory for logging and outputs.</span>

<span class="sd">        Resolves the use_minid flag based on s3_bucket configuration:</span>
<span class="sd">        - If use_minid is explicitly set, use that value (but it only takes effect if s3_bucket is set)</span>
<span class="sd">        - If use_minid is None (auto), set it to True if s3_bucket is configured, False otherwise</span>

<span class="sd">        This validator runs after all field validation and ensures the working</span>
<span class="sd">        directory is available for Hydra configuration resolution.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Self: The configuration instance with initialized paths.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">working_dir</span> <span class="o">=</span> <span class="n">DerivaMLConfig</span><span class="o">.</span><span class="n">compute_workdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">working_dir</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">catalog_id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">hostname</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hydra_runtime_output_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">HydraConfig</span><span class="o">.</span><span class="n">get</span><span class="p">()</span><span class="o">.</span><span class="n">runtime</span><span class="o">.</span><span class="n">output_dir</span><span class="p">)</span>

        <span class="c1"># Resolve use_minid based on s3_bucket configuration</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_minid</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># Auto mode: enable MINID if s3_bucket is configured</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">use_minid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">s3_bucket</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_minid</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">s3_bucket</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># User requested MINID but no S3 bucket configured - disable MINID</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">use_minid</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="k">return</span> <span class="bp">self</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">compute_workdir</span><span class="p">(</span>
        <span class="n">working_dir</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">catalog_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">hostname</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Path</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Compute the effective working directory path.</span>

<span class="sd">        Creates a standardized working directory path. If a base directory is provided,</span>
<span class="sd">        appends the current username to prevent conflicts between users. If no directory</span>
<span class="sd">        is provided, uses ~/.deriva-ml. The hostname and catalog_id are appended to</span>
<span class="sd">        separate data from different servers and catalogs.</span>

<span class="sd">        Args:</span>
<span class="sd">            working_dir: Base working directory path, or None for default.</span>
<span class="sd">            catalog_id: Catalog identifier to include in the path. If None, no</span>
<span class="sd">                       catalog subdirectory is created.</span>
<span class="sd">            hostname: Server hostname to include in the path. If None, no</span>
<span class="sd">                     hostname subdirectory is created.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Path: Absolute path to the working directory.</span>

<span class="sd">        Example:</span>
<span class="sd">            &gt;&gt;&gt; DerivaMLConfig.compute_workdir(&#39;/shared/data&#39;, &#39;52&#39;, &#39;ml.example.org&#39;)</span>
<span class="sd">            PosixPath(&#39;/shared/data/username/deriva-ml/ml.example.org/52&#39;)</span>
<span class="sd">            &gt;&gt;&gt; DerivaMLConfig.compute_workdir(None, 1, &#39;localhost&#39;)</span>
<span class="sd">            PosixPath(&#39;/home/username/.deriva-ml/localhost/1&#39;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Append username and deriva-ml to provided path, or use ~/.deriva-ml as base</span>
        <span class="k">if</span> <span class="n">working_dir</span><span class="p">:</span>
            <span class="n">base_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">working_dir</span><span class="p">)</span> <span class="o">/</span> <span class="n">getpass</span><span class="o">.</span><span class="n">getuser</span><span class="p">()</span> <span class="o">/</span> <span class="s2">&quot;deriva-ml&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">base_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="o">.</span><span class="n">home</span><span class="p">()</span> <span class="o">/</span> <span class="s2">&quot;.deriva-ml&quot;</span>
        <span class="c1"># Append hostname if provided to separate data from different servers</span>
        <span class="k">if</span> <span class="n">hostname</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">base_dir</span> <span class="o">=</span> <span class="n">base_dir</span> <span class="o">/</span> <span class="n">hostname</span>
        <span class="c1"># Append catalog_id if provided</span>
        <span class="k">if</span> <span class="n">catalog_id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">base_dir</span> <span class="o">=</span> <span class="n">base_dir</span> <span class="o">/</span> <span class="nb">str</span><span class="p">(</span><span class="n">catalog_id</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">base_dir</span><span class="o">.</span><span class="n">absolute</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h3 id="deriva_ml.core.DerivaMLConfig.compute_workdir" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">compute_workdir</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">compute_workdir</span><span class="p">(</span>
    <span class="n">working_dir</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">catalog_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">hostname</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Path</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Compute the effective working directory path.</p>
<p>Creates a standardized working directory path. If a base directory is provided,
appends the current username to prevent conflicts between users. If no directory
is provided, uses ~/.deriva-ml. The hostname and catalog_id are appended to
separate data from different servers and catalogs.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>working_dir</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <span title="pathlib.Path">Path</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Base working directory path, or None for default.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>catalog_id</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <span title="int">int</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Catalog identifier to include in the path. If None, no
       catalog subdirectory is created.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>hostname</code>
            </td>
            <td>
                  <code><span title="str">str</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Server hostname to include in the path. If None, no
     hostname subdirectory is created.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>Path</code></td>            <td>
                  <code><span title="pathlib.Path">Path</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Absolute path to the working directory.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>DerivaMLConfig.compute_workdir('/shared/data', '52', 'ml.example.org')
PosixPath('/shared/data/username/deriva-ml/ml.example.org/52')
DerivaMLConfig.compute_workdir(None, 1, 'localhost')
PosixPath('/home/username/.deriva-ml/localhost/1')</p>
</blockquote>
</blockquote>
</blockquote>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/deriva_ml/core/config.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">compute_workdir</span><span class="p">(</span>
    <span class="n">working_dir</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">catalog_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">hostname</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Path</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute the effective working directory path.</span>

<span class="sd">    Creates a standardized working directory path. If a base directory is provided,</span>
<span class="sd">    appends the current username to prevent conflicts between users. If no directory</span>
<span class="sd">    is provided, uses ~/.deriva-ml. The hostname and catalog_id are appended to</span>
<span class="sd">    separate data from different servers and catalogs.</span>

<span class="sd">    Args:</span>
<span class="sd">        working_dir: Base working directory path, or None for default.</span>
<span class="sd">        catalog_id: Catalog identifier to include in the path. If None, no</span>
<span class="sd">                   catalog subdirectory is created.</span>
<span class="sd">        hostname: Server hostname to include in the path. If None, no</span>
<span class="sd">                 hostname subdirectory is created.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Path: Absolute path to the working directory.</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; DerivaMLConfig.compute_workdir(&#39;/shared/data&#39;, &#39;52&#39;, &#39;ml.example.org&#39;)</span>
<span class="sd">        PosixPath(&#39;/shared/data/username/deriva-ml/ml.example.org/52&#39;)</span>
<span class="sd">        &gt;&gt;&gt; DerivaMLConfig.compute_workdir(None, 1, &#39;localhost&#39;)</span>
<span class="sd">        PosixPath(&#39;/home/username/.deriva-ml/localhost/1&#39;)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Append username and deriva-ml to provided path, or use ~/.deriva-ml as base</span>
    <span class="k">if</span> <span class="n">working_dir</span><span class="p">:</span>
        <span class="n">base_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">working_dir</span><span class="p">)</span> <span class="o">/</span> <span class="n">getpass</span><span class="o">.</span><span class="n">getuser</span><span class="p">()</span> <span class="o">/</span> <span class="s2">&quot;deriva-ml&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">base_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="o">.</span><span class="n">home</span><span class="p">()</span> <span class="o">/</span> <span class="s2">&quot;.deriva-ml&quot;</span>
    <span class="c1"># Append hostname if provided to separate data from different servers</span>
    <span class="k">if</span> <span class="n">hostname</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">base_dir</span> <span class="o">=</span> <span class="n">base_dir</span> <span class="o">/</span> <span class="n">hostname</span>
    <span class="c1"># Append catalog_id if provided</span>
    <span class="k">if</span> <span class="n">catalog_id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">base_dir</span> <span class="o">=</span> <span class="n">base_dir</span> <span class="o">/</span> <span class="nb">str</span><span class="p">(</span><span class="n">catalog_id</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">base_dir</span><span class="o">.</span><span class="n">absolute</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="deriva_ml.core.DerivaMLConfig.init_working_dir" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">init_working_dir</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">init_working_dir</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">DerivaMLConfig</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Initialize working directory and resolve use_minid after model validation.</p>
<p>Sets up the working directory path, computing a default if not specified.
Also captures Hydra's runtime output directory for logging and outputs.</p>
<p>Resolves the use_minid flag based on s3_bucket configuration:
- If use_minid is explicitly set, use that value (but it only takes effect if s3_bucket is set)
- If use_minid is None (auto), set it to True if s3_bucket is configured, False otherwise</p>
<p>This validator runs after all field validation and ensures the working
directory is available for Hydra configuration resolution.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>Self</code></td>            <td>
                  <code><a class="autorefs autorefs-internal" title="DerivaMLConfig (deriva_ml.core.config.DerivaMLConfig)" href="#deriva_ml.core.DerivaMLConfig">DerivaMLConfig</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The configuration instance with initialized paths.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/deriva_ml/core/config.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@model_validator</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="s2">&quot;after&quot;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">init_working_dir</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;DerivaMLConfig&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initialize working directory and resolve use_minid after model validation.</span>

<span class="sd">    Sets up the working directory path, computing a default if not specified.</span>
<span class="sd">    Also captures Hydra&#39;s runtime output directory for logging and outputs.</span>

<span class="sd">    Resolves the use_minid flag based on s3_bucket configuration:</span>
<span class="sd">    - If use_minid is explicitly set, use that value (but it only takes effect if s3_bucket is set)</span>
<span class="sd">    - If use_minid is None (auto), set it to True if s3_bucket is configured, False otherwise</span>

<span class="sd">    This validator runs after all field validation and ensures the working</span>
<span class="sd">    directory is available for Hydra configuration resolution.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Self: The configuration instance with initialized paths.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">working_dir</span> <span class="o">=</span> <span class="n">DerivaMLConfig</span><span class="o">.</span><span class="n">compute_workdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">working_dir</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">catalog_id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">hostname</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">hydra_runtime_output_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">HydraConfig</span><span class="o">.</span><span class="n">get</span><span class="p">()</span><span class="o">.</span><span class="n">runtime</span><span class="o">.</span><span class="n">output_dir</span><span class="p">)</span>

    <span class="c1"># Resolve use_minid based on s3_bucket configuration</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_minid</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># Auto mode: enable MINID if s3_bucket is configured</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">use_minid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">s3_bucket</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_minid</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">s3_bucket</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># User requested MINID but no S3 bucket configured - disable MINID</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">use_minid</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">return</span> <span class="bp">self</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="deriva_ml.core.DerivaMLException" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">DerivaMLException</span>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="Exception">Exception</span></code></p>



        <p>Base exception class for all DerivaML errors.</p>
<p>This is the root exception for all DerivaML-specific errors. Catching this
exception will catch any error raised by the DerivaML library.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="deriva_ml.core.DerivaMLException._msg">_msg</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The error message stored for later access.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>msg</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Descriptive error message. Defaults to empty string.</p>
              </div>
            </td>
            <td>
                  <code>&#39;&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>raise DerivaMLException("Failed to connect to catalog")
DerivaMLException: Failed to connect to catalog</p>
</blockquote>
</blockquote>
</blockquote>
</details>







              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/deriva_ml/core/exceptions.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">DerivaMLException</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Base exception class for all DerivaML errors.</span>

<span class="sd">    This is the root exception for all DerivaML-specific errors. Catching this</span>
<span class="sd">    exception will catch any error raised by the DerivaML library.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        _msg: The error message stored for later access.</span>

<span class="sd">    Args:</span>
<span class="sd">        msg: Descriptive error message. Defaults to empty string.</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; raise DerivaMLException(&quot;Failed to connect to catalog&quot;)</span>
<span class="sd">        DerivaMLException: Failed to connect to catalog</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">msg</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_msg</span> <span class="o">=</span> <span class="n">msg</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="deriva_ml.core.DerivaMLInvalidTerm" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">DerivaMLInvalidTerm</span>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="DerivaMLNotFoundError (deriva_ml.core.exceptions.DerivaMLNotFoundError)" href="../exceptions/#deriva_ml.core.exceptions.DerivaMLNotFoundError">DerivaMLNotFoundError</a></code></p>



        <p>Exception raised when a vocabulary term is not found or invalid.</p>
<p>Raised when attempting to look up or use a term that doesn't exist in
a controlled vocabulary table, or when a term name/synonym cannot be resolved.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>vocabulary</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the vocabulary table being searched.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>term</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The term name that was not found.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>msg</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Additional context about the error. Defaults to "Term doesn't exist".</p>
              </div>
            </td>
            <td>
                  <code>&#34;Term doesn&#39;t exist&#34;</code>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>raise DerivaMLInvalidTerm("Diagnosis", "unknown_condition")
DerivaMLInvalidTerm: Invalid term unknown_condition in vocabulary Diagnosis: Term doesn't exist.</p>
</blockquote>
</blockquote>
</blockquote>
</details>







              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/deriva_ml/core/exceptions.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">DerivaMLInvalidTerm</span><span class="p">(</span><span class="n">DerivaMLNotFoundError</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Exception raised when a vocabulary term is not found or invalid.</span>

<span class="sd">    Raised when attempting to look up or use a term that doesn&#39;t exist in</span>
<span class="sd">    a controlled vocabulary table, or when a term name/synonym cannot be resolved.</span>

<span class="sd">    Args:</span>
<span class="sd">        vocabulary: Name of the vocabulary table being searched.</span>
<span class="sd">        term: The term name that was not found.</span>
<span class="sd">        msg: Additional context about the error. Defaults to &quot;Term doesn&#39;t exist&quot;.</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; raise DerivaMLInvalidTerm(&quot;Diagnosis&quot;, &quot;unknown_condition&quot;)</span>
<span class="sd">        DerivaMLInvalidTerm: Invalid term unknown_condition in vocabulary Diagnosis: Term doesn&#39;t exist.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vocabulary</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">term</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">msg</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;Term doesn&#39;t exist&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid term </span><span class="si">{</span><span class="n">term</span><span class="si">}</span><span class="s2"> in vocabulary </span><span class="si">{</span><span class="n">vocabulary</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">msg</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vocabulary</span> <span class="o">=</span> <span class="n">vocabulary</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">term</span> <span class="o">=</span> <span class="n">term</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="deriva_ml.core.DerivaMLTableTypeError" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">DerivaMLTableTypeError</span>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="DerivaMLDataError (deriva_ml.core.exceptions.DerivaMLDataError)" href="../exceptions/#deriva_ml.core.exceptions.DerivaMLDataError">DerivaMLDataError</a></code></p>



        <p>Exception raised when a RID or table is not of the expected type.</p>
<p>Raised when an operation requires a specific table type (e.g., Dataset,
Execution) but receives a RID or table reference of a different type.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>table_type</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The expected table type (e.g., "Dataset", "Execution").</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>table</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The actual table name or RID that was provided.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>raise DerivaMLTableTypeError("Dataset", "1-ABC123")
DerivaMLTableTypeError: Table 1-ABC123 is not of type Dataset.</p>
</blockquote>
</blockquote>
</blockquote>
</details>







              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/deriva_ml/core/exceptions.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">DerivaMLTableTypeError</span><span class="p">(</span><span class="n">DerivaMLDataError</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Exception raised when a RID or table is not of the expected type.</span>

<span class="sd">    Raised when an operation requires a specific table type (e.g., Dataset,</span>
<span class="sd">    Execution) but receives a RID or table reference of a different type.</span>

<span class="sd">    Args:</span>
<span class="sd">        table_type: The expected table type (e.g., &quot;Dataset&quot;, &quot;Execution&quot;).</span>
<span class="sd">        table: The actual table name or RID that was provided.</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; raise DerivaMLTableTypeError(&quot;Dataset&quot;, &quot;1-ABC123&quot;)</span>
<span class="sd">        DerivaMLTableTypeError: Table 1-ABC123 is not of type Dataset.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">table</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Table </span><span class="si">{</span><span class="n">table</span><span class="si">}</span><span class="s2"> is not of type </span><span class="si">{</span><span class="n">table_type</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">table_type</span> <span class="o">=</span> <span class="n">table_type</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">table</span> <span class="o">=</span> <span class="n">table</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="deriva_ml.core.ExecAssetType" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">ExecAssetType</span>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="BaseStrEnum (deriva_ml.core.enums.BaseStrEnum)" href="../deriva_definitions/#deriva_ml.core.definitions.BaseStrEnum">BaseStrEnum</a></code></p>



        <p>Execution asset type identifiers.</p>
<p>Defines the types of assets that can be produced or consumed during an execution.
These types are used to categorize files associated with workflow runs.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="deriva_ml.core.ExecAssetType.input_file">input_file</span></code></td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Input file consumed by the execution.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="deriva_ml.core.ExecAssetType.output_file">output_file</span></code></td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Output file produced by the execution.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="deriva_ml.core.ExecAssetType.notebook_output">notebook_output</span></code></td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Jupyter notebook output from the execution.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="deriva_ml.core.ExecAssetType.model_file">model_file</span></code></td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Machine learning model file (e.g., .pkl, .h5, .pt).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/deriva_ml/core/enums.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">ExecAssetType</span><span class="p">(</span><span class="n">BaseStrEnum</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Execution asset type identifiers.</span>

<span class="sd">    Defines the types of assets that can be produced or consumed during an execution.</span>
<span class="sd">    These types are used to categorize files associated with workflow runs.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        input_file (str): Input file consumed by the execution.</span>
<span class="sd">        output_file (str): Output file produced by the execution.</span>
<span class="sd">        notebook_output (str): Jupyter notebook output from the execution.</span>
<span class="sd">        model_file (str): Machine learning model file (e.g., .pkl, .h5, .pt).</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">input_file</span> <span class="o">=</span> <span class="s2">&quot;Input_File&quot;</span>
    <span class="n">output_file</span> <span class="o">=</span> <span class="s2">&quot;Output_File&quot;</span>
    <span class="n">notebook_output</span> <span class="o">=</span> <span class="s2">&quot;Notebook_Output&quot;</span>
    <span class="n">model_file</span> <span class="o">=</span> <span class="s2">&quot;Model_File&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="deriva_ml.core.ExecMetadataType" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">ExecMetadataType</span>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="BaseStrEnum (deriva_ml.core.enums.BaseStrEnum)" href="../deriva_definitions/#deriva_ml.core.definitions.BaseStrEnum">BaseStrEnum</a></code></p>



        <p>Execution metadata type identifiers.</p>
<p>Defines the types of metadata that can be associated with an execution.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="deriva_ml.core.ExecMetadataType.execution_config">execution_config</span></code></td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>General execution configuration data.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="deriva_ml.core.ExecMetadataType.runtime_env">runtime_env</span></code></td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Runtime environment information.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="deriva_ml.core.ExecMetadataType.hydra_config">hydra_config</span></code></td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Hydra YAML configuration files (config.yaml, overrides.yaml).</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="deriva_ml.core.ExecMetadataType.deriva_config">deriva_config</span></code></td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>DerivaML execution configuration (configuration.json).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/deriva_ml/core/enums.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">ExecMetadataType</span><span class="p">(</span><span class="n">BaseStrEnum</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Execution metadata type identifiers.</span>

<span class="sd">    Defines the types of metadata that can be associated with an execution.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        execution_config (str): General execution configuration data.</span>
<span class="sd">        runtime_env (str): Runtime environment information.</span>
<span class="sd">        hydra_config (str): Hydra YAML configuration files (config.yaml, overrides.yaml).</span>
<span class="sd">        deriva_config (str): DerivaML execution configuration (configuration.json).</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">execution_config</span> <span class="o">=</span> <span class="s2">&quot;Execution_Config&quot;</span>
    <span class="n">runtime_env</span> <span class="o">=</span> <span class="s2">&quot;Runtime_Env&quot;</span>
    <span class="n">hydra_config</span> <span class="o">=</span> <span class="s2">&quot;Hydra_Config&quot;</span>
    <span class="n">deriva_config</span> <span class="o">=</span> <span class="s2">&quot;Deriva_Config&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="deriva_ml.core.FileSpec" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">FileSpec</span>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="pydantic.BaseModel">BaseModel</span></code></p>



        <p>Specification for a file to be added to the Deriva catalog.</p>
<p>Represents file metadata required for creating entries in the File table.
Handles URL normalization, ensuring local file paths are converted to
tag URIs that uniquely identify the file's origin.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="deriva_ml.core.FileSpec.url">url</span></code></td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>File location as URL or local path. Local paths are converted to tag URIs.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="deriva_ml.core.FileSpec.md5">md5</span></code></td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>MD5 checksum for integrity verification.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="deriva_ml.core.FileSpec.length">length</span></code></td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>File size in bytes.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="deriva_ml.core.FileSpec.description">description</span></code></td>
            <td>
                  <code><span title="str">str</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional description of the file's contents or purpose.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="deriva_ml.core.FileSpec.file_types">file_types</span></code></td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of file type classifications from the Asset_Type vocabulary.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Note</summary>
  <p>The 'File' type is automatically added to file_types if not present when
using create_filespecs().</p>
</details>

<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>spec = FileSpec(
...     url="/data/results.csv",
...     md5="d41d8cd98f00b204e9800998ecf8427e",
...     length=1024,
...     description="Analysis results",
...     file_types=["CSV", "Data"]
... )</p>
</blockquote>
</blockquote>
</blockquote>
</details>







              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/deriva_ml/core/filespec.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">FileSpec</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Specification for a file to be added to the Deriva catalog.</span>

<span class="sd">    Represents file metadata required for creating entries in the File table.</span>
<span class="sd">    Handles URL normalization, ensuring local file paths are converted to</span>
<span class="sd">    tag URIs that uniquely identify the file&#39;s origin.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        url: File location as URL or local path. Local paths are converted to tag URIs.</span>
<span class="sd">        md5: MD5 checksum for integrity verification.</span>
<span class="sd">        length: File size in bytes.</span>
<span class="sd">        description: Optional description of the file&#39;s contents or purpose.</span>
<span class="sd">        file_types: List of file type classifications from the Asset_Type vocabulary.</span>

<span class="sd">    Note:</span>
<span class="sd">        The &#39;File&#39; type is automatically added to file_types if not present when</span>
<span class="sd">        using create_filespecs().</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; spec = FileSpec(</span>
<span class="sd">        ...     url=&quot;/data/results.csv&quot;,</span>
<span class="sd">        ...     md5=&quot;d41d8cd98f00b204e9800998ecf8427e&quot;,</span>
<span class="sd">        ...     length=1024,</span>
<span class="sd">        ...     description=&quot;Analysis results&quot;,</span>
<span class="sd">        ...     file_types=[&quot;CSV&quot;, &quot;Data&quot;]</span>
<span class="sd">        ... )</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">model_config</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;populate_by_name&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">}</span>

    <span class="n">url</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">alias</span><span class="o">=</span><span class="s2">&quot;URL&quot;</span><span class="p">)</span>
    <span class="n">md5</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">alias</span><span class="o">=</span><span class="s2">&quot;MD5&quot;</span><span class="p">)</span>
    <span class="n">length</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">alias</span><span class="o">=</span><span class="s2">&quot;Length&quot;</span><span class="p">)</span>
    <span class="n">description</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">alias</span><span class="o">=</span><span class="s2">&quot;Description&quot;</span><span class="p">)</span>
    <span class="n">file_types</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>

    <span class="nd">@field_validator</span><span class="p">(</span><span class="s2">&quot;url&quot;</span><span class="p">)</span>
    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">validate_file_url</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">url</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Examine the provided URL. If it&#39;s a local path, convert it into a tag URL.</span>

<span class="sd">        Args:</span>
<span class="sd">            url: The URL to validate and potentially convert</span>

<span class="sd">        Returns:</span>
<span class="sd">            The validated/converted URL</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValidationError: If the URL is not a file URL</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">url_parts</span> <span class="o">=</span> <span class="n">urlparse</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">url_parts</span><span class="o">.</span><span class="n">scheme</span> <span class="o">==</span> <span class="s2">&quot;tag&quot;</span><span class="p">:</span>
            <span class="c1"># Already a tag URL, so just return it.</span>
            <span class="k">return</span> <span class="n">url</span>
        <span class="k">elif</span> <span class="p">(</span><span class="ow">not</span> <span class="n">url_parts</span><span class="o">.</span><span class="n">scheme</span><span class="p">)</span> <span class="ow">or</span> <span class="n">url_parts</span><span class="o">.</span><span class="n">scheme</span> <span class="o">==</span> <span class="s2">&quot;file&quot;</span><span class="p">:</span>
            <span class="c1"># There is no scheme part of the URL, or it is a file URL, so it is a local file path.</span>
            <span class="c1"># Convert to a tag URL.</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;tag://</span><span class="si">{</span><span class="n">gethostname</span><span class="p">()</span><span class="si">}</span><span class="s2">,</span><span class="si">{</span><span class="n">date</span><span class="o">.</span><span class="n">today</span><span class="p">()</span><span class="si">}</span><span class="s2">:file://</span><span class="si">{</span><span class="n">url_parts</span><span class="o">.</span><span class="n">path</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;url is not a file URL&quot;</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">create_filespecs</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="n">Path</span> <span class="o">|</span> <span class="nb">str</span><span class="p">,</span> <span class="n">description</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">file_types</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Path</span><span class="p">],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Generator</span><span class="p">[</span><span class="n">FileSpec</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Generate FileSpec objects for a file or directory.</span>

<span class="sd">        Creates FileSpec objects with computed MD5 checksums for each file found.</span>
<span class="sd">        For directories, recursively processes all files. The &#39;File&#39; type is</span>
<span class="sd">        automatically prepended to file_types if not already present.</span>

<span class="sd">        Args:</span>
<span class="sd">            path: Path to a file or directory. If directory, all files are processed recursively.</span>
<span class="sd">            description: Description to apply to all generated FileSpecs.</span>
<span class="sd">            file_types: Either a static list of file types, or a callable that takes a Path</span>
<span class="sd">                and returns a list of types for that specific file. Allows dynamic type</span>
<span class="sd">                assignment based on file extension, content, etc.</span>

<span class="sd">        Yields:</span>
<span class="sd">            FileSpec: A specification for each file with computed checksums and metadata.</span>

<span class="sd">        Example:</span>
<span class="sd">            Static file types:</span>
<span class="sd">                &gt;&gt;&gt; specs = FileSpec.create_filespecs(&quot;/data/images&quot;, &quot;Images&quot;, [&quot;Image&quot;])</span>

<span class="sd">            Dynamic file types based on extension:</span>
<span class="sd">                &gt;&gt;&gt; def get_types(path):</span>
<span class="sd">                ...     ext = path.suffix.lower()</span>
<span class="sd">                ...     return {&quot;png&quot;: [&quot;PNG&quot;, &quot;Image&quot;], &quot;.jpg&quot;: [&quot;JPEG&quot;, &quot;Image&quot;]}.get(ext, [])</span>
<span class="sd">                &gt;&gt;&gt; specs = FileSpec.create_filespecs(&quot;/data&quot;, &quot;Mixed files&quot;, get_types)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
        <span class="n">file_types</span> <span class="o">=</span> <span class="n">file_types</span> <span class="ow">or</span> <span class="p">[]</span>
        <span class="c1"># Convert static list to callable for uniform handling</span>
        <span class="n">file_types_fn</span> <span class="o">=</span> <span class="n">file_types</span> <span class="k">if</span> <span class="nb">callable</span><span class="p">(</span><span class="n">file_types</span><span class="p">)</span> <span class="k">else</span> <span class="k">lambda</span> <span class="n">_x</span><span class="p">:</span> <span class="n">file_types</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">create_spec</span><span class="p">(</span><span class="n">file_path</span><span class="p">:</span> <span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FileSpec</span><span class="p">:</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;Create a FileSpec for a single file with computed hashes.&quot;&quot;&quot;</span>
            <span class="n">hashes</span> <span class="o">=</span> <span class="n">hash_utils</span><span class="o">.</span><span class="n">compute_file_hashes</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">hashes</span><span class="o">=</span><span class="nb">frozenset</span><span class="p">([</span><span class="s2">&quot;md5&quot;</span><span class="p">,</span> <span class="s2">&quot;sha256&quot;</span><span class="p">]))</span>
            <span class="n">md5</span> <span class="o">=</span> <span class="n">hashes</span><span class="p">[</span><span class="s2">&quot;md5&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">type_list</span> <span class="o">=</span> <span class="n">file_types_fn</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">FileSpec</span><span class="p">(</span>
                <span class="n">length</span><span class="o">=</span><span class="n">path</span><span class="o">.</span><span class="n">stat</span><span class="p">()</span><span class="o">.</span><span class="n">st_size</span><span class="p">,</span>
                <span class="n">md5</span><span class="o">=</span><span class="n">md5</span><span class="p">,</span>
                <span class="n">description</span><span class="o">=</span><span class="n">description</span><span class="p">,</span>
                <span class="n">url</span><span class="o">=</span><span class="n">file_path</span><span class="o">.</span><span class="n">as_posix</span><span class="p">(),</span>
                <span class="c1"># Ensure &#39;File&#39; type is always included</span>
                <span class="n">file_types</span><span class="o">=</span><span class="n">type_list</span> <span class="k">if</span> <span class="s2">&quot;File&quot;</span> <span class="ow">in</span> <span class="n">type_list</span> <span class="k">else</span> <span class="p">[</span><span class="s2">&quot;File&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">type_list</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="c1"># Handle both single files and directories (recursive)</span>
        <span class="n">files</span> <span class="o">=</span> <span class="p">[</span><span class="n">path</span><span class="p">]</span> <span class="k">if</span> <span class="n">path</span><span class="o">.</span><span class="n">is_file</span><span class="p">()</span> <span class="k">else</span> <span class="p">[</span><span class="n">f</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">Path</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="o">.</span><span class="n">rglob</span><span class="p">(</span><span class="s2">&quot;*&quot;</span><span class="p">)</span> <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">is_file</span><span class="p">()]</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">create_spec</span><span class="p">(</span><span class="n">file</span><span class="p">)</span> <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">files</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">read_filespec</span><span class="p">(</span><span class="n">path</span><span class="p">:</span> <span class="n">Path</span> <span class="o">|</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Generator</span><span class="p">[</span><span class="n">FileSpec</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Read FileSpec objects from a JSON Lines file.</span>

<span class="sd">        Parses a JSONL file where each line is a JSON object representing a FileSpec.</span>
<span class="sd">        Empty lines are skipped. This is useful for batch processing pre-computed</span>
<span class="sd">        file specifications.</span>

<span class="sd">        Args:</span>
<span class="sd">            path: Path to the .jsonl file containing FileSpec data.</span>

<span class="sd">        Yields:</span>
<span class="sd">            FileSpec: Parsed FileSpec object for each valid line.</span>

<span class="sd">        Example:</span>
<span class="sd">            &gt;&gt;&gt; for spec in FileSpec.read_filespec(&quot;files.jsonl&quot;):</span>
<span class="sd">            ...     print(f&quot;{spec.url}: {spec.md5}&quot;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
        <span class="k">with</span> <span class="n">path</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">f</span><span class="p">:</span>
                <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">line</span><span class="p">:</span>
                    <span class="k">continue</span>
                <span class="k">yield</span> <span class="n">FileSpec</span><span class="p">(</span><span class="o">**</span><span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">line</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h3 id="deriva_ml.core.FileSpec.create_filespecs" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">create_filespecs</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">create_filespecs</span><span class="p">(</span>
    <span class="n">path</span><span class="p">:</span> <span class="n">Path</span> <span class="o">|</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">description</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">file_types</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
    <span class="o">|</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Path</span><span class="p">],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span>
    <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Generator</span><span class="p">[</span><span class="n">FileSpec</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Generate FileSpec objects for a file or directory.</p>
<p>Creates FileSpec objects with computed MD5 checksums for each file found.
For directories, recursively processes all files. The 'File' type is
automatically prepended to file_types if not already present.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>path</code>
            </td>
            <td>
                  <code><span title="pathlib.Path">Path</span> | <span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to a file or directory. If directory, all files are processed recursively.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>description</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Description to apply to all generated FileSpecs.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>file_types</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>] | <span title="typing.Callable">Callable</span>[[<span title="pathlib.Path">Path</span>], <span title="list">list</span>[<span title="str">str</span>]] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Either a static list of file types, or a callable that takes a Path
and returns a list of types for that specific file. Allows dynamic type
assignment based on file extension, content, etc.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Yields:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>FileSpec</code></td>            <td>
                  <code><a class="autorefs autorefs-internal" title="FileSpec (deriva_ml.core.filespec.FileSpec)" href="#deriva_ml.core.FileSpec">FileSpec</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A specification for each file with computed checksums and metadata.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <p>Static file types:
    &gt;&gt;&gt; specs = FileSpec.create_filespecs("/data/images", "Images", ["Image"])</p>
<p>Dynamic file types based on extension:
    &gt;&gt;&gt; def get_types(path):
    ...     ext = path.suffix.lower()
    ...     return {"png": ["PNG", "Image"], ".jpg": ["JPEG", "Image"]}.get(ext, [])
    &gt;&gt;&gt; specs = FileSpec.create_filespecs("/data", "Mixed files", get_types)</p>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/deriva_ml/core/filespec.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">create_filespecs</span><span class="p">(</span>
    <span class="bp">cls</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="n">Path</span> <span class="o">|</span> <span class="nb">str</span><span class="p">,</span> <span class="n">description</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">file_types</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Path</span><span class="p">],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Generator</span><span class="p">[</span><span class="n">FileSpec</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generate FileSpec objects for a file or directory.</span>

<span class="sd">    Creates FileSpec objects with computed MD5 checksums for each file found.</span>
<span class="sd">    For directories, recursively processes all files. The &#39;File&#39; type is</span>
<span class="sd">    automatically prepended to file_types if not already present.</span>

<span class="sd">    Args:</span>
<span class="sd">        path: Path to a file or directory. If directory, all files are processed recursively.</span>
<span class="sd">        description: Description to apply to all generated FileSpecs.</span>
<span class="sd">        file_types: Either a static list of file types, or a callable that takes a Path</span>
<span class="sd">            and returns a list of types for that specific file. Allows dynamic type</span>
<span class="sd">            assignment based on file extension, content, etc.</span>

<span class="sd">    Yields:</span>
<span class="sd">        FileSpec: A specification for each file with computed checksums and metadata.</span>

<span class="sd">    Example:</span>
<span class="sd">        Static file types:</span>
<span class="sd">            &gt;&gt;&gt; specs = FileSpec.create_filespecs(&quot;/data/images&quot;, &quot;Images&quot;, [&quot;Image&quot;])</span>

<span class="sd">        Dynamic file types based on extension:</span>
<span class="sd">            &gt;&gt;&gt; def get_types(path):</span>
<span class="sd">            ...     ext = path.suffix.lower()</span>
<span class="sd">            ...     return {&quot;png&quot;: [&quot;PNG&quot;, &quot;Image&quot;], &quot;.jpg&quot;: [&quot;JPEG&quot;, &quot;Image&quot;]}.get(ext, [])</span>
<span class="sd">            &gt;&gt;&gt; specs = FileSpec.create_filespecs(&quot;/data&quot;, &quot;Mixed files&quot;, get_types)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
    <span class="n">file_types</span> <span class="o">=</span> <span class="n">file_types</span> <span class="ow">or</span> <span class="p">[]</span>
    <span class="c1"># Convert static list to callable for uniform handling</span>
    <span class="n">file_types_fn</span> <span class="o">=</span> <span class="n">file_types</span> <span class="k">if</span> <span class="nb">callable</span><span class="p">(</span><span class="n">file_types</span><span class="p">)</span> <span class="k">else</span> <span class="k">lambda</span> <span class="n">_x</span><span class="p">:</span> <span class="n">file_types</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">create_spec</span><span class="p">(</span><span class="n">file_path</span><span class="p">:</span> <span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FileSpec</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a FileSpec for a single file with computed hashes.&quot;&quot;&quot;</span>
        <span class="n">hashes</span> <span class="o">=</span> <span class="n">hash_utils</span><span class="o">.</span><span class="n">compute_file_hashes</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">hashes</span><span class="o">=</span><span class="nb">frozenset</span><span class="p">([</span><span class="s2">&quot;md5&quot;</span><span class="p">,</span> <span class="s2">&quot;sha256&quot;</span><span class="p">]))</span>
        <span class="n">md5</span> <span class="o">=</span> <span class="n">hashes</span><span class="p">[</span><span class="s2">&quot;md5&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">type_list</span> <span class="o">=</span> <span class="n">file_types_fn</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">FileSpec</span><span class="p">(</span>
            <span class="n">length</span><span class="o">=</span><span class="n">path</span><span class="o">.</span><span class="n">stat</span><span class="p">()</span><span class="o">.</span><span class="n">st_size</span><span class="p">,</span>
            <span class="n">md5</span><span class="o">=</span><span class="n">md5</span><span class="p">,</span>
            <span class="n">description</span><span class="o">=</span><span class="n">description</span><span class="p">,</span>
            <span class="n">url</span><span class="o">=</span><span class="n">file_path</span><span class="o">.</span><span class="n">as_posix</span><span class="p">(),</span>
            <span class="c1"># Ensure &#39;File&#39; type is always included</span>
            <span class="n">file_types</span><span class="o">=</span><span class="n">type_list</span> <span class="k">if</span> <span class="s2">&quot;File&quot;</span> <span class="ow">in</span> <span class="n">type_list</span> <span class="k">else</span> <span class="p">[</span><span class="s2">&quot;File&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">type_list</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="c1"># Handle both single files and directories (recursive)</span>
    <span class="n">files</span> <span class="o">=</span> <span class="p">[</span><span class="n">path</span><span class="p">]</span> <span class="k">if</span> <span class="n">path</span><span class="o">.</span><span class="n">is_file</span><span class="p">()</span> <span class="k">else</span> <span class="p">[</span><span class="n">f</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">Path</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="o">.</span><span class="n">rglob</span><span class="p">(</span><span class="s2">&quot;*&quot;</span><span class="p">)</span> <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">is_file</span><span class="p">()]</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">create_spec</span><span class="p">(</span><span class="n">file</span><span class="p">)</span> <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">files</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="deriva_ml.core.FileSpec.read_filespec" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">read_filespec</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">read_filespec</span><span class="p">(</span>
    <span class="n">path</span><span class="p">:</span> <span class="n">Path</span> <span class="o">|</span> <span class="nb">str</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Generator</span><span class="p">[</span><span class="n">FileSpec</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Read FileSpec objects from a JSON Lines file.</p>
<p>Parses a JSONL file where each line is a JSON object representing a FileSpec.
Empty lines are skipped. This is useful for batch processing pre-computed
file specifications.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>path</code>
            </td>
            <td>
                  <code><span title="pathlib.Path">Path</span> | <span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to the .jsonl file containing FileSpec data.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Yields:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>FileSpec</code></td>            <td>
                  <code><a class="autorefs autorefs-internal" title="FileSpec (deriva_ml.core.filespec.FileSpec)" href="#deriva_ml.core.FileSpec">FileSpec</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Parsed FileSpec object for each valid line.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>for spec in FileSpec.read_filespec("files.jsonl"):
...     print(f"{spec.url}: {spec.md5}")</p>
</blockquote>
</blockquote>
</blockquote>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/deriva_ml/core/filespec.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">read_filespec</span><span class="p">(</span><span class="n">path</span><span class="p">:</span> <span class="n">Path</span> <span class="o">|</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Generator</span><span class="p">[</span><span class="n">FileSpec</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Read FileSpec objects from a JSON Lines file.</span>

<span class="sd">    Parses a JSONL file where each line is a JSON object representing a FileSpec.</span>
<span class="sd">    Empty lines are skipped. This is useful for batch processing pre-computed</span>
<span class="sd">    file specifications.</span>

<span class="sd">    Args:</span>
<span class="sd">        path: Path to the .jsonl file containing FileSpec data.</span>

<span class="sd">    Yields:</span>
<span class="sd">        FileSpec: Parsed FileSpec object for each valid line.</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; for spec in FileSpec.read_filespec(&quot;files.jsonl&quot;):</span>
<span class="sd">        ...     print(f&quot;{spec.url}: {spec.md5}&quot;)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
    <span class="k">with</span> <span class="n">path</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">line</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="k">yield</span> <span class="n">FileSpec</span><span class="p">(</span><span class="o">**</span><span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">line</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="deriva_ml.core.FileSpec.validate_file_url" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">validate_file_url</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">validate_file_url</span><span class="p">(</span><span class="n">url</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Examine the provided URL. If it's a local path, convert it into a tag URL.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>url</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The URL to validate and potentially convert</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The validated/converted URL</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValidationError">ValidationError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the URL is not a file URL</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/deriva_ml/core/filespec.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span>
<span class="normal">96</span>
<span class="normal">97</span>
<span class="normal">98</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@field_validator</span><span class="p">(</span><span class="s2">&quot;url&quot;</span><span class="p">)</span>
<span class="nd">@classmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">validate_file_url</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">url</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Examine the provided URL. If it&#39;s a local path, convert it into a tag URL.</span>

<span class="sd">    Args:</span>
<span class="sd">        url: The URL to validate and potentially convert</span>

<span class="sd">    Returns:</span>
<span class="sd">        The validated/converted URL</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValidationError: If the URL is not a file URL</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">url_parts</span> <span class="o">=</span> <span class="n">urlparse</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">url_parts</span><span class="o">.</span><span class="n">scheme</span> <span class="o">==</span> <span class="s2">&quot;tag&quot;</span><span class="p">:</span>
        <span class="c1"># Already a tag URL, so just return it.</span>
        <span class="k">return</span> <span class="n">url</span>
    <span class="k">elif</span> <span class="p">(</span><span class="ow">not</span> <span class="n">url_parts</span><span class="o">.</span><span class="n">scheme</span><span class="p">)</span> <span class="ow">or</span> <span class="n">url_parts</span><span class="o">.</span><span class="n">scheme</span> <span class="o">==</span> <span class="s2">&quot;file&quot;</span><span class="p">:</span>
        <span class="c1"># There is no scheme part of the URL, or it is a file URL, so it is a local file path.</span>
        <span class="c1"># Convert to a tag URL.</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;tag://</span><span class="si">{</span><span class="n">gethostname</span><span class="p">()</span><span class="si">}</span><span class="s2">,</span><span class="si">{</span><span class="n">date</span><span class="o">.</span><span class="n">today</span><span class="p">()</span><span class="si">}</span><span class="s2">:file://</span><span class="si">{</span><span class="n">url_parts</span><span class="o">.</span><span class="n">path</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;url is not a file URL&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="deriva_ml.core.FileUploadState" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">FileUploadState</span>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="pydantic.BaseModel">BaseModel</span></code></p>



        <p>Tracks the state and result of a file upload operation.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="deriva_ml.core.FileUploadState.state">state</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="UploadState (deriva_ml.core.enums.UploadState)" href="#deriva_ml.core.UploadState">UploadState</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Current state of the upload (success, failed, etc.).</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="deriva_ml.core.FileUploadState.status">status</span></code></td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Detailed status message.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="deriva_ml.core.FileUploadState.result">result</span></code></td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Upload result data, if any.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/deriva_ml/core/ermrest.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">FileUploadState</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Tracks the state and result of a file upload operation.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        state (UploadState): Current state of the upload (success, failed, etc.).</span>
<span class="sd">        status (str): Detailed status message.</span>
<span class="sd">        result (Any): Upload result data, if any.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">state</span><span class="p">:</span> <span class="n">UploadState</span>
    <span class="n">status</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">result</span><span class="p">:</span> <span class="n">Any</span>

    <span class="nd">@computed_field</span>
    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">rid</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">RID</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">result</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="p">[</span><span class="s2">&quot;RID&quot;</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="deriva_ml.core.LoggerMixin" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">LoggerMixin</span>


</h2>


    <div class="doc doc-contents ">



        <p>Mixin class that provides a _logger attribute.</p>
<p>Classes that inherit from this mixin get a _logger property that
returns a child logger under the deriva_ml namespace, named after
the class.</p>


<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>class MyProcessor(LoggerMixin):
...     def process(self):
...         self._logger.info("Processing started")
...</p>
<h3 id="deriva_ml.core.LoggerMixin--logs-to-deriva_mlmyprocessor">Logs to 'deriva_ml.MyProcessor'</h3>
</blockquote>
</blockquote>
</blockquote>
</details>







              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/deriva_ml/core/logging_config.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">LoggerMixin</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Mixin class that provides a _logger attribute.</span>

<span class="sd">    Classes that inherit from this mixin get a _logger property that</span>
<span class="sd">    returns a child logger under the deriva_ml namespace, named after</span>
<span class="sd">    the class.</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; class MyProcessor(LoggerMixin):</span>
<span class="sd">        ...     def process(self):</span>
<span class="sd">        ...         self._logger.info(&quot;Processing started&quot;)</span>
<span class="sd">        ...</span>
<span class="sd">        &gt;&gt;&gt; # Logs to &#39;deriva_ml.MyProcessor&#39;</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_logger</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">logging</span><span class="o">.</span><span class="n">Logger</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the logger for this class.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">get_logger</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="deriva_ml.core.MLAsset" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">MLAsset</span>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="BaseStrEnum (deriva_ml.core.enums.BaseStrEnum)" href="../deriva_definitions/#deriva_ml.core.definitions.BaseStrEnum">BaseStrEnum</a></code></p>



        <p>Asset type identifiers.</p>
<p>Defines the types of assets that can be associated with executions.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="deriva_ml.core.MLAsset.execution_metadata">execution_metadata</span></code></td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Metadata about an execution.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="deriva_ml.core.MLAsset.execution_asset">execution_asset</span></code></td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Asset produced by an execution.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/deriva_ml/core/enums.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">MLAsset</span><span class="p">(</span><span class="n">BaseStrEnum</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Asset type identifiers.</span>

<span class="sd">    Defines the types of assets that can be associated with executions.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        execution_metadata (str): Metadata about an execution.</span>
<span class="sd">        execution_asset (str): Asset produced by an execution.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">execution_metadata</span> <span class="o">=</span> <span class="s2">&quot;Execution_Metadata&quot;</span>
    <span class="n">execution_asset</span> <span class="o">=</span> <span class="s2">&quot;Execution_Asset&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="deriva_ml.core.MLVocab" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">MLVocab</span>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="BaseStrEnum (deriva_ml.core.enums.BaseStrEnum)" href="../deriva_definitions/#deriva_ml.core.definitions.BaseStrEnum">BaseStrEnum</a></code></p>



        <p>Controlled vocabulary table identifiers.</p>
<p>Defines the names of controlled vocabulary tables used in DerivaML. These tables
store standardized terms with descriptions and synonyms for consistent data
classification across the catalog.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="deriva_ml.core.MLVocab.dataset_type">dataset_type</span></code></td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dataset classification vocabulary (e.g., "Training", "Test").</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="deriva_ml.core.MLVocab.workflow_type">workflow_type</span></code></td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Workflow classification vocabulary (e.g., "Python", "Notebook").</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="deriva_ml.core.MLVocab.asset_type">asset_type</span></code></td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Asset/file type classification vocabulary (e.g., "Image", "CSV").</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="deriva_ml.core.MLVocab.asset_role">asset_role</span></code></td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Asset role vocabulary for execution relationships (e.g., "Input", "Output").</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="deriva_ml.core.MLVocab.feature_name">feature_name</span></code></td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Feature name vocabulary for ML feature definitions.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/deriva_ml/core/enums.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">MLVocab</span><span class="p">(</span><span class="n">BaseStrEnum</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Controlled vocabulary table identifiers.</span>

<span class="sd">    Defines the names of controlled vocabulary tables used in DerivaML. These tables</span>
<span class="sd">    store standardized terms with descriptions and synonyms for consistent data</span>
<span class="sd">    classification across the catalog.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        dataset_type (str): Dataset classification vocabulary (e.g., &quot;Training&quot;, &quot;Test&quot;).</span>
<span class="sd">        workflow_type (str): Workflow classification vocabulary (e.g., &quot;Python&quot;, &quot;Notebook&quot;).</span>
<span class="sd">        asset_type (str): Asset/file type classification vocabulary (e.g., &quot;Image&quot;, &quot;CSV&quot;).</span>
<span class="sd">        asset_role (str): Asset role vocabulary for execution relationships (e.g., &quot;Input&quot;, &quot;Output&quot;).</span>
<span class="sd">        feature_name (str): Feature name vocabulary for ML feature definitions.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">dataset_type</span> <span class="o">=</span> <span class="s2">&quot;Dataset_Type&quot;</span>
    <span class="n">workflow_type</span> <span class="o">=</span> <span class="s2">&quot;Workflow_Type&quot;</span>
    <span class="n">asset_type</span> <span class="o">=</span> <span class="s2">&quot;Asset_Type&quot;</span>
    <span class="n">asset_role</span> <span class="o">=</span> <span class="s2">&quot;Asset_Role&quot;</span>
    <span class="n">feature_name</span> <span class="o">=</span> <span class="s2">&quot;Feature_Name&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="deriva_ml.core.UploadState" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">UploadState</span>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="enum.Enum">Enum</span></code></p>



        <p>File upload operation states.</p>
<p>Represents the various states a file upload operation can be in, from initiation to completion.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="deriva_ml.core.UploadState.success">success</span></code></td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Upload completed successfully.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="deriva_ml.core.UploadState.failed">failed</span></code></td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Upload failed.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="deriva_ml.core.UploadState.pending">pending</span></code></td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Upload is queued.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="deriva_ml.core.UploadState.running">running</span></code></td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Upload is in progress.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="deriva_ml.core.UploadState.paused">paused</span></code></td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Upload is temporarily paused.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="deriva_ml.core.UploadState.aborted">aborted</span></code></td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Upload was aborted.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="deriva_ml.core.UploadState.cancelled">cancelled</span></code></td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Upload was cancelled.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="deriva_ml.core.UploadState.timeout">timeout</span></code></td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Upload timed out.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>src/deriva_ml/core/enums.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">UploadState</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;File upload operation states.</span>

<span class="sd">    Represents the various states a file upload operation can be in, from initiation to completion.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        success (int): Upload completed successfully.</span>
<span class="sd">        failed (int): Upload failed.</span>
<span class="sd">        pending (int): Upload is queued.</span>
<span class="sd">        running (int): Upload is in progress.</span>
<span class="sd">        paused (int): Upload is temporarily paused.</span>
<span class="sd">        aborted (int): Upload was aborted.</span>
<span class="sd">        cancelled (int): Upload was cancelled.</span>
<span class="sd">        timeout (int): Upload timed out.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">success</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">failed</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">pending</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">running</span> <span class="o">=</span> <span class="mi">3</span>
    <span class="n">paused</span> <span class="o">=</span> <span class="mi">4</span>
    <span class="n">aborted</span> <span class="o">=</span> <span class="mi">5</span>
    <span class="n">cancelled</span> <span class="o">=</span> <span class="mi">6</span>
    <span class="n">timeout</span> <span class="o">=</span> <span class="mi">7</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">












  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h2 id="deriva_ml.core.configure_logging" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">configure_logging</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">configure_logging</span><span class="p">(</span>
    <span class="n">level</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">WARNING</span><span class="p">,</span>
    <span class="n">deriva_level</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">format_string</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">DEFAULT_FORMAT</span><span class="p">,</span>
    <span class="n">handler</span><span class="p">:</span> <span class="n">Handler</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">logging</span><span class="o">.</span><span class="n">Logger</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Configure logging for DerivaML and related libraries.</p>
<p>This function sets up logging levels for DerivaML, related libraries
(deriva-py, bdbag, bagit), and Hydra loggers. It is designed to:</p>
<ol>
<li>Configure only specific logger namespaces, not the root logger</li>
<li>Respect Hydra's logging configuration when running under Hydra</li>
<li>Allow deriva-py libraries to have a separate logging level</li>
</ol>


<details class="the-logging-level-hierarchy" open>
  <summary>The logging level hierarchy</summary>
  <ul>
<li>deriva_ml logger: uses <code>level</code></li>
<li>Hydra loggers: follow <code>level</code> (deriva_ml level)</li>
<li>Deriva/bdbag/bagit loggers: use <code>deriva_level</code> (defaults to <code>level</code>)</li>
</ul>
</details>

<details class="when-running-under-hydra" open>
  <summary>When running under Hydra</summary>
  <ul>
<li>Only sets log levels on specific loggers</li>
<li>Does NOT add handlers (Hydra has already configured them)</li>
<li>Does NOT call basicConfig()</li>
</ul>
</details>        <p>When running standalone (no Hydra):
    - Sets log levels on specific loggers
    - Adds a StreamHandler to deriva_ml logger if none exists
    - Still does NOT touch the root logger or call basicConfig()</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>level</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Log level for deriva_ml and Hydra loggers. Defaults to WARNING.</p>
              </div>
            </td>
            <td>
                  <code><span title="logging.WARNING">WARNING</span></code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>deriva_level</code>
            </td>
            <td>
                  <code><span title="int">int</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Log level for deriva-py libraries (deriva, bagit, bdbag).
         If None, uses the same level as <code>level</code>.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>format_string</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Format string for log messages (used only when adding
          handlers outside Hydra context).</p>
              </div>
            </td>
            <td>
                  <code><span title="deriva_ml.core.logging_config.DEFAULT_FORMAT">DEFAULT_FORMAT</span></code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>handler</code>
            </td>
            <td>
                  <code><span title="logging.Handler">Handler</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional handler to add to the deriva_ml logger. If None and
    not running under Hydra, uses StreamHandler with format_string.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="logging.Logger">Logger</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The configured deriva_ml logger.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>import logging</p>
<h3 id="deriva_ml.core.configure_logging--same-level-for-everything">Same level for everything</h3>
<p>configure_logging(level=logging.DEBUG)</p>
<h3 id="deriva_ml.core.configure_logging--verbose-derivaml-quieter-deriva-py-libraries">Verbose DerivaML, quieter deriva-py libraries</h3>
<p>configure_logging(
...     level=logging.INFO,
...     deriva_level=logging.WARNING,
... )</p>
</blockquote>
</blockquote>
</blockquote>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/deriva_ml/core/logging_config.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">configure_logging</span><span class="p">(</span>
    <span class="n">level</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">WARNING</span><span class="p">,</span>
    <span class="n">deriva_level</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">format_string</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">DEFAULT_FORMAT</span><span class="p">,</span>
    <span class="n">handler</span><span class="p">:</span> <span class="n">logging</span><span class="o">.</span><span class="n">Handler</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">logging</span><span class="o">.</span><span class="n">Logger</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Configure logging for DerivaML and related libraries.</span>

<span class="sd">    This function sets up logging levels for DerivaML, related libraries</span>
<span class="sd">    (deriva-py, bdbag, bagit), and Hydra loggers. It is designed to:</span>

<span class="sd">    1. Configure only specific logger namespaces, not the root logger</span>
<span class="sd">    2. Respect Hydra&#39;s logging configuration when running under Hydra</span>
<span class="sd">    3. Allow deriva-py libraries to have a separate logging level</span>

<span class="sd">    The logging level hierarchy:</span>
<span class="sd">        - deriva_ml logger: uses `level`</span>
<span class="sd">        - Hydra loggers: follow `level` (deriva_ml level)</span>
<span class="sd">        - Deriva/bdbag/bagit loggers: use `deriva_level` (defaults to `level`)</span>

<span class="sd">    When running under Hydra:</span>
<span class="sd">        - Only sets log levels on specific loggers</span>
<span class="sd">        - Does NOT add handlers (Hydra has already configured them)</span>
<span class="sd">        - Does NOT call basicConfig()</span>

<span class="sd">    When running standalone (no Hydra):</span>
<span class="sd">        - Sets log levels on specific loggers</span>
<span class="sd">        - Adds a StreamHandler to deriva_ml logger if none exists</span>
<span class="sd">        - Still does NOT touch the root logger or call basicConfig()</span>

<span class="sd">    Args:</span>
<span class="sd">        level: Log level for deriva_ml and Hydra loggers. Defaults to WARNING.</span>
<span class="sd">        deriva_level: Log level for deriva-py libraries (deriva, bagit, bdbag).</span>
<span class="sd">                     If None, uses the same level as `level`.</span>
<span class="sd">        format_string: Format string for log messages (used only when adding</span>
<span class="sd">                      handlers outside Hydra context).</span>
<span class="sd">        handler: Optional handler to add to the deriva_ml logger. If None and</span>
<span class="sd">                not running under Hydra, uses StreamHandler with format_string.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The configured deriva_ml logger.</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; import logging</span>
<span class="sd">        &gt;&gt;&gt; # Same level for everything</span>
<span class="sd">        &gt;&gt;&gt; configure_logging(level=logging.DEBUG)</span>
<span class="sd">        &gt;&gt;&gt;</span>
<span class="sd">        &gt;&gt;&gt; # Verbose DerivaML, quieter deriva-py libraries</span>
<span class="sd">        &gt;&gt;&gt; configure_logging(</span>
<span class="sd">        ...     level=logging.INFO,</span>
<span class="sd">        ...     deriva_level=logging.WARNING,</span>
<span class="sd">        ... )</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">deriva_level</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">deriva_level</span> <span class="o">=</span> <span class="n">level</span>

    <span class="c1"># Configure main DerivaML logger</span>
    <span class="n">logger</span> <span class="o">=</span> <span class="n">get_logger</span><span class="p">()</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">level</span><span class="p">)</span>

    <span class="c1"># Configure Hydra loggers to follow deriva_ml level</span>
    <span class="k">for</span> <span class="n">logger_name</span> <span class="ow">in</span> <span class="n">HYDRA_LOGGERS</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="n">logger_name</span><span class="p">)</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">level</span><span class="p">)</span>

    <span class="c1"># Configure deriva-py and related library loggers</span>
    <span class="k">for</span> <span class="n">logger_name</span> <span class="ow">in</span> <span class="n">DERIVA_LOGGERS</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="n">logger_name</span><span class="p">)</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">deriva_level</span><span class="p">)</span>

    <span class="c1"># Only add handlers if not running under Hydra</span>
    <span class="c1"># Hydra configures handlers via dictConfig, we don&#39;t want to duplicate</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">is_hydra_initialized</span><span class="p">():</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">logger</span><span class="o">.</span><span class="n">handlers</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">handler</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">handler</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">StreamHandler</span><span class="p">()</span>
                <span class="n">handler</span><span class="o">.</span><span class="n">setFormatter</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">Formatter</span><span class="p">(</span><span class="n">format_string</span><span class="p">))</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">addHandler</span><span class="p">(</span><span class="n">handler</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">logger</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="deriva_ml.core.get_logger" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">get_logger</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_logger</span><span class="p">(</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">logging</span><span class="o">.</span><span class="n">Logger</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Get a DerivaML logger.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>name</code>
            </td>
            <td>
                  <code><span title="str">str</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional sub-logger name. If provided, returns a child logger
  under the deriva_ml namespace (e.g., 'deriva_ml.dataset').
  If None, returns the main deriva_ml logger.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="logging.Logger">Logger</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The configured logger instance.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>logger = get_logger()  # Main deriva_ml logger
dataset_logger = get_logger("dataset")  # deriva_ml.dataset</p>
</blockquote>
</blockquote>
</blockquote>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/deriva_ml/core/logging_config.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_logger</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">logging</span><span class="o">.</span><span class="n">Logger</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get a DerivaML logger.</span>

<span class="sd">    Args:</span>
<span class="sd">        name: Optional sub-logger name. If provided, returns a child logger</span>
<span class="sd">              under the deriva_ml namespace (e.g., &#39;deriva_ml.dataset&#39;).</span>
<span class="sd">              If None, returns the main deriva_ml logger.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The configured logger instance.</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; logger = get_logger()  # Main deriva_ml logger</span>
<span class="sd">        &gt;&gt;&gt; dataset_logger = get_logger(&quot;dataset&quot;)  # deriva_ml.dataset</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="n">LOGGER_NAME</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">LOGGER_NAME</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="deriva_ml.core.is_hydra_initialized" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">is_hydra_initialized</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">is_hydra_initialized</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">bool</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Check if running within an initialized Hydra context.</p>
<p>This is used to determine whether Hydra is managing logging configuration.
When Hydra is initialized, we avoid adding handlers or calling basicConfig
since Hydra has already configured logging via dictConfig.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True if Hydra's GlobalHydra is initialized, False otherwise.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>if is_hydra_initialized():
...     # Hydra is managing logging
...     pass</p>
</blockquote>
</blockquote>
</blockquote>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/deriva_ml/core/logging_config.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">is_hydra_initialized</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check if running within an initialized Hydra context.</span>

<span class="sd">    This is used to determine whether Hydra is managing logging configuration.</span>
<span class="sd">    When Hydra is initialized, we avoid adding handlers or calling basicConfig</span>
<span class="sd">    since Hydra has already configured logging via dictConfig.</span>

<span class="sd">    Returns:</span>
<span class="sd">        True if Hydra&#39;s GlobalHydra is initialized, False otherwise.</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; if is_hydra_initialized():</span>
<span class="sd">        ...     # Hydra is managing logging</span>
<span class="sd">        ...     pass</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">hydra.core.global_hydra</span><span class="w"> </span><span class="kn">import</span> <span class="n">GlobalHydra</span>

        <span class="k">return</span> <span class="n">GlobalHydra</span><span class="o">.</span><span class="n">instance</span><span class="p">()</span><span class="o">.</span><span class="n">is_initialized</span><span class="p">()</span>
    <span class="k">except</span> <span class="p">(</span><span class="ne">ImportError</span><span class="p">,</span> <span class="ne">Exception</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../../Notebooks/DerivaML%20Vocabulary/" class="md-footer__link md-footer__link--prev" aria-label="Previous: DerivaML Vocabulary">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                DerivaML Vocabulary
              </div>
            </div>
          </a>
        
        
          
          <a href="../deriva_model/" class="md-footer__link md-footer__link--next" aria-label="Next: DerivaModel">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                DerivaModel
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../..", "features": ["navigation.instant", "navigation.expand", "navigation.footer"], "search": "../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
    
  </body>
</html>